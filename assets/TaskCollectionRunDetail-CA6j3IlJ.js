import{j as e,d,a as ge,u as xe}from"./index-i3_CIisb.js";import{r as x,Q as X,d as V,C as m,S as $,b3 as ae,T as Z,u as z,ao as se,g as fe,L as E,j as _,_ as q,v as je,b4 as _e,aM as J,a0 as ee,l as oe,aQ as ce,a5 as de,au as me,aa as he,X as te,b5 as ue,a as Q,b6 as Se,b7 as ke,b8 as be,b9 as ve,y as j,k as K,a9 as ie,ak as Te,O as we,P as Re,B as ne,o as Le,ag as Ie}from"./antd-C0IAgzs2.js";import{s as Ce}from"./index-Daowydkz.js";import{B as De}from"./Breadcrumb-C8oXpFp6.js";import{s as T}from"./transform-HhklBjSi.js";import{d as Ne}from"./drag-CBGjPDUz.js";import"./vendor-DJG_os-6.js";const ze=JSON.parse('[{"nodeId":"scenario_001","nodeName":"用户购买流程","nodeType":"业务场景","status":"running","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":null,"totalDuration":null},"actions":[{"id":"scenario_001_monitor","name":"场景监控","description":"监控用户购买流程的执行状态","type":"monitoring","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"conversion_rate","name":"转化率","description":"业务转化率","unit":"%","healthyRange":{"min":15,"max":100,"description":"转化率应保持在15.0-100.0%范围内"},"actualValue":18.22200729415433,"health":"healthy","healthScore":90,"timestamp":"2024-06-25 10:00:00"},{"id":"response_time","name":"响应时间","description":"平均响应时间","unit":"ms","healthyRange":{"min":0,"max":500,"description":"响应时间应保持在0-500ms范围内"},"actualValue":291.1252914653309,"health":"healthy","healthScore":96,"timestamp":"2024-06-25 10:00:00"}],"overallScore":89,"summary":"场景监控执行完成，所有指标正常"}],"analysis":{"overallHealthScore":86,"riskLevel":"low","keyFindings":["用户购买流程运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"用户购买流程整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化用户购买流程性能","description":"建议对用户购买流程进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L5","category":"business_scenario"},{"nodeId":"scenario_002","nodeName":"订单履约场景","nodeType":"业务场景","status":"completed","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:05:00","totalDuration":300},"actions":[{"id":"scenario_002_monitor","name":"场景监控","description":"监控订单履约场景的执行状态","type":"monitoring","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"conversion_rate","name":"转化率","description":"业务转化率","unit":"%","healthyRange":{"min":15,"max":100,"description":"转化率应保持在15.0-100.0%范围内"},"actualValue":24.581853400856055,"health":"healthy","healthScore":85,"timestamp":"2024-06-25 10:00:00"},{"id":"response_time","name":"响应时间","description":"平均响应时间","unit":"ms","healthyRange":{"min":0,"max":500,"description":"响应时间应保持在0-500ms范围内"},"actualValue":216.73436130720938,"health":"healthy","healthScore":91,"timestamp":"2024-06-25 10:00:00"}],"overallScore":95,"summary":"场景监控执行完成，所有指标正常"}],"analysis":{"overallHealthScore":87,"riskLevel":"low","keyFindings":["订单履约场景运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"订单履约场景整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化订单履约场景性能","description":"建议对订单履约场景进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L5","category":"business_scenario"},{"nodeId":"chain_001","nodeName":"用户注册链路","nodeType":"业务链路","status":"completed","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:05:00","totalDuration":300},"actions":[{"id":"chain_001_trace","name":"链路追踪","description":"追踪用户注册链路的执行路径","type":"tracing","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"throughput","name":"吞吐量","description":"每秒处理请求数","unit":"req/s","healthyRange":{"min":100,"max":1000,"description":"吞吐量应保持在100-1000req/s范围内"},"actualValue":596.2446982250688,"health":"healthy","healthScore":88,"timestamp":"2024-06-25 10:00:00"},{"id":"error_rate","name":"错误率","description":"请求错误率","unit":"%","healthyRange":{"min":0,"max":5,"description":"错误率应保持在0-5%范围内"},"actualValue":1.6031479221701515,"health":"healthy","healthScore":84,"timestamp":"2024-06-25 10:00:00"}],"overallScore":95,"summary":"链路追踪执行完成，所有指标正常"}],"analysis":{"overallHealthScore":95,"riskLevel":"low","keyFindings":["用户注册链路运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"用户注册链路整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化用户注册链路性能","description":"建议对用户注册链路进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L4","category":"business_chain"},{"nodeId":"chain_002","nodeName":"支付处理链路","nodeType":"业务链路","status":"running","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":null,"totalDuration":null},"actions":[{"id":"chain_002_trace","name":"链路追踪","description":"追踪支付处理链路的执行路径","type":"tracing","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"throughput","name":"吞吐量","description":"每秒处理请求数","unit":"req/s","healthyRange":{"min":100,"max":1000,"description":"吞吐量应保持在100-1000req/s范围内"},"actualValue":735.0352860273437,"health":"healthy","healthScore":98,"timestamp":"2024-06-25 10:00:00"},{"id":"error_rate","name":"错误率","description":"请求错误率","unit":"%","healthyRange":{"min":0,"max":5,"description":"错误率应保持在0-5%范围内"},"actualValue":0.5772519002577102,"health":"healthy","healthScore":91,"timestamp":"2024-06-25 10:00:00"}],"overallScore":80,"summary":"链路追踪执行完成，所有指标正常"}],"analysis":{"overallHealthScore":90,"riskLevel":"low","keyFindings":["支付处理链路运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"支付处理链路整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化支付处理链路性能","description":"建议对支付处理链路进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L4","category":"business_chain"},{"nodeId":"chain_003","nodeName":"库存管理链路","nodeType":"业务链路","status":"pending","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":null,"totalDuration":null},"actions":[{"id":"chain_003_trace","name":"链路追踪","description":"追踪库存管理链路的执行路径","type":"tracing","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"throughput","name":"吞吐量","description":"每秒处理请求数","unit":"req/s","healthyRange":{"min":100,"max":1000,"description":"吞吐量应保持在100-1000req/s范围内"},"actualValue":682.2195172277242,"health":"healthy","healthScore":89,"timestamp":"2024-06-25 10:00:00"},{"id":"error_rate","name":"错误率","description":"请求错误率","unit":"%","healthyRange":{"min":0,"max":5,"description":"错误率应保持在0-5%范围内"},"actualValue":1.525790585008097,"health":"healthy","healthScore":94,"timestamp":"2024-06-25 10:00:00"}],"overallScore":80,"summary":"链路追踪执行完成，所有指标正常"}],"analysis":{"overallHealthScore":94,"riskLevel":"low","keyFindings":["库存管理链路运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"库存管理链路整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化库存管理链路性能","description":"建议对库存管理链路进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L4","category":"business_chain"},{"nodeId":"system_001","nodeName":"用户管理系统","nodeType":"业务系统","status":"completed","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:05:00","totalDuration":300},"actions":[{"id":"system_001_health","name":"健康检查","description":"检查用户管理系统的健康状态","type":"health_check","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"cpu_usage","name":"CPU使用率","description":"系统CPU使用率","unit":"%","healthyRange":{"min":0,"max":80,"description":"CPU使用率应保持在0-80%范围内"},"actualValue":25.026558023102965,"health":"healthy","healthScore":88,"timestamp":"2024-06-25 10:00:00"},{"id":"memory_usage","name":"内存使用率","description":"系统内存使用率","unit":"%","healthyRange":{"min":0,"max":80,"description":"内存使用率应保持在0-80%范围内"},"actualValue":60.147483695284464,"health":"healthy","healthScore":98,"timestamp":"2024-06-25 10:00:00"}],"overallScore":89,"summary":"健康检查执行完成，所有指标正常"}],"analysis":{"overallHealthScore":92,"riskLevel":"low","keyFindings":["用户管理系统运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"用户管理系统整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化用户管理系统性能","description":"建议对用户管理系统进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L3","category":"business_system"},{"nodeId":"system_002","nodeName":"订单管理系统","nodeType":"业务系统","status":"running","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":null,"totalDuration":null},"actions":[{"id":"system_002_health","name":"健康检查","description":"检查订单管理系统的健康状态","type":"health_check","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"cpu_usage","name":"CPU使用率","description":"系统CPU使用率","unit":"%","healthyRange":{"min":0,"max":80,"description":"CPU使用率应保持在0-80%范围内"},"actualValue":49.19334852220004,"health":"healthy","healthScore":81,"timestamp":"2024-06-25 10:00:00"},{"id":"memory_usage","name":"内存使用率","description":"系统内存使用率","unit":"%","healthyRange":{"min":0,"max":80,"description":"内存使用率应保持在0-80%范围内"},"actualValue":47.78916265698895,"health":"healthy","healthScore":78,"timestamp":"2024-06-25 10:00:00"}],"overallScore":83,"summary":"健康检查执行完成，所有指标正常"}],"analysis":{"overallHealthScore":94,"riskLevel":"low","keyFindings":["订单管理系统运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"订单管理系统整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化订单管理系统性能","description":"建议对订单管理系统进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L3","category":"business_system"},{"nodeId":"system_003","nodeName":"支付系统","nodeType":"业务系统","status":"completed","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:05:00","totalDuration":300},"actions":[{"id":"system_003_health","name":"健康检查","description":"检查支付系统的健康状态","type":"health_check","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"cpu_usage","name":"CPU使用率","description":"系统CPU使用率","unit":"%","healthyRange":{"min":0,"max":80,"description":"CPU使用率应保持在0-80%范围内"},"actualValue":41.45186320036039,"health":"healthy","healthScore":85,"timestamp":"2024-06-25 10:00:00"},{"id":"memory_usage","name":"内存使用率","description":"系统内存使用率","unit":"%","healthyRange":{"min":0,"max":80,"description":"内存使用率应保持在0-80%范围内"},"actualValue":69.5111379548838,"health":"healthy","healthScore":82,"timestamp":"2024-06-25 10:00:00"}],"overallScore":91,"summary":"健康检查执行完成，所有指标正常"}],"analysis":{"overallHealthScore":87,"riskLevel":"low","keyFindings":["支付系统运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"支付系统整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化支付系统性能","description":"建议对支付系统进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L3","category":"business_system"},{"nodeId":"system_004","nodeName":"库存系统","nodeType":"业务系统","status":"failed","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":null,"totalDuration":null},"actions":[{"id":"system_004_health","name":"健康检查","description":"检查库存系统的健康状态和数据一致性","type":"health_check","status":"error","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:02:30","duration":150,"metrics":[{"id":"cpu_usage","name":"CPU使用率","description":"系统CPU使用率异常偏高","unit":"%","healthyRange":{"min":0,"max":80,"description":"CPU使用率应保持在80%以下"},"actualValue":92.5,"health":"critical","healthScore":25,"timestamp":"2024-06-25 09:02:30"},{"id":"memory_usage","name":"内存使用率","description":"系统内存使用率过高，可能存在内存泄漏","unit":"%","healthyRange":{"min":0,"max":80,"description":"内存使用率应保持在80%以下"},"actualValue":87.3,"health":"critical","healthScore":30,"timestamp":"2024-06-25 09:02:30"},{"id":"db_connection_pool","name":"数据库连接池","description":"数据库连接池耗尽，影响库存查询性能","unit":"个","healthyRange":{"min":5,"max":100,"description":"可用连接数应保持在5个以上"},"actualValue":2,"health":"critical","healthScore":15,"timestamp":"2024-06-25 09:02:30"}],"overallScore":23,"summary":"库存系统出现严重异常，CPU和内存使用率过高，数据库连接池耗尽"},{"id":"system_004_sync","name":"库存同步检查","description":"检查库存数据在各个系统间的同步状态","type":"data_sync","status":"error","startTime":"2024-06-25 09:03:00","endTime":"2024-06-25 09:04:00","duration":60,"metrics":[{"id":"sync_delay","name":"同步延迟","description":"库存数据同步延迟时间","unit":"秒","healthyRange":{"min":0,"max":30,"description":"同步延迟应控制在30秒以内"},"actualValue":125,"health":"critical","healthScore":20,"timestamp":"2024-06-25 09:04:00"}],"overallScore":20,"summary":"库存数据同步严重滞后，可能导致超卖问题"}],"analysis":{"overallHealthScore":22,"riskLevel":"critical","keyFindings":["系统资源使用率严重超标，CPU达92.5%，内存达87.3%","数据库连接池耗尽，仅剩2个可用连接","库存数据同步延迟125秒，远超正常范围","存在内存泄漏风险，系统稳定性堪忧"],"performanceSummary":"库存系统性能严重恶化，响应时间超过5秒，部分请求超时失败","securitySummary":"系统异常可能导致数据不一致，存在业务风险","recommendations":[{"priority":"critical","category":"紧急修复","title":"立即重启库存系统服务","description":"系统资源耗尽，建议立即重启服务并排查内存泄漏问题","estimatedImpact":"预计可恢复系统正常运行，但需要持续监控"},{"priority":"high","category":"性能优化","title":"优化数据库连接池配置","description":"增加数据库连接池大小，优化连接复用策略","estimatedImpact":"预计可提升50%的并发处理能力"},{"priority":"high","category":"数据一致性","title":"修复库存同步机制","description":"排查同步延迟原因，优化数据同步算法","estimatedImpact":"预计可将同步延迟降低至10秒以内"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L3","category":"business_system"},{"nodeId":"middleware_001","nodeName":"API网关","nodeType":"中间件","status":"completed","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:05:00","totalDuration":300},"actions":[{"id":"middleware_001_monitor","name":"中间件监控","description":"监控API网关的运行状态","type":"monitoring","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"availability","name":"可用性","description":"服务可用性","unit":"%","healthyRange":{"min":99,"max":100,"description":"可用性应保持在99.0-100.0%范围内"},"actualValue":99.54242768910133,"health":"healthy","healthScore":86,"timestamp":"2024-06-25 10:00:00"},{"id":"connection_count","name":"连接数","description":"当前连接数","unit":"个","healthyRange":{"min":0,"max":1000,"description":"连接数应保持在0-1000个范围内"},"actualValue":282,"health":"healthy","healthScore":86,"timestamp":"2024-06-25 10:00:00"}],"overallScore":89,"summary":"中间件监控执行完成，所有指标正常"}],"analysis":{"overallHealthScore":95,"riskLevel":"low","keyFindings":["API网关运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"API网关整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化API网关性能","description":"建议对API网关进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L2","category":"middleware"},{"nodeId":"middleware_002","nodeName":"Redis缓存","nodeType":"中间件","status":"running","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":null,"totalDuration":null},"actions":[{"id":"middleware_002_monitor","name":"缓存监控","description":"监控Redis缓存的运行状态和性能指标","type":"monitoring","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"hit_rate","name":"缓存命中率","description":"Redis缓存命中率","unit":"%","healthyRange":{"min":85,"max":100,"description":"缓存命中率应保持在85%以上"},"actualValue":94.2,"health":"healthy","healthScore":94,"timestamp":"2024-06-25 09:01:00"},{"id":"memory_usage","name":"内存使用率","description":"Redis内存使用情况","unit":"%","healthyRange":{"min":0,"max":80,"description":"内存使用率应控制在80%以下"},"actualValue":67.8,"health":"healthy","healthScore":85,"timestamp":"2024-06-25 09:01:00"},{"id":"connection_count","name":"连接数","description":"当前活跃连接数","unit":"个","healthyRange":{"min":0,"max":1000,"description":"连接数应控制在1000以内"},"actualValue":245,"health":"healthy","healthScore":90,"timestamp":"2024-06-25 09:01:00"}],"overallScore":90,"summary":"Redis缓存运行状态良好，命中率和性能指标均正常"}],"analysis":{"overallHealthScore":90,"riskLevel":"low","keyFindings":["缓存命中率94.2%，显著提升了系统响应速度","内存使用率67.8%，在安全范围内","连接数245个，负载适中","无慢查询和阻塞操作"],"performanceSummary":"Redis缓存整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化Redis缓存性能","description":"建议对Redis缓存进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L2","category":"middleware"},{"nodeId":"middleware_003","nodeName":"消息队列","nodeType":"中间件","status":"completed","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:05:00","totalDuration":300},"actions":[{"id":"middleware_003_monitor","name":"中间件监控","description":"监控消息队列的运行状态","type":"monitoring","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"availability","name":"可用性","description":"服务可用性","unit":"%","healthyRange":{"min":99,"max":100,"description":"可用性应保持在99.0-100.0%范围内"},"actualValue":99.7677570783947,"health":"healthy","healthScore":91,"timestamp":"2024-06-25 10:00:00"},{"id":"connection_count","name":"连接数","description":"当前连接数","unit":"个","healthyRange":{"min":0,"max":1000,"description":"连接数应保持在0-1000个范围内"},"actualValue":433,"health":"healthy","healthScore":79,"timestamp":"2024-06-25 10:00:00"}],"overallScore":87,"summary":"中间件监控执行完成，所有指标正常"}],"analysis":{"overallHealthScore":92,"riskLevel":"low","keyFindings":["消息队列运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"消息队列整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化消息队列性能","description":"建议对消息队列进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L2","category":"middleware"},{"nodeId":"middleware_004","nodeName":"配置中心","nodeType":"中间件","status":"completed","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:05:00","totalDuration":300},"actions":[{"id":"middleware_004_monitor","name":"中间件监控","description":"监控配置中心的运行状态","type":"monitoring","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"availability","name":"可用性","description":"服务可用性","unit":"%","healthyRange":{"min":99,"max":100,"description":"可用性应保持在99.0-100.0%范围内"},"actualValue":99.6778886894594,"health":"healthy","healthScore":91,"timestamp":"2024-06-25 10:00:00"},{"id":"connection_count","name":"连接数","description":"当前连接数","unit":"个","healthyRange":{"min":0,"max":1000,"description":"连接数应保持在0-1000个范围内"},"actualValue":245,"health":"healthy","healthScore":77,"timestamp":"2024-06-25 10:00:00"}],"overallScore":95,"summary":"中间件监控执行完成，所有指标正常"}],"analysis":{"overallHealthScore":90,"riskLevel":"low","keyFindings":["配置中心运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"配置中心整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化配置中心性能","description":"建议对配置中心进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L2","category":"middleware"},{"nodeId":"infra_001","nodeName":"Kubernetes集群","nodeType":"基础设施","status":"completed","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:05:00","totalDuration":300},"actions":[{"id":"infra_001_infra","name":"基础设施检查","description":"检查Kubernetes集群的基础设施状态","type":"infrastructure","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"disk_usage","name":"磁盘使用率","description":"磁盘空间使用率","unit":"%","healthyRange":{"min":0,"max":85,"description":"磁盘使用率应保持在0-85%范围内"},"actualValue":63.60984416856813,"health":"healthy","healthScore":94,"timestamp":"2024-06-25 10:00:00"},{"id":"network_io","name":"网络IO","description":"网络IO吞吐量","unit":"MB/s","healthyRange":{"min":0,"max":1000,"description":"网络IO应保持在0-1000MB/s范围内"},"actualValue":114.45936758587031,"health":"healthy","healthScore":94,"timestamp":"2024-06-25 10:00:00"}],"overallScore":81,"summary":"基础设施检查执行完成，所有指标正常"}],"analysis":{"overallHealthScore":87,"riskLevel":"low","keyFindings":["Kubernetes集群运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"Kubernetes集群整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化Kubernetes集群性能","description":"建议对Kubernetes集群进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L1","category":"infrastructure"},{"nodeId":"infra_002","nodeName":"MySQL数据库","nodeType":"基础设施","status":"running","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":null,"totalDuration":null},"actions":[{"id":"infra_002_performance","name":"数据库性能检查","description":"检查MySQL数据库的性能指标和运行状态","type":"performance_check","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:02:00","duration":120,"metrics":[{"id":"qps","name":"每秒查询数","description":"数据库每秒处理的查询数量","unit":"queries/s","healthyRange":{"min":0,"max":5000,"description":"QPS应控制在5000以内"},"actualValue":1247,"health":"healthy","healthScore":88,"timestamp":"2024-06-25 09:02:00"},{"id":"slow_query_rate","name":"慢查询率","description":"执行时间超过1秒的查询比例","unit":"%","healthyRange":{"min":0,"max":5,"description":"慢查询率应控制在5%以下"},"actualValue":2.3,"health":"healthy","healthScore":85,"timestamp":"2024-06-25 09:02:00"},{"id":"connection_usage","name":"连接使用率","description":"数据库连接池使用率","unit":"%","healthyRange":{"min":0,"max":80,"description":"连接使用率应控制在80%以下"},"actualValue":45.6,"health":"healthy","healthScore":92,"timestamp":"2024-06-25 09:02:00"}],"overallScore":88,"summary":"MySQL数据库运行稳定，性能指标良好"}],"analysis":{"overallHealthScore":92,"riskLevel":"low","keyFindings":["数据库QPS为1247，处理能力充足","慢查询率2.3%，在合理范围内","连接使用率45.6%，资源利用合理","主从复制延迟小于1秒"],"performanceSummary":"MySQL数据库整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化MySQL数据库性能","description":"建议对MySQL数据库进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L1","category":"infrastructure"},{"nodeId":"infra_003","nodeName":"负载均衡器","nodeType":"基础设施","status":"completed","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:05:00","totalDuration":300},"actions":[{"id":"infra_003_infra","name":"基础设施检查","description":"检查负载均衡器的基础设施状态","type":"infrastructure","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"disk_usage","name":"磁盘使用率","description":"磁盘空间使用率","unit":"%","healthyRange":{"min":0,"max":85,"description":"磁盘使用率应保持在0-85%范围内"},"actualValue":48.182034630417974,"health":"healthy","healthScore":92,"timestamp":"2024-06-25 10:00:00"},{"id":"network_io","name":"网络IO","description":"网络IO吞吐量","unit":"MB/s","healthyRange":{"min":0,"max":1000,"description":"网络IO应保持在0-1000MB/s范围内"},"actualValue":140.40376593840858,"health":"healthy","healthScore":87,"timestamp":"2024-06-25 10:00:00"}],"overallScore":94,"summary":"基础设施检查执行完成，所有指标正常"}],"analysis":{"overallHealthScore":95,"riskLevel":"low","keyFindings":["负载均衡器运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"负载均衡器整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化负载均衡器性能","description":"建议对负载均衡器进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L1","category":"infrastructure"},{"nodeId":"infra_004","nodeName":"存储系统","nodeType":"基础设施","status":"completed","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:05:00","totalDuration":300},"actions":[{"id":"infra_004_infra","name":"基础设施检查","description":"检查存储系统的基础设施状态","type":"infrastructure","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"disk_usage","name":"磁盘使用率","description":"磁盘空间使用率","unit":"%","healthyRange":{"min":0,"max":85,"description":"磁盘使用率应保持在0-85%范围内"},"actualValue":44.708948940532636,"health":"healthy","healthScore":77,"timestamp":"2024-06-25 10:00:00"},{"id":"network_io","name":"网络IO","description":"网络IO吞吐量","unit":"MB/s","healthyRange":{"min":0,"max":1000,"description":"网络IO应保持在0-1000MB/s范围内"},"actualValue":52.851073520329365,"health":"healthy","healthScore":94,"timestamp":"2024-06-25 10:00:00"}],"overallScore":84,"summary":"基础设施检查执行完成，所有指标正常"}],"analysis":{"overallHealthScore":87,"riskLevel":"low","keyFindings":["存储系统运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"存储系统整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化存储系统性能","description":"建议对存储系统进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L1","category":"infrastructure"},{"nodeId":"infra_005","nodeName":"网络设备","nodeType":"基础设施","status":"completed","executionTime":{"startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:05:00","totalDuration":300},"actions":[{"id":"infra_005_infra","name":"基础设施检查","description":"检查网络设备的基础设施状态","type":"infrastructure","status":"success","startTime":"2024-06-25 09:00:00","endTime":"2024-06-25 09:01:00","duration":60,"metrics":[{"id":"disk_usage","name":"磁盘使用率","description":"磁盘空间使用率","unit":"%","healthyRange":{"min":0,"max":85,"description":"磁盘使用率应保持在0-85%范围内"},"actualValue":46.85077074601017,"health":"healthy","healthScore":79,"timestamp":"2024-06-25 10:00:00"},{"id":"network_io","name":"网络IO","description":"网络IO吞吐量","unit":"MB/s","healthyRange":{"min":0,"max":1000,"description":"网络IO应保持在0-1000MB/s范围内"},"actualValue":50.67405822897634,"health":"healthy","healthScore":79,"timestamp":"2024-06-25 10:00:00"}],"overallScore":82,"summary":"基础设施检查执行完成，所有指标正常"}],"analysis":{"overallHealthScore":88,"riskLevel":"low","keyFindings":["网络设备运行状态良好","所有关键指标在正常范围内","性能表现稳定"],"performanceSummary":"网络设备整体性能表现优秀","securitySummary":"安全检查通过，无安全风险","recommendations":[{"priority":"medium","category":"性能优化","title":"优化网络设备性能","description":"建议对网络设备进行性能调优","estimatedImpact":"预计可提升10-15%的性能"}]},"lastUpdated":"2024-06-25 10:00:00","layer":"L1","category":"infrastructure"}]'),Pe={healthy:{color:"#52c41a",label:"健康",description:"指标正常，运行良好"},warning:{color:"#faad14",label:"警告",description:"指标异常，需要关注"},critical:{color:"#ff4d4f",label:"严重",description:"指标严重异常，需要立即处理"},unknown:{color:"#d9d9d9",label:"未知",description:"无法获取指标状态"}},$e={health_check:{name:"健康检查",icon:"heart",color:"#52c41a",description:"检查服务基础健康状态"},monitoring:{name:"监控检查",icon:"bar-chart",color:"#1890ff",description:"实时监控系统状态"},performance_check:{name:"性能检查",icon:"dashboard",color:"#722ed1",description:"分析性能指标和资源使用"},tracing:{name:"链路追踪",icon:"node-index",color:"#13c2c2",description:"追踪请求链路和调用关系"},data_sync:{name:"数据同步",icon:"sync",color:"#fa8c16",description:"检查数据同步状态"},infrastructure:{name:"基础设施",icon:"cluster",color:"#eb2f96",description:"检查基础设施状态"},analysis:{name:"分析检查",icon:"line-chart",color:"#52c41a",description:"深度分析系统指标"}},Ve={low:{color:"#52c41a",label:"低风险",description:"系统运行正常，风险较低"},medium:{color:"#faad14",label:"中等风险",description:"存在一些问题，需要关注"},high:{color:"#ff7a45",label:"高风险",description:"存在严重问题，需要及时处理"},critical:{color:"#ff4d4f",label:"严重风险",description:"系统异常，需要立即处理"}},M={diagnosticReports:ze,metricHealthLevels:Pe,actionTypes:$e,riskLevels:Ve},{Title:U,Text:g,Paragraph:re}=Z,Me=d(_)`
  margin-bottom: 16px;
  
  .ant-card-head {
    padding: 12px 16px;
    min-height: auto;
  }
  
  .ant-card-body {
    padding: 16px;
  }
`,Ue=d(_)`
  margin-bottom: 12px;
  border: 1px solid #f0f0f0;
  
  .ant-card-body {
    padding: 12px;
  }
`,He=d.div`
  padding: 16px;
  border-radius: 8px;
  background: ${r=>r.score>=90?"linear-gradient(135deg, #f6ffed 0%, #d9f7be 100%)":r.score>=70?"linear-gradient(135deg, #fffbe6 0%, #fff1b8 100%)":"linear-gradient(135deg, #fff2f0 0%, #ffccc7 100%)"};
  border: 1px solid ${r=>r.score>=90?"#b7eb8f":r.score>=70?"#ffe58f":"#ffa39e"};
`,Ee=({nodeIds:r})=>{const[a,b]=x.useState([]),[p,i]=x.useState(!0),R=x.useMemo(()=>r,[JSON.stringify(r)]),P=x.useCallback(async()=>{i(!0);try{await new Promise(s=>setTimeout(s,300));let t=M.diagnosticReports;if(R&&R.length>0){const s=M.diagnosticReports.filter(o=>R.includes(o.nodeId));s.length>0&&(t=s)}b(t)}catch(t){console.error("加载诊断报告失败:",t)}finally{i(!1)}},[R]);x.useEffect(()=>{P()},[P]);const l=t=>{const s=typeof t=="string"?parseFloat(t):t;return isNaN(s)?String(t):s%1===0?String(s):parseFloat(s.toFixed(3)).toString()},n=t=>{var s;return((s=M.metricHealthLevels[t])==null?void 0:s.color)||"#d9d9d9"},h=t=>({业务场景:"purple",业务链路:"blue",业务系统:"green",中间件:"orange",基础设施:"red",entity:"blue",sequence:"green"})[t]||"default",y=t=>{let s=0;t.actions.forEach(f=>{f.metrics&&f.metrics.forEach(G=>{(G.health==="critical"||G.health==="warning")&&s++})});const o=t.actions.filter(f=>f.status==="error"||f.status==="failed");return s+=o.length,(t.analysis.riskLevel==="high"||t.analysis.riskLevel==="critical")&&(s+=1),s},v=t=>{const s=n(t);switch(t){case"healthy":return e.jsx(Q,{style:{color:s}});case"warning":return e.jsx(ue,{style:{color:s}});case"critical":return e.jsx(te,{style:{color:s}});default:return e.jsx(he,{style:{color:s}})}},S=t=>{const s=M.actionTypes[t],o=(s==null?void 0:s.color)||"#666";switch(t){case"health_check":return e.jsx(me,{style:{color:o}});case"performance_analysis":return e.jsx(de,{style:{color:o}});case"fault_analysis":return e.jsx(ce,{style:{color:o}});case"security_scan":return e.jsx(oe,{style:{color:o}});default:return e.jsx(ee,{style:{color:o}})}},k=t=>{switch(t){case"up":return e.jsx(be,{style:{color:"#ff4d4f"}});case"down":return e.jsx(ke,{style:{color:"#52c41a"}});case"stable":return e.jsx(Se,{style:{color:"#1890ff"}});default:return null}},L=t=>M.riskLevels[t]||{color:"#d9d9d9",label:"未知",description:"未知风险等级"},I=t=>{var s;return e.jsxs(Ue,{size:"small",children:[e.jsxs(V,{gutter:16,align:"middle",children:[e.jsx(m,{span:8,children:e.jsxs("div",{children:[e.jsx(g,{strong:!0,children:t.name}),e.jsx("br",{}),e.jsx(g,{type:"secondary",style:{fontSize:12},children:t.description})]})}),e.jsx(m,{span:4,children:e.jsx($,{title:"实际值",value:l(t.actualValue),suffix:t.unit,valueStyle:{fontSize:16}})}),e.jsx(m,{span:6,children:e.jsxs("div",{children:[e.jsx(g,{type:"secondary",style:{fontSize:12},children:"健康范围"}),e.jsx("br",{}),e.jsx(g,{style:{fontSize:12},children:t.healthyRange.description})]})}),e.jsx(m,{span:3,children:e.jsxs("div",{style:{textAlign:"center"},children:[v(t.health),e.jsx("br",{}),e.jsx(g,{style:{fontSize:12,color:n(t.health)},children:((s=M.metricHealthLevels[t.health])==null?void 0:s.label)||"未知"})]})}),e.jsx(m,{span:3,children:e.jsx(J,{type:"circle",size:40,percent:Math.round(t.healthScore),strokeColor:n(t.health),format:()=>l(t.healthScore)})})]}),t.trend&&e.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#666",display:"flex",alignItems:"center",gap:4},children:[e.jsx("span",{children:"趋势:"}),k(t.trend),e.jsx("span",{children:t.trend==="up"?"上升":t.trend==="down"?"下降":"稳定"}),t.previousValue&&e.jsxs("span",{children:["(上次: ",l(t.previousValue),t.unit,")"]})]})]},t.id)},c=t=>e.jsxs(_,{size:"small",style:{marginBottom:16},children:[e.jsxs(V,{gutter:16,align:"middle",style:{marginBottom:16},children:[e.jsx(m,{span:2,children:S(t.type)}),e.jsxs(m,{span:10,children:[e.jsx(U,{level:5,style:{margin:0},children:t.name}),e.jsx(g,{type:"secondary",children:t.description})]}),e.jsx(m,{span:4,children:e.jsx($,{title:"执行时长",value:l(t.duration),suffix:"秒",valueStyle:{fontSize:14}})}),e.jsx(m,{span:4,children:e.jsx($,{title:"指标数量",value:t.metrics.length,suffix:"项",valueStyle:{fontSize:14}})}),e.jsx(m,{span:4,children:e.jsx(J,{type:"circle",size:50,percent:Math.round(t.overallScore),strokeColor:t.overallScore>=90?"#52c41a":t.overallScore>=70?"#faad14":"#ff4d4f",format:()=>l(t.overallScore)})})]}),e.jsx(se,{style:{margin:"12px 0"}}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(g,{strong:!0,children:"执行摘要: "}),e.jsx(g,{children:t.summary})]}),e.jsx(U,{level:5,children:"指标检查详情"}),t.metrics.map(I)]},t.id),u=t=>e.jsx(E,{dataSource:t,renderItem:s=>e.jsx(E.Item,{children:e.jsx(_,{size:"small",style:{width:"100%"},children:e.jsxs(V,{gutter:16,align:"top",children:[e.jsx(m,{span:2,children:e.jsx(z,{color:s.priority==="high"?"red":s.priority==="medium"?"orange":"blue",children:s.priority==="high"?"高":s.priority==="medium"?"中":"低"})}),e.jsx(m,{span:3,children:e.jsx(z,{color:"purple",children:s.category==="performance"?"性能":s.category==="security"?"安全":s.category==="reliability"?"可靠性":"维护"})}),e.jsx(m,{span:19,children:e.jsxs("div",{children:[e.jsx(g,{strong:!0,children:s.title}),e.jsx("br",{}),e.jsx(g,{type:"secondary",style:{fontSize:12},children:s.description}),e.jsx("br",{}),e.jsxs(g,{style:{fontSize:12,color:"#1890ff"},children:["预期影响: ",s.estimatedImpact]})]})})]})})})});if(p)return e.jsx(X,{message:"正在加载诊断报告...",type:"info",showIcon:!0});if(!a||a.length===0)return e.jsx(X,{message:"暂无诊断报告",description:"节点执行完成后将生成详细的诊断报告",type:"info",showIcon:!0});const w=a.map((t,s)=>{const o=L(t.analysis.riskLevel);return{key:s.toString(),label:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx(q,{status:t.status==="completed"?"success":t.status==="running"?"processing":t.status==="failed"?"error":"default"}),e.jsx("span",{style:{fontWeight:"bold"},children:t.nodeName}),e.jsx(z,{color:h(t.nodeType),children:t.nodeType}),e.jsx(z,{color:o.color,children:o.label})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx(je,{title:"整体健康评分",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(ae,{style:{color:"#faad14"}}),e.jsxs("span",{style:{fontSize:14,fontWeight:"bold"},children:[l(t.analysis.overallHealthScore),"/100"]})]})}),e.jsxs("span",{style:{fontSize:12,color:"#666"},children:["动作: ",t.actions.length,"项"]}),e.jsxs("span",{style:{fontSize:12,color:"#666"},children:["建议: ",t.analysis.recommendations.length,"条"]}),e.jsxs("span",{style:{fontSize:12,color:y(t)>0?"#ff4d4f":"#666"},children:["风险: ",y(t),"项"]})]})]}),children:e.jsxs(Me,{children:[e.jsx(He,{score:t.analysis.overallHealthScore,children:e.jsxs(V,{gutter:16,align:"middle",children:[e.jsx(m,{span:8,children:e.jsx($,{title:"整体健康评分",value:l(t.analysis.overallHealthScore),suffix:"/100",valueStyle:{fontSize:32,fontWeight:"bold",color:t.analysis.overallHealthScore>=90?"#52c41a":t.analysis.overallHealthScore>=70?"#faad14":"#ff4d4f"},prefix:e.jsx(ae,{})})}),e.jsxs(m,{span:8,children:[e.jsxs("div",{children:[e.jsx(g,{strong:!0,children:"风险等级: "}),e.jsx(z,{color:o.color,style:{fontSize:14},children:o.label})]}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx(g,{strong:!0,children:"执行时长: "}),e.jsxs(g,{children:[l(t.executionTime.totalDuration||0),"秒"]})]})]}),e.jsx(m,{span:8,children:e.jsxs("div",{children:[e.jsx(g,{strong:!0,children:"最后更新: "}),e.jsx(g,{type:"secondary",children:t.lastUpdated})]})})]})}),e.jsx(se,{}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs(U,{level:5,children:[e.jsx(fe,{style:{color:"#faad14",marginRight:8}}),"关键发现"]}),e.jsx(E,{size:"small",dataSource:t.analysis.keyFindings,renderItem:f=>e.jsx(E.Item,{children:e.jsxs(g,{children:["• ",f]})})})]}),e.jsxs(V,{gutter:16,style:{marginBottom:24},children:[e.jsx(m,{span:12,children:e.jsx(_,{size:"small",title:"性能摘要",children:e.jsx(re,{style:{fontSize:13,margin:0},children:t.analysis.performanceSummary})})}),e.jsx(m,{span:12,children:e.jsx(_,{size:"small",title:"安全摘要",children:e.jsx(re,{style:{fontSize:13,margin:0},children:t.analysis.securitySummary})})})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(U,{level:5,children:"诊断动作详情"}),t.actions.map(c)]}),e.jsxs("div",{children:[e.jsx(U,{level:5,children:"优化建议"}),u(t.analysis.recommendations)]})]})}});return e.jsx(_e,{defaultActiveKey:["0"],ghost:!0,items:w})};var N=(r=>(r.PENDING="pending",r.RUNNING="running",r.COMPLETED="completed",r.FAILED="failed",r.SKIPPED="skipped",r))(N||{});const Be=d.div`
  width: 100%;
  height: 800px;
  border: 1px solid #d9d9d9;
  border-radius: 6px;
  background: #fafafa;
  position: relative;
  overflow: hidden;
  margin-top: 16px;
  
  svg {
    width: 100%;
    height: 100%;
  }
`,Fe=d.div`
  position: absolute;
  top: 16px;
  right: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  z-index: 10;
`,W=d.div`
  background: white;
  padding: 12px;
  border-radius: 6px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  min-width: 120px;
`,Y=d.div`
  font-size: 12px;
  margin-bottom: 8px;
  font-weight: bold;
  display: flex;
  align-items: center;
  gap: 4px;
  
  &::before {
    content: '⋮⋮';
    color: #ccc;
    font-size: 10px;
    line-height: 1;
  }
`,le=d.div`
  display: flex;
  flex-direction: column;
  gap: 4px;
`,C=d.div`
  display: flex;
  align-items: center;
  gap: 8px;
`,H=d.span`
  font-size: 14px;
`,Ae=d.div`
  width: 100%;
  margin-bottom: 16px;
  
  .ant-alert {
    border-radius: 8px;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
    border: 1px solid #d9ecff;
    
    .ant-alert-message {
      font-weight: 600;
      margin-bottom: 4px;
      color: #1890ff;
    }
    
    .ant-alert-description {
      line-height: 1.6;
      color: rgba(0, 0, 0, 0.65);
      margin: 0;
    }
    
    .ant-alert-icon {
      color: #1890ff;
    }
  }
  
  @media (max-width: 1200px) {
    .ant-alert {
      .ant-alert-description {
        font-size: 13px;
      }
    }
  }
  
  @media (max-width: 768px) {
    margin-bottom: 12px;
    
    .ant-alert {
      .ant-alert-message {
        font-size: 14px;
      }
      
      .ant-alert-description {
        font-size: 12px;
        line-height: 1.5;
      }
    }
  }
`,Oe=d.div`
  width: 100%;
  display: flex;
  flex-direction: column;
`,D=d.span`
  font-size: 11px;
`,qe=d.div`
  display: flex;
  flex-direction: column;
  gap: 4px;
`,Qe=d.div`
  display: flex;
  align-items: center;
  gap: 8px;
`,Ke=d.span`
  font-size: 11px;
  color: #666;
`,B=[{id:"L5",name:"L5 - 业务场景层",level:5,color:"rgba(114, 46, 209, 0.1)",borderColor:"#722ed1",description:"业务场景和用户体验层面",height:120},{id:"L4",name:"L4 - 业务链路层",level:4,color:"rgba(24, 144, 255, 0.1)",borderColor:"#1890ff",description:"业务流程和链路层面",height:120},{id:"L3",name:"L3 - 业务系统层",level:3,color:"rgba(82, 196, 26, 0.1)",borderColor:"#52c41a",description:"业务应用和系统层面",height:120},{id:"L2",name:"L2 - 中间件层",level:2,color:"rgba(250, 173, 20, 0.1)",borderColor:"#faad14",description:"中间件和服务层面",height:120},{id:"L1",name:"L1 - 基础设施层",level:1,color:"rgba(255, 77, 79, 0.1)",borderColor:"#ff4d4f",description:"基础设施和资源层面",height:120}],Ge=({nodes:r,onNodeClick:a})=>{const b=x.useRef(null),p=x.useMemo(()=>r,[JSON.stringify(r)]),i=(l,n,h)=>{const S=h-60-40,k=10,L=5-l.level,I=B.length,c=(S-k*(I-1))/I;return{x:20,y:80+L*(c+k),width:n-20*2,height:c,rx:8,ry:8}},R=(l,n)=>{if(l.length===0)return;const h=80,v=n.width-40*2;let S=h,k=(l.length-1)*S;k>v&&(S=Math.max(60,v/(l.length-1)),k=(l.length-1)*S);const L=n.x+(n.width-k)/2,I=n.y+n.height/2,c=Math.floor(v/h)+1;if(l.length<=c)l.forEach((u,w)=>{u.x=L+w*S,u.y=I});else{const u=Math.ceil(l.length/c),w=Math.max(80,(n.height-40)/u);l.forEach((t,s)=>{const o=Math.floor(s/c),f=s%c,pe=(Math.min(c,l.length-o*c)-1)*h,ye=n.x+(n.width-pe)/2;t.x=ye+f*h,t.y=n.y+40+o*w})}},P=()=>{if(!p||p.length===0||!b.current)return;const l=T(b.current);l.selectAll("*").remove();const n=1200,h=800,y=p.map(t=>({...t})),v=l.append("g"),S=new Map;B.forEach(t=>{S.set(t.id,y.filter(s=>s.layer===t.id))}),B.forEach(t=>{const s=i(t,n,h),o=S.get(t.id)||[];R(o,s);const f=v.append("g").attr("class",`layer-${t.id}`);f.append("rect").attr("x",s.x).attr("y",s.y).attr("width",s.width).attr("height",s.height).attr("rx",s.rx).attr("ry",s.ry).attr("fill",t.color).attr("stroke",t.borderColor).attr("stroke-width",2).attr("stroke-dasharray","8,4").attr("opacity",.8),f.append("text").attr("x",s.x+20).attr("y",s.y+25).attr("font-size","16px").attr("font-weight","bold").attr("fill",t.borderColor).text(t.name),f.append("text").attr("x",s.x+20).attr("y",s.y+45).attr("font-size","12px").attr("fill","#666").text(t.description),f.append("text").attr("x",s.x+s.width-100).attr("y",s.y+25).attr("font-size","12px").attr("fill","#666").text(`节点数: ${o.length}`)});const k=[];y.forEach(t=>{t.dependencies&&t.dependencies.forEach(s=>{const o=y.find(f=>f.id===s);o&&k.push({source:o,target:t,type:"dependency"})})}),l.append("defs").append("marker").attr("id","dependency-arrow").attr("viewBox","0 -5 10 10").attr("refX",35).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("fill","#666");const I=v.append("g").selectAll("line").data(k).enter().append("line").attr("stroke","#666").attr("stroke-opacity",.6).attr("stroke-width",2).attr("stroke-dasharray","5,5").attr("marker-end","url(#dependency-arrow)").attr("x1",t=>t.source.x).attr("y1",t=>t.source.y).attr("x2",t=>t.target.x).attr("y2",t=>t.target.y),c=t=>{switch(t){case N.COMPLETED:return"#52c41a";case N.RUNNING:return"#1890ff";case N.FAILED:return"#ff4d4f";case N.PENDING:return"#d9d9d9";case N.SKIPPED:return"#faad14";default:return"#d9d9d9"}},u=t=>{switch(t.layer){case"L5":return"🎯";case"L4":return"🔗";case"L3":return"💼";case"L2":return"⚙️";case"L1":return"🏗️";default:return t.type==="entity"?"🔧":"⚡"}},w=v.append("g").selectAll("g").data(y).enter().append("g").attr("class","node").attr("transform",t=>`translate(${t.x},${t.y})`).style("cursor","grab").call(Ne().on("start",function(t,s){T(this).classed("dragging",!0),T(this).style("cursor","grabbing"),T(this).select("circle").transition().duration(100).attr("r",35).attr("stroke-width",4),t.sourceEvent.stopPropagation()}).on("drag",function(t,s){s.x=t.x,s.y=t.y,T(this).attr("transform",`translate(${s.x},${s.y})`),I.attr("x1",o=>o.source.x).attr("y1",o=>o.source.y).attr("x2",o=>o.target.x).attr("y2",o=>o.target.y)}).on("end",function(t,s){T(this).classed("dragging",!1),T(this).style("cursor","grab"),T(this).select("circle").transition().duration(200).attr("r",30).attr("stroke-width",3),setTimeout(()=>{t.sourceEvent.preventDefault=!1},100)}));w.append("circle").attr("r",30).attr("fill",t=>c(t.status)).attr("stroke","#fff").attr("stroke-width",3).attr("filter","drop-shadow(2px 2px 4px rgba(0,0,0,0.2))"),w.append("text").attr("text-anchor","middle").attr("dy","0.35em").attr("font-size","16px").text(t=>u(t)),w.append("text").attr("text-anchor","middle").attr("dy","3.8em").attr("font-size","12px").attr("fill","#333").attr("font-weight","500").text(t=>t.name),w.on("click",function(t,s){t.defaultPrevented||a&&a(s)}),w.on("mouseenter",function(t,s){T(this).classed("dragging")||T(this).select("circle").transition().duration(200).attr("r",35).attr("stroke-width",4)}).on("mouseleave",function(t,s){T(this).classed("dragging")||T(this).select("circle").transition().duration(200).attr("r",30).attr("stroke-width",3)})};return x.useEffect(()=>{P()},[p]),e.jsxs(Oe,{children:[e.jsx(Ae,{children:e.jsx(X,{message:"分层拓扑视图",description:"按照业务层级从上到下展示节点关系：L5业务场景层 → L4业务链路层 → L3业务系统层 → L2中间件层 → L1基础设施层。可以拖拽节点调整位置，点击节点查看详细信息。",type:"info",showIcon:!0})}),e.jsxs(Be,{children:[e.jsx("svg",{ref:b}),e.jsxs(Fe,{children:[e.jsxs(W,{children:[e.jsx(Y,{children:"执行状态"}),e.jsxs(le,{children:[e.jsxs(C,{children:[e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",background:"#52c41a"}}),e.jsx(D,{children:"已完成"})]}),e.jsxs(C,{children:[e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",background:"#1890ff"}}),e.jsx(D,{children:"运行中"})]}),e.jsxs(C,{children:[e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",background:"#d9d9d9"}}),e.jsx(D,{children:"等待中"})]}),e.jsxs(C,{children:[e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",background:"#ff4d4f"}}),e.jsx(D,{children:"失败"})]}),e.jsxs(C,{children:[e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",background:"#faad14"}}),e.jsx(D,{children:"已跳过"})]})]})]}),e.jsxs(W,{children:[e.jsx(Y,{children:"业务层级"}),e.jsx(qe,{children:B.map(l=>e.jsxs(Qe,{children:[e.jsx("div",{style:{width:12,height:12,background:l.color,border:`1px solid ${l.borderColor}`,borderRadius:2}}),e.jsx(Ke,{children:l.name})]},l.id))})]}),e.jsxs(W,{children:[e.jsx(Y,{children:"图标说明"}),e.jsxs(le,{children:[e.jsxs(C,{children:[e.jsx(H,{children:"🎯"}),e.jsx(D,{children:"业务场景"})]}),e.jsxs(C,{children:[e.jsx(H,{children:"🔗"}),e.jsx(D,{children:"业务链路"})]}),e.jsxs(C,{children:[e.jsx(H,{children:"💼"}),e.jsx(D,{children:"业务系统"})]}),e.jsxs(C,{children:[e.jsx(H,{children:"⚙️"}),e.jsx(D,{children:"中间件"})]}),e.jsxs(C,{children:[e.jsx(H,{children:"🏗️"}),e.jsx(D,{children:"基础设施"})]})]})]})]})]})]})},{Text:xt}=Z,We=({visible:r,node:a,panels:b,allNodes:p,onClose:i})=>{var l;const R=n=>{switch(n){case"success":return e.jsx(Q,{style:{color:"#52c41a"}});case"warning":return e.jsx(ue,{style:{color:"#faad14"}});case"error":return e.jsx(te,{style:{color:"#ff4d4f"}});default:return e.jsx(he,{style:{color:"#1890ff"}})}},P=n=>{switch(n){case"health_check":return e.jsx(me,{style:{color:"#52c41a"}});case"performance_analysis":return e.jsx(de,{style:{color:"#1890ff"}});case"fault_analysis":return e.jsx(ce,{style:{color:"#ff4d4f"}});case"security_scan":return e.jsx(oe,{style:{color:"#faad14"}});default:return e.jsx(ee,{style:{color:"#666"}})}};return a?e.jsx(ve,{title:`${a.name} - 详细信息`,placement:"right",width:600,open:r,onClose:i,children:e.jsxs("div",{children:[e.jsx(_,{title:"基本信息",size:"small",style:{marginBottom:16},children:e.jsxs(j,{column:1,size:"small",children:[e.jsx(j.Item,{label:"节点名称",children:a.name}),e.jsx(j.Item,{label:"节点类型",children:e.jsx(z,{color:a.type==="entity"?"blue":"green",children:a.type==="entity"?"实体":"时序"})}),e.jsx(j.Item,{label:"分类",children:a.category}),e.jsx(j.Item,{label:"所属面板",children:e.jsx(z,{color:"purple",children:(l=b.find(n=>n.id===a.panel))==null?void 0:l.name})}),e.jsx(j.Item,{label:"执行状态",children:e.jsx(q,{status:a.status==="completed"?"success":a.status==="running"?"processing":a.status==="failed"?"error":"default",text:a.status==="completed"?"已完成":a.status==="running"?"运行中":a.status==="failed"?"失败":a.status==="pending"?"等待中":"未知"})}),e.jsx(j.Item,{label:"开始时间",children:a.startTime||"未开始"}),e.jsx(j.Item,{label:"结束时间",children:a.endTime||"未结束"}),e.jsx(j.Item,{label:"执行时长",children:a.duration?`${a.duration}秒`:"未完成"})]})}),e.jsx(_,{title:"检查动作",size:"small",style:{marginBottom:16},children:e.jsx(K,{wrap:!0,children:a.actions.map(n=>e.jsx(z,{color:"blue",icon:P(n),children:n==="health_check"?"健康检查":n==="performance_analysis"?"性能分析":n==="fault_analysis"?"故障分析":n==="security_scan"?"安全扫描":n},n))})}),a.results&&a.results.length>0&&e.jsx(_,{title:"执行结果",size:"small",children:e.jsx(ie,{children:a.results.map((n,h)=>e.jsx(ie.Item,{dot:R(n.status),children:e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:4},children:n.actionName}),e.jsx("div",{style:{color:"#666",marginBottom:4},children:n.message}),e.jsx("div",{style:{fontSize:12,color:"#999"},children:n.timestamp})]})},h))})}),a.dependencies&&a.dependencies.length>0&&e.jsx(_,{title:"依赖节点",size:"small",style:{marginTop:16},children:e.jsx(K,{wrap:!0,children:a.dependencies.map(n=>{const h=p.find(y=>y.id===n);return e.jsx(z,{color:(h==null?void 0:h.status)==="completed"?"green":"default",children:(h==null?void 0:h.name)||n},n)})})})]})}):null},Ye=[{id:"scenario_001",name:"用户购买流程",type:"sequence",category:"business_scenario",layer:"L5",status:"running",actions:["场景监控","用户体验分析"],dependencies:[]},{id:"scenario_002",name:"订单履约场景",type:"sequence",category:"business_scenario",layer:"L5",status:"completed",actions:["履约监控","异常处理"],dependencies:[]},{id:"chain_001",name:"用户注册链路",type:"sequence",category:"business_chain",layer:"L4",status:"completed",actions:["链路追踪","性能监控"],dependencies:["scenario_001"]},{id:"chain_002",name:"支付处理链路",type:"sequence",category:"business_chain",layer:"L4",status:"running",actions:["支付监控","风控检查"],dependencies:["scenario_001"]},{id:"chain_003",name:"库存管理链路",type:"sequence",category:"business_chain",layer:"L4",status:"pending",actions:["库存监控","补货预警"],dependencies:["scenario_002"]},{id:"system_001",name:"用户管理系统",type:"entity",category:"business_system",layer:"L3",status:"completed",actions:["系统健康检查","接口监控"],dependencies:["chain_001"]},{id:"system_002",name:"订单管理系统",type:"entity",category:"business_system",layer:"L3",status:"running",actions:["订单处理监控","数据一致性检查"],dependencies:["chain_002","chain_003"]},{id:"system_003",name:"支付系统",type:"entity",category:"business_system",layer:"L3",status:"completed",actions:["支付网关检查","交易监控"],dependencies:["chain_002"]},{id:"system_004",name:"库存系统",type:"entity",category:"business_system",layer:"L3",status:"failed",actions:["库存同步检查","预警机制"],dependencies:["chain_003"]},{id:"middleware_001",name:"API网关",type:"entity",category:"middleware",layer:"L2",status:"completed",actions:["网关健康检查","限流监控"],dependencies:["system_001","system_002","system_003"]},{id:"middleware_002",name:"Redis缓存",type:"entity",category:"middleware",layer:"L2",status:"running",actions:["缓存命中率检查","内存使用监控"],dependencies:["system_001","system_002"]},{id:"middleware_003",name:"消息队列",type:"entity",category:"middleware",layer:"L2",status:"completed",actions:["队列积压监控","消费者状态检查"],dependencies:["system_002","system_004"]},{id:"middleware_004",name:"配置中心",type:"entity",category:"middleware",layer:"L2",status:"completed",actions:["配置同步检查","版本管理"],dependencies:["system_001","system_002","system_003","system_004"]},{id:"infra_001",name:"Kubernetes集群",type:"entity",category:"infrastructure",layer:"L1",status:"completed",actions:["集群健康检查","资源使用监控"],dependencies:["middleware_001","middleware_002","middleware_003"]},{id:"infra_002",name:"MySQL数据库",type:"entity",category:"infrastructure",layer:"L1",status:"running",actions:["数据库性能检查","连接池监控"],dependencies:["middleware_002","middleware_004"]},{id:"infra_003",name:"负载均衡器",type:"entity",category:"infrastructure",layer:"L1",status:"completed",actions:["负载均衡检查","健康节点监控"],dependencies:["middleware_001"]},{id:"infra_004",name:"存储系统",type:"entity",category:"infrastructure",layer:"L1",status:"completed",actions:["存储容量检查","IO性能监控"],dependencies:["middleware_003","middleware_004"]},{id:"infra_005",name:"网络设备",type:"entity",category:"infrastructure",layer:"L1",status:"completed",actions:["网络连通性检查","带宽使用监控"],dependencies:["middleware_001","middleware_002","middleware_003","middleware_004"]}],Xe={L5:"L5 - 业务场景层",L4:"L4 - 业务链路层",L3:"L3 - 业务系统层",L2:"L2 - 中间件层",L1:"L1 - 基础设施层"},Je=r=>Xe[r]||r,Ze=()=>Ye.map(r=>({...r,status:r.status})),et=r=>{const a={L5:{total:0,completed:0,running:0,failed:0,pending:0},L4:{total:0,completed:0,running:0,failed:0,pending:0},L3:{total:0,completed:0,running:0,failed:0,pending:0},L2:{total:0,completed:0,running:0,failed:0,pending:0},L1:{total:0,completed:0,running:0,failed:0,pending:0}};return r.forEach(b=>{const p=b.layer;if(a[p])switch(a[p].total++,b.status){case N.COMPLETED:a[p].completed++;break;case N.RUNNING:a[p].running++;break;case N.FAILED:a[p].failed++;break;case N.PENDING:a[p].pending++;break}}),a},tt=d.div`
  padding: 16px;
  border: 1px solid #d9d9d9;
  border-radius: 8px;
  text-align: center;
  min-height: 120px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  background: #fafafa;
  transition: all 0.3s ease;
  cursor: default;

  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    border-color: #1890ff;
  }
`,at=d.div`
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 12px;
  line-height: 1.3;
  color: #262626;
  word-break: break-word;
`,st=d.div`
  font-size: 14px;
  color: #1890ff;
  margin-bottom: 12px;
  font-weight: 500;
`,it=d.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
  font-size: 12px;
  font-weight: 500;
`,F=d.div`
  color: ${r=>r.$statusColor};
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4px;
  border-radius: 4px;
  background: ${r=>r.$bgColor};
`,nt=d.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
`,rt=d.div`
  font-size: 12px;
  color: #8c8c8c;
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  margin-top: 4px;
`,A=d.span`
  display: flex;
  align-items: center;
  gap: 4px;
`,{Title:lt,Text:ot}=Z,ct=d.div`
  padding: 24px;
`,O=d(_)`
  .ant-card-body {
    padding: 16px;
  }
  
  .ant-statistic {
    .ant-statistic-title {
      font-size: 12px;
      color: #666;
      margin-bottom: 8px;
    }
    
    .ant-statistic-content {
      font-size: 20px;
      font-weight: 600;
    }
  }
`,ft=()=>{const{runId:r}=ge(),{t:a}=xe(["taskCollectionRunDetail","common"]),[b,p]=x.useState(!1),[i,R]=x.useState(null),[P,l]=x.useState(null),[n,h]=x.useState(!1),[y,v]=x.useState(!0),[S,k]=x.useState([]);x.useEffect(()=>{Ce(a("taskCollectionRunDetail:title")),L()},[r,a]),x.useEffect(()=>{const c=Ze();k(c)},[]),x.useEffect(()=>{let c;return y&&(i==null?void 0:i.status)==="running"&&(c=setInterval(()=>{L()},5e3)),()=>{c&&clearInterval(c)}},[y,i==null?void 0:i.status]);const L=async()=>{p(!0);try{await new Promise(u=>setTimeout(u,500));const c={id:r||"1",collectionId:"1",collectionName:a("taskCollectionRunDetail:actions.healthCheck"),status:"running",startTime:"2024-06-24 13:00:00",totalNodes:8,completedNodes:5,failedNodes:1,successRate:75,createdBy:a("taskCollectionRunDetail:creator"),panels:[{id:"application_layer",name:a("taskCollectionRunDetail:layerStats.applicationLayer"),level:1,color:"rgba(24, 144, 255, 0.1)",borderColor:"#1890ff",description:a("taskCollectionRunDetail:layerStats.description.applicationLayer")},{id:"service_layer",name:a("taskCollectionRunDetail:layerStats.serviceLayer"),level:2,color:"rgba(82, 196, 26, 0.1)",borderColor:"#52c41a",description:a("taskCollectionRunDetail:layerStats.description.serviceLayer")},{id:"data_layer",name:a("taskCollectionRunDetail:layerStats.dataLayer"),level:3,color:"rgba(250, 173, 20, 0.1)",borderColor:"#faad14",description:a("taskCollectionRunDetail:layerStats.description.dataLayer")}],nodes:[{id:"node_1",name:"用户服务",type:"entity",category:"微服务",panel:"service_layer",status:"completed",actions:["health_check","performance_analysis"],startTime:"2024-06-24 13:00:00",endTime:"2024-06-24 13:02:30",duration:150,dependencies:[],results:[{actionId:"health_check",actionName:"健康检查",status:"success",message:"服务运行正常，响应时间 < 100ms",timestamp:"2024-06-24 13:01:00"},{actionId:"performance_analysis",actionName:"性能分析",status:"success",message:"CPU使用率: 45%, 内存使用率: 60%",timestamp:"2024-06-24 13:02:30"}]},{id:"node_2",name:"订单服务",type:"entity",category:"微服务",panel:"service_layer",status:"failed",actions:["health_check","fault_analysis"],startTime:"2024-06-24 13:00:00",endTime:"2024-06-24 13:03:00",duration:180,dependencies:["node_1"],results:[{actionId:"health_check",actionName:"健康检查",status:"error",message:"服务响应超时，连接失败",timestamp:"2024-06-24 13:01:30"},{actionId:"fault_analysis",actionName:"故障分析",status:"warning",message:"检测到内存泄漏风险",timestamp:"2024-06-24 13:03:00"}]},{id:"node_3",name:"支付服务",type:"entity",category:"微服务",panel:"service_layer",status:"running",actions:["health_check","security_scan"],startTime:"2024-06-24 13:02:00",dependencies:["node_1"]},{id:"node_4",name:"用户登录流程",type:"sequence",category:"认证时序",panel:"application_layer",status:"completed",actions:["health_check"],startTime:"2024-06-24 13:00:30",endTime:"2024-06-24 13:01:45",duration:75,dependencies:[],results:[{actionId:"health_check",actionName:"健康检查",status:"success",message:"登录流程正常，平均响应时间 2.3s",timestamp:"2024-06-24 13:01:45"}]},{id:"node_5",name:"订单创建流程",type:"sequence",category:"业务时序",panel:"application_layer",status:"completed",actions:["health_check","performance_analysis"],startTime:"2024-06-24 13:01:00",endTime:"2024-06-24 13:03:30",duration:150,dependencies:["node_1","node_2"],results:[{actionId:"health_check",actionName:"健康检查",status:"warning",message:"流程执行成功，但响应时间较慢",timestamp:"2024-06-24 13:02:15"},{actionId:"performance_analysis",actionName:"性能分析",status:"success",message:"平均处理时间: 3.2s，成功率: 98%",timestamp:"2024-06-24 13:03:30"}]},{id:"node_6",name:"数据库连接池",type:"entity",category:"数据库",panel:"data_layer",status:"pending",actions:["health_check"],dependencies:["node_3"]},{id:"node_7",name:"缓存集群",type:"entity",category:"缓存",panel:"data_layer",status:"pending",actions:["health_check","performance_analysis"],dependencies:["node_3"]},{id:"node_8",name:"支付流程",type:"sequence",category:"支付时序",panel:"application_layer",status:"pending",actions:["health_check","security_scan"],dependencies:["node_3","node_6"]}],diagnosticReports:[{nodeId:"node_1",nodeName:"用户服务",nodeType:"entity",status:"completed",summary:{totalChecks:2,passedChecks:2,warningChecks:0,failedChecks:0},checks:[{id:"health_check",name:"健康检查",status:"success",message:"服务运行正常，响应时间 < 100ms",timestamp:"2024-06-24 13:01:00",duration:60},{id:"performance_analysis",name:"性能分析",status:"success",message:"CPU使用率: 45%, 内存使用率: 60%",timestamp:"2024-06-24 13:02:30",duration:90}],recommendations:["继续保持当前配置","建议定期清理日志文件"]},{nodeId:"node_2",nodeName:"订单服务",nodeType:"entity",status:"failed",summary:{totalChecks:2,passedChecks:0,warningChecks:1,failedChecks:1},checks:[{id:"health_check",name:"健康检查",status:"error",message:"服务响应超时，连接失败",timestamp:"2024-06-24 13:01:30",duration:30},{id:"fault_analysis",name:"故障分析",status:"warning",message:"检测到内存泄漏风险",timestamp:"2024-06-24 13:03:00",duration:150}],recommendations:["立即重启服务实例","检查网络连接配置","增加内存监控告警","优化内存使用策略"]},{nodeId:"node_4",nodeName:"用户登录流程",nodeType:"sequence",status:"completed",summary:{totalChecks:1,passedChecks:1,warningChecks:0,failedChecks:0},checks:[{id:"health_check",name:"健康检查",status:"success",message:"登录流程正常，平均响应时间 2.3s",timestamp:"2024-06-24 13:01:45",duration:75}],recommendations:["流程运行正常，无需调整"]},{nodeId:"node_5",nodeName:"订单创建流程",nodeType:"sequence",status:"completed",summary:{totalChecks:2,passedChecks:1,warningChecks:1,failedChecks:0},checks:[{id:"health_check",name:"健康检查",status:"warning",message:"流程执行成功，但响应时间较慢",timestamp:"2024-06-24 13:02:15",duration:135},{id:"performance_analysis",name:"性能分析",status:"success",message:"平均处理时间: 3.2s，成功率: 98%",timestamp:"2024-06-24 13:03:30",duration:15}],recommendations:["优化数据库查询性能","考虑增加缓存机制","监控第三方API响应时间"]}]};R(c)}catch{Te.error("加载运行详情失败")}finally{p(!1)}},I=c=>{const u={...c,panel:c.layer};l(u),h(!0)};return e.jsxs(ct,{children:[e.jsx(De,{items:[{title:a("taskCollectionRunDetail:breadcrumb.home"),path:"/dashboard",icon:e.jsx(we,{})},{title:a("taskCollectionRunDetail:breadcrumb.taskCollections"),path:"/task-management/task-collections",icon:e.jsx(Re,{})},{title:`${(i==null?void 0:i.collectionName)||a("taskCollectionRunDetail:breadcrumb.runDetail")}`,icon:e.jsx(ee,{})}]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[e.jsxs("div",{children:[e.jsxs(lt,{level:2,style:{margin:0},children:[i==null?void 0:i.collectionName," - ",a("taskCollectionRunDetail:header.runDetail")]}),e.jsx("div",{style:{marginTop:8},children:e.jsxs(K,{children:[e.jsx(q,{status:(i==null?void 0:i.status)==="running"?"processing":"success",text:(i==null?void 0:i.status)==="running"?a("taskCollectionRunDetail:runStatus.running"):a("taskCollectionRunDetail:runStatus.completed")}),e.jsxs(ot,{type:"secondary",children:[a("taskCollectionRunDetail:header.runId"),": ",r]})]})})]}),e.jsxs(K,{children:[e.jsx(ne,{icon:e.jsx(Le,{}),onClick:L,loading:b,children:a("taskCollectionRunDetail:header.refresh")}),e.jsx(ne,{type:y?"primary":"default",onClick:()=>v(!y),children:a(y?"taskCollectionRunDetail:header.stopAutoRefresh":"taskCollectionRunDetail:header.autoRefresh")})]})]}),i&&e.jsxs(e.Fragment,{children:[e.jsxs(V,{gutter:[16,16],style:{marginBottom:24},children:[e.jsx(m,{xs:12,sm:6,md:6,lg:6,xl:6,children:e.jsx(O,{children:e.jsx($,{title:a("taskCollectionRunDetail:statistics.totalNodes"),value:i.totalNodes,prefix:e.jsx(Ie,{}),valueStyle:{color:"#1890ff"}})})}),e.jsx(m,{xs:12,sm:6,md:6,lg:6,xl:6,children:e.jsx(O,{children:e.jsx($,{title:a("taskCollectionRunDetail:statistics.completedNodes"),value:i.completedNodes,prefix:e.jsx(Q,{}),valueStyle:{color:"#52c41a"}})})}),e.jsx(m,{xs:12,sm:6,md:6,lg:6,xl:6,children:e.jsx(O,{children:e.jsx($,{title:a("taskCollectionRunDetail:statistics.failedNodes"),value:i.failedNodes,prefix:e.jsx(te,{}),valueStyle:{color:"#ff4d4f"}})})}),e.jsx(m,{xs:12,sm:6,md:6,lg:6,xl:6,children:e.jsx(O,{children:e.jsx($,{title:a("taskCollectionRunDetail:statistics.successRate"),value:i.successRate,suffix:"%",prefix:e.jsx(Q,{}),valueStyle:{color:i.successRate>80?"#52c41a":"#faad14"}})})})]}),e.jsx(_,{title:e.jsxs(nt,{children:[e.jsx("span",{children:a("taskCollectionRunDetail:statistics.layeredStatistics")}),e.jsxs(rt,{children:[e.jsxs(A,{children:[e.jsx("span",{style:{color:"#52c41a"},children:"✓"})," ",a("taskCollectionRunDetail:legend.completed")]}),e.jsxs(A,{children:[e.jsx("span",{style:{color:"#1890ff"},children:"●"})," ",a("taskCollectionRunDetail:legend.running")]}),e.jsxs(A,{children:[e.jsx("span",{style:{color:"#ff4d4f"},children:"✗"})," ",a("taskCollectionRunDetail:legend.failed")]}),e.jsxs(A,{children:[e.jsx("span",{style:{color:"#8c8c8c"},children:"○"})," ",a("taskCollectionRunDetail:legend.pending")]})]})]}),style:{marginBottom:24},children:e.jsx(V,{gutter:[16,16],children:Object.entries(et(S)).map(([c,u])=>e.jsx(m,{xs:24,sm:12,md:8,lg:6,xl:4,children:e.jsxs(tt,{children:[e.jsx(at,{children:Je(c)}),e.jsxs(st,{children:["总计: ",u.total]}),e.jsxs(it,{children:[e.jsxs(F,{$statusColor:"#52c41a",$bgColor:"rgba(82, 196, 26, 0.1)",title:a("taskCollectionRunDetail:legend.completed"),children:["✓ ",u.completed]}),e.jsxs(F,{$statusColor:"#1890ff",$bgColor:"rgba(24, 144, 255, 0.1)",title:a("taskCollectionRunDetail:legend.running"),children:["● ",u.running]}),e.jsxs(F,{$statusColor:"#ff4d4f",$bgColor:"rgba(255, 77, 79, 0.1)",title:a("taskCollectionRunDetail:legend.failed"),children:["✗ ",u.failed]}),e.jsxs(F,{$statusColor:"#8c8c8c",$bgColor:"rgba(140, 140, 140, 0.1)",title:a("taskCollectionRunDetail:legend.pending"),children:["○ ",u.pending]})]})]})},c))})}),e.jsx(_,{title:a("taskCollectionRunDetail:header.runDetail"),style:{marginBottom:24},children:e.jsxs(j,{column:3,children:[e.jsx(j.Item,{label:a("taskCollectionRunDetail:time.startTime"),children:i.startTime}),e.jsx(j.Item,{label:a("taskCollectionRunDetail:time.endTime"),children:i.endTime||a("taskCollectionRunDetail:runStatus.running")+"..."}),e.jsx(j.Item,{label:a("taskCollectionRunDetail:time.duration"),children:i.duration?`${i.duration}${a("common:unit.seconds")}`:a("common:loading")}),e.jsx(j.Item,{label:a("taskCollectionRunDetail:creator"),children:i.createdBy}),e.jsx(j.Item,{label:a("taskCollectionRunDetail:runStatus.title"),children:e.jsx(q,{status:i.status==="running"?"processing":"success",text:i.status==="running"?a("taskCollectionRunDetail:runStatus.running"):a("taskCollectionRunDetail:runStatus.completed")})}),e.jsx(j.Item,{label:a("common:progress"),children:e.jsx(J,{percent:Math.round(i.completedNodes/i.totalNodes*100),size:"small"})})]})}),e.jsx(_,{title:a("taskCollectionRunDetail:diagnosticReports.title"),style:{marginBottom:24},children:e.jsx(Ee,{nodeIds:i.nodes.map(c=>c.id)})}),e.jsx(_,{title:a("taskCollectionRunDetail:topology.title"),style:{marginBottom:24},children:e.jsx(Ge,{nodes:S,onNodeClick:I})}),e.jsx(We,{visible:n,node:P,panels:i.panels,allNodes:i.nodes,onClose:()=>h(!1)})]})]})};export{ft as default};

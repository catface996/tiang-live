import{a as re,b as ie,u as te,c as ae,j as e,d as C}from"./index-CxXKn8Du.js";import{r as R,Y as le,U as u,Z as ne,_ as T,B as k,K as I,N as de,T as oe,$ as ce,j as D,t as f,h as K,a0 as xe,a1 as he,a2 as me,a3 as pe,x as p,d as g,C as l,S as h,a4 as E,a as $,W as v,a5 as je,a6 as N,i as x,a7 as fe,a8 as ge,a9 as ye,aa as w,P as z,ab as O}from"./antd-mjhx-L7S.js";import{s as ue}from"./index-Daowydkz.js";import{g as ve}from"./reportService-DqILwhV_.js";import"./vendor-DJG_os-6.js";const{Title:y,Paragraph:U,Text:o}=oe,B=C.div`
  padding: 24px;
  min-height: 100vh;
  background: ${n=>n.$isDark?"#000000":"#f5f5f5"};
  transition: all 0.3s ease;
`,V=C(x)`
  margin-bottom: 24px;
  border-radius: 8px;
  box-shadow: ${n=>n.$isDark?"0 2px 8px rgba(255, 255, 255, 0.05)":"0 2px 8px rgba(0, 0, 0, 0.06)"};
  border: ${n=>n.$isDark?"1px solid #303030":"1px solid #f0f0f0"};
  background: ${n=>n.$isDark?"#141414":"#ffffff"};
  transition: all 0.3s ease;
  
  .ant-card-body {
    padding: 24px;
  }
  
  .ant-card-head {
    background: ${n=>n.$isDark?"#141414":"#ffffff"};
    border-bottom: ${n=>n.$isDark?"1px solid #303030":"1px solid #f0f0f0"};
  }
`,S=C(x)`
  text-align: center;
  border-radius: 8px;
  background: ${n=>n.$isDark?"#141414":"#ffffff"};
  border: ${n=>n.$isDark?"1px solid #303030":"1px solid #f0f0f0"};
  transition: all 0.3s ease;
  
  .ant-statistic-content {
    color: ${n=>n.$isDark?"#ffffff":"#262626"};
  }
`,Se=()=>{var W;const[n,L]=R.useState(!0),[d,P]=R.useState(null),{id:A}=re(),F=ie(),{t:i}=te(["reports","common"]),{currentTheme:Y}=ae(r=>r.theme);le.useToken();const a=Y==="dark";R.useEffect(()=>{ue(i("reports:detail.title")),(async()=>{try{L(!0);const j=await ve(A||"");P(j)}catch(j){console.error("Failed to load report data:",j),P(null)}finally{L(!1)}})()},[i,A]);const Z=r=>({published:"green",draft:"orange",archived:"default"})[r]||"default",_=r=>({published:i("reports:status.published"),draft:i("reports:status.draft"),archived:i("reports:status.archived")})[r]||r,G=r=>({healthy:"success",warning:"warning",critical:"error"})[r]||"default",M=r=>({high:"red",medium:"orange",low:"blue"})[r]||"default",J=[{title:i("reports:detail.service"),dataIndex:"service",key:"service",width:"25%"},{title:i("reports:detail.status"),dataIndex:"status",key:"status",width:"15%",render:r=>e.jsx(u,{status:G(r),text:i(r==="healthy"?"reports:detail.healthy":r==="warning"?"reports:detail.warning":"reports:detail.critical")})},{title:i("reports:detail.responseTime"),dataIndex:"responseTime",key:"responseTime",width:"15%"},{title:i("reports:detail.errorRate"),dataIndex:"errorRate",key:"errorRate",width:"15%"},{title:i("reports:detail.availability"),dataIndex:"availability",key:"availability",width:"15%"},{title:i("reports:detail.requests"),dataIndex:"requests",key:"requests",width:"15%"}];return n?e.jsx(B,{$isDark:a,children:e.jsxs("div",{style:{textAlign:"center",padding:"100px 0"},children:[e.jsx(ne,{size:"large"}),e.jsx("div",{style:{marginTop:16,color:a?"#ffffff":"#666666"},children:i("reports:detail.loading")})]})}):d?e.jsxs(B,{$isDark:a,children:[e.jsxs(I,{style:{marginBottom:24},children:[e.jsx(I.Item,{children:e.jsx(de,{})}),e.jsx(I.Item,{children:e.jsx("span",{onClick:()=>F("/reports"),style:{cursor:"pointer"},children:i("reports:title")})}),e.jsx(I.Item,{children:d.name})]}),e.jsxs(V,{$isDark:a,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs(y,{level:2,style:{margin:0,color:a?"#ffffff":"#262626"},children:[e.jsx(ce,{style:{marginRight:12}}),d.name]}),e.jsxs(D,{style:{marginTop:8},children:[e.jsx(f,{color:Z(d.status),children:_(d.status)}),e.jsxs(o,{type:"secondary",children:[e.jsx(K,{})," ",d.author]}),e.jsxs(o,{type:"secondary",children:[e.jsx(xe,{})," ",d.createdAt]})]})]}),e.jsxs(D,{children:[e.jsx(k,{icon:e.jsx(he,{}),children:i("reports:detail.share")}),e.jsx(k,{icon:e.jsx(me,{}),children:i("reports:detail.print")}),e.jsx(k,{type:"primary",icon:e.jsx(pe,{}),children:i("reports:detail.download")})]})]}),e.jsx(U,{style:{color:a?"#ffffff":"#595959",fontSize:16},children:d.description}),e.jsxs(p,{column:4,style:{marginTop:24},children:[e.jsx(p.Item,{label:i("reports:detail.fileSize"),children:d.size}),e.jsx(p.Item,{label:i("reports:detail.downloads"),children:d.downloads}),e.jsx(p.Item,{label:i("reports:detail.lastModified"),children:d.lastModified}),e.jsx(p.Item,{label:i("reports:detail.reportId"),children:d.id})]})]}),d.summary&&e.jsxs(g,{gutter:[16,16],style:{marginBottom:24},children:[e.jsx(l,{xs:24,sm:12,md:6,children:e.jsx(S,{$isDark:a,children:e.jsx(h,{title:i("reports:detail.totalServices"),value:d.summary.totalServices,prefix:e.jsx(E,{}),valueStyle:{color:"#1890ff"}})})}),e.jsx(l,{xs:24,sm:12,md:6,children:e.jsx(S,{$isDark:a,children:e.jsx(h,{title:i("reports:detail.healthyServices"),value:d.summary.healthyServices,prefix:e.jsx($,{}),valueStyle:{color:"#52c41a"}})})}),e.jsx(l,{xs:24,sm:12,md:6,children:e.jsx(S,{$isDark:a,children:e.jsx(h,{title:i("reports:detail.warningServices"),value:d.summary.warningServices,prefix:e.jsx(v,{}),valueStyle:{color:"#faad14"}})})}),e.jsx(l,{xs:24,sm:12,md:6,children:e.jsx(S,{$isDark:a,children:e.jsx(h,{title:i("reports:detail.overallScore"),value:d.summary.overallScore,suffix:"%",prefix:e.jsx(je,{}),valueStyle:{color:"#722ed1"}})})})]}),(W=d.sections)==null?void 0:W.map((r,j)=>{var q,H;return e.jsxs(V,{$isDark:a,title:r.titleKey?i(`reports:sections.${r.titleKey}`):r.title,children:[e.jsx(U,{style:{color:a?"#ffffff":"#595959"},children:r.content}),r.type==="analysis"&&r.data&&e.jsx(N,{columns:J,dataSource:r.data,pagination:!1,size:"middle",style:{marginTop:16}}),r.type==="trend"&&e.jsxs("div",{children:[r.metrics&&e.jsx(g,{gutter:[16,16],style:{marginBottom:24},children:r.metrics.map((s,t)=>e.jsx(l,{xs:24,sm:12,md:6,children:e.jsxs(x,{size:"small",children:[e.jsx(h,{title:s.name,value:s.current,precision:s.name.includes("率")?1:0,valueStyle:{color:s.status==="good"?"#3f8600":s.status==="warning"||s.status==="critical"?"#cf1322":"#1890ff"},prefix:s.trend.startsWith("+")?e.jsx(fe,{}):s.trend.startsWith("-")?e.jsx(ge,{}):null,suffix:e.jsxs("span",{style:{fontSize:"12px",marginLeft:"8px"},children:["(",s.trend,")"]})}),e.jsx("div",{style:{fontSize:"12px",color:a?"#ffffff80":"#00000073",marginTop:"8px"},children:s.description})]})},t))}),r.trendData&&e.jsxs("div",{style:{background:a?"#1f1f1f":"#fafafa",padding:"16px",borderRadius:"6px",marginTop:"16px"},children:[e.jsx("div",{style:{marginBottom:"16px",fontWeight:"bold"},children:"趋势图表"}),Object.entries(r.trendData).map(([s,t])=>{var c,m;return e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("div",{style:{marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:s==="responseTime"?"响应时间趋势":s==="throughput"?"吞吐量趋势":s==="errorRate"?"错误率趋势":s==="availability"?"可用性趋势":s}),e.jsx("div",{style:{display:"flex",alignItems:"end",height:"100px",gap:"4px",padding:"8px",background:a?"#262626":"#ffffff",borderRadius:"4px"},children:t.map((b,Q)=>{const X=Math.max(...t.map(se=>se.value)),ee=b.value/X*80;return e.jsx("div",{style:{flex:1,height:`${ee}px`,background:s==="errorRate"?"#ff4d4f":s==="availability"&&b.value<99?"#faad14":"#1890ff",borderRadius:"2px",position:"relative",minHeight:"4px"},title:`${b.date}: ${b.value}${s==="responseTime"?"ms":s==="throughput"?"K req/s":s==="errorRate"||s==="availability"?"%":""}`},Q)})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:a?"#ffffff80":"#00000073",marginTop:"4px"},children:[e.jsx("span",{children:(c=t[0])==null?void 0:c.date}),e.jsx("span",{children:(m=t[t.length-1])==null?void 0:m.date})]})]},s)})]}),r.analysis&&e.jsx("div",{style:{marginTop:"24px"},children:e.jsxs(g,{gutter:[16,16],children:[e.jsx(l,{xs:24,md:12,children:e.jsx(x,{title:"关键发现",size:"small",children:e.jsx("ul",{style:{paddingLeft:"16px",margin:0},children:(q=r.analysis.keyFindings)==null?void 0:q.map((s,t)=>e.jsx("li",{style:{marginBottom:"8px"},children:s},t))})})}),e.jsx(l,{xs:24,md:12,children:e.jsx(x,{title:"根本原因",size:"small",children:e.jsx("ul",{style:{paddingLeft:"16px",margin:0},children:(H=r.analysis.rootCauses)==null?void 0:H.map((s,t)=>e.jsx("li",{style:{marginBottom:"8px"},children:s},t))})})})]})})]}),r.type==="dependency"&&e.jsxs("div",{children:[r.summary&&e.jsxs(g,{gutter:[16,16],style:{marginBottom:24},children:[e.jsx(l,{xs:12,sm:8,md:4,children:e.jsx(x,{size:"small",children:e.jsx(h,{title:"总平面数",value:r.summary.totalPlanes,prefix:e.jsx(E,{})})})}),e.jsx(l,{xs:12,sm:8,md:4,children:e.jsx(x,{size:"small",children:e.jsx(h,{title:"总依赖数",value:r.summary.totalDependencies,prefix:e.jsx(ye,{})})})}),e.jsx(l,{xs:12,sm:8,md:4,children:e.jsx(x,{size:"small",children:e.jsx(h,{title:"强依赖",value:r.summary.strongDependencies,valueStyle:{color:"#cf1322"}})})}),e.jsx(l,{xs:12,sm:8,md:4,children:e.jsx(x,{size:"small",children:e.jsx(h,{title:"弱依赖",value:r.summary.weakDependencies,valueStyle:{color:"#52c41a"}})})}),e.jsx(l,{xs:12,sm:8,md:4,children:e.jsx(x,{size:"small",children:e.jsx(h,{title:"循环依赖",value:r.summary.circularDependencies,valueStyle:{color:"#fa8c16"}})})}),e.jsx(l,{xs:12,sm:8,md:4,children:e.jsx(x,{size:"small",children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"14px",color:"#8c8c8c",marginBottom:"4px"},children:"风险等级"}),e.jsx(u,{status:r.summary.riskLevel==="high"?"error":r.summary.riskLevel==="medium"?"warning":"success",text:r.summary.riskLevel==="high"?"高风险":r.summary.riskLevel==="medium"?"中风险":"低风险"})]})})})]}),r.dependencyMatrix&&e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(y,{level:4,children:"依赖关系矩阵"}),e.jsx(N,{columns:[{title:"源平面",dataIndex:"source",key:"source",width:120,render:s=>e.jsx(f,{color:"blue",children:s})},{title:"目标平面",dataIndex:"target",key:"target",width:120,render:s=>e.jsx(f,{color:"green",children:s})},{title:"依赖类型",dataIndex:"type",key:"type",width:100,render:s=>{const c={"api-call":{color:"purple",text:"API调用"},configuration:{color:"orange",text:"配置依赖"},"data-flow":{color:"cyan",text:"数据流"},metrics:{color:"geekblue",text:"指标收集"},metadata:{color:"magenta",text:"元数据"}}[s]||{color:"default",text:s};return e.jsx(f,{color:c.color,children:c.text})}},{title:"依赖强度",dataIndex:"strength",key:"strength",width:100,render:s=>e.jsx(u,{status:s==="strong"?"error":s==="medium"?"warning":"success",text:s==="strong"?"强":s==="medium"?"中":"弱"})},{title:"调用频率",dataIndex:"frequency",key:"frequency",width:100,render:s=>{const t={"very-high":"#ff4d4f",high:"#fa8c16",medium:"#fadb14",low:"#52c41a"};return e.jsx("span",{style:{color:t[s]||"#8c8c8c"},children:s==="very-high"?"极高":s==="high"?"高":s==="medium"?"中":"低"})}},{title:"平均响应时间",dataIndex:"avgResponseTime",key:"avgResponseTime",width:120,render:s=>e.jsx(o,{code:!0,children:s})},{title:"错误率",dataIndex:"errorRate",key:"errorRate",width:80,render:s=>{const t=parseFloat(s.replace("%","")),c=t>.1?"#ff4d4f":t>.05?"#fa8c16":"#52c41a";return e.jsx("span",{style:{color:c},children:s})}},{title:"关键程度",dataIndex:"criticality",key:"criticality",width:100,render:s=>e.jsx(u,{status:s==="critical"?"error":s==="high"?"warning":"success",text:s==="critical"?"关键":s==="high"?"重要":"一般"})},{title:"描述",dataIndex:"description",key:"description",ellipsis:!0}],dataSource:r.dependencyMatrix.map((s,t)=>({...s,key:t})),pagination:!1,size:"middle",scroll:{x:1200}})]}),r.criticalPaths&&e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(y,{level:4,children:"关键路径分析"}),e.jsx(g,{gutter:[16,16],children:r.criticalPaths.map((s,t)=>e.jsx(l,{xs:24,lg:12,children:e.jsxs(x,{size:"small",title:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("span",{children:["路径 ",t+1]}),e.jsx(u,{status:s.riskLevel==="high"?"error":"warning",text:s.riskLevel==="high"?"高风险":"中风险"})]}),children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx(o,{strong:!0,children:"路径："}),e.jsx("div",{style:{background:"#f5f5f5",padding:"8px",borderRadius:"4px",marginTop:"4px",fontFamily:"monospace"},children:s.path})]}),e.jsxs(p,{size:"small",column:1,children:[e.jsx(p.Item,{label:"描述",children:s.description}),e.jsx(p.Item,{label:"总延迟",children:e.jsx(o,{code:!0,children:s.totalLatency})}),e.jsx(p.Item,{label:"瓶颈",children:e.jsx(f,{color:"red",children:s.bottleneck})}),e.jsx(p.Item,{label:"影响",children:s.impact})]}),s.recommendations&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx(o,{strong:!0,children:"优化建议："}),e.jsx("ul",{style:{marginTop:4,paddingLeft:16},children:s.recommendations.map((c,m)=>e.jsx("li",{style:{marginBottom:4},children:c},m))})]})]})},t))})]}),r.performanceMetrics&&e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(y,{level:4,children:"性能指标"}),e.jsx(g,{gutter:[16,16],children:r.performanceMetrics.map((s,t)=>e.jsx(l,{xs:24,sm:12,md:8,children:e.jsxs(x,{size:"small",children:[e.jsx(h,{title:s.metric,value:s.current,suffix:e.jsxs("div",{style:{fontSize:"12px",marginTop:"4px"},children:[e.jsxs("div",{children:["目标: ",s.target]}),e.jsxs("div",{style:{color:s.trend.startsWith("+")?"#ff4d4f":s.trend.startsWith("-")?"#52c41a":"#8c8c8c"},children:["趋势: ",s.trend]})]}),prefix:s.status==="good"?e.jsx($,{style:{color:"#52c41a"}}):s.status==="warning"?e.jsx(v,{style:{color:"#fa8c16"}}):e.jsx(v,{style:{color:"#ff4d4f"}})}),e.jsx("div",{style:{marginTop:8,fontSize:"12px",color:"#8c8c8c"},children:s.description})]})},t))})]}),r.riskAnalysis&&e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(y,{level:4,children:"风险分析"}),r.riskAnalysis.singlePointFailures&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(y,{level:5,children:"单点故障风险"}),r.riskAnalysis.singlePointFailures.map((s,t)=>e.jsx(T,{message:`${s.plane} - ${s.risk==="critical"?"严重风险":"高风险"}`,description:e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("strong",{children:"影响："}),s.impact]}),e.jsxs("div",{children:[e.jsx("strong",{children:"受影响平面："}),s.affectedPlanes.join(", ")]}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("strong",{children:"缓解策略："}),e.jsx("ul",{style:{marginTop:4,paddingLeft:16},children:s.mitigationStrategies.map((c,m)=>e.jsx("li",{children:c},m))})]})]}),type:s.risk==="critical"?"error":"warning",style:{marginBottom:12}},t))]}),r.riskAnalysis.cascadeFailures&&e.jsxs("div",{children:[e.jsx(y,{level:5,children:"级联故障风险"}),r.riskAnalysis.cascadeFailures.map((s,t)=>e.jsx(T,{message:`级联故障链：${s.cascade}`,description:e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("strong",{children:"触发条件："}),s.trigger]}),e.jsxs("div",{children:[e.jsx("strong",{children:"发生概率："}),s.probability==="high"?"高":"中"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"影响："}),s.impact]}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("strong",{children:"预防措施："}),e.jsx("ul",{style:{marginTop:4,paddingLeft:16},children:s.preventionMeasures.map((c,m)=>e.jsx("li",{children:c},m))})]})]}),type:"warning",style:{marginBottom:12}},t))]})]}),r.optimizationRecommendations&&e.jsxs("div",{children:[e.jsx(y,{level:4,children:"优化建议"}),e.jsx(w,{children:r.optimizationRecommendations.map((s,t)=>e.jsx(w.Item,{color:s.priority==="high"?"red":s.priority==="medium"?"orange":"green",dot:s.priority==="high"?e.jsx(v,{}):s.priority==="medium"?e.jsx(O,{}):e.jsx($,{}),children:e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[e.jsx(f,{color:s.priority==="high"?"red":s.priority==="medium"?"orange":"green",children:s.priority==="high"?"高优先级":s.priority==="medium"?"中优先级":"低优先级"}),e.jsx(f,{color:"blue",children:s.category}),e.jsx(o,{strong:!0,children:s.title})]}),e.jsx("div",{style:{marginBottom:8},children:e.jsx(o,{children:s.description})}),e.jsxs(g,{gutter:[16,8],children:[e.jsx(l,{span:12,children:e.jsxs(o,{type:"secondary",children:[e.jsx(z,{})," 预期时间: ",s.timeline]})}),e.jsx(l,{span:12,children:e.jsxs(o,{type:"secondary",children:["工作量: ",s.effort]})}),e.jsx(l,{span:24,children:e.jsxs(o,{type:"secondary",style:{fontStyle:"italic"},children:["预期改进: ",s.expectedImprovement]})})]}),s.implementation&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx(o,{strong:!0,children:"实施步骤："}),e.jsx("ol",{style:{marginTop:4,paddingLeft:16},children:s.implementation.map((c,m)=>e.jsx("li",{style:{marginBottom:4},children:c},m))})]})]})},t))})]})]}),r.type==="recommendations"&&r.recommendations&&e.jsx(w,{style:{marginTop:16},children:r.recommendations.map((s,t)=>e.jsx(w.Item,{color:M(s.priority),dot:s.priority==="high"?e.jsx(v,{}):s.priority==="medium"?e.jsx(O,{}):e.jsx($,{}),children:e.jsxs("div",{children:[e.jsxs(D,{children:[e.jsx(f,{color:M(s.priority),children:s.priority==="high"?i("reports:detail.highPriority"):s.priority==="medium"?i("reports:detail.mediumPriority"):i("reports:detail.lowPriority")}),e.jsx(o,{strong:!0,style:{color:a?"#ffffff":"#262626"},children:s.item})]}),e.jsx("div",{style:{marginTop:8,paddingLeft:0},children:e.jsxs(g,{gutter:[16,8],children:[e.jsx(l,{span:12,children:e.jsxs(o,{type:"secondary",children:[e.jsx(z,{})," ",i("reports:detail.deadline"),": ",s.deadline]})}),s.assignee&&e.jsx(l,{span:12,children:e.jsxs(o,{type:"secondary",children:[e.jsx(K,{})," ",i("reports:detail.assignee"),": ",s.assignee]})}),s.estimatedHours&&e.jsx(l,{span:12,children:e.jsxs(o,{type:"secondary",children:[e.jsx(z,{})," ",i("reports:detail.estimatedHours"),": ",s.estimatedHours]})}),s.impact&&e.jsx(l,{span:24,children:e.jsxs(o,{type:"secondary",style:{fontStyle:"italic"},children:[i("reports:detail.expectedImpact"),": ",s.impact]})})]})})]})},t))})]},j)})]}):e.jsx(B,{$isDark:a,children:e.jsx(T,{message:i("reports:detail.notFound"),description:i("reports:detail.notFoundDesc"),type:"error",showIcon:!0,action:e.jsx(k,{size:"small",onClick:()=>F("/reports"),children:i("common:back")})})})};export{Se as default};

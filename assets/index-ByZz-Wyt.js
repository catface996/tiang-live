import{j as e,a as S}from"./react-BkaC_jdz.js";import{S as f,B as T,a9 as Fe,ab as U,c as M,h as ke,d as b,q as ce,aj as Oe,ak as Ye,al as Ve,am as Xe,X as Ze,an as He,ao as Je,n as Ke,_ as $,a3 as i,W as v,a6 as Ue,u as Ge,y as es,ap as ss,aq as ts,ar as ns,as as is,at as rs,ai as ee,e as as,au as X,j as _e,av as we,aw as os,ax as z,U as W,V as j,ay as Se,aa as Te,az as ls,a1 as Ce,ae as cs,aA as ye,aB as ds}from"./react-dom-ZHUlsYA_.js";import{s as Ae}from"./index-Daowydkz.js";import{u as ze,a3 as ps,a4 as hs,a5 as xs,a6 as us,a7 as ms,a8 as gs,a9 as ys,aa as js}from"./d3-ByniJY_B.js";import{E as ft}from"./EntityForm-DPMkfOON.js";import{default as bt}from"./EntityCreatePage-DT8bK_6o.js";import{default as wt}from"./EntityEditPage-ChSp0S9n.js";import"./vendor-CsGdsTBW.js";import"./dayjs-Bzorz0fL.js";import"./media-BbQ0wNgX.js";import"./lodash-BORto0-T.js";import"./redux-CiqK6azd.js";import"./echarts-core-7X-L1hka.js";import"./antd-icons-CI4I6I7B.js";import"./emotion-BhZTwsuK.js";const{Text:fs}=M,vs=b($)`
  margin-bottom: 16px;
  transition: all 0.3s ease;
  border-radius: 8px;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
  
  .ant-card-head {
    border-bottom: 1px solid var(--border-color);
    padding: 12px 16px;
  }
  
  .ant-card-body {
    padding: 16px;
  }
`,bs=b.div`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border-radius: 6px;
  color: white;
  font-size: 16px;
  margin-right: 8px;
`,q=({entity:s,onClick:o,onEdit:x,children:u,extraActions:l})=>{const d=k=>({report:{icon:e.jsx(Ke,{}),color:"#1890ff"},business_link:{icon:e.jsx(Je,{}),color:"#52c41a"},business_system:{icon:e.jsx(ke,{}),color:"#faad14"},api:{icon:e.jsx(He,{}),color:"#722ed1"},database:{icon:e.jsx(Ze,{}),color:"#f5222d"},table:{icon:e.jsx(Xe,{}),color:"#fa8c16"},middleware:{icon:e.jsx(Ve,{}),color:"#13c2c2"},microservice:{icon:e.jsx(Ye,{}),color:"#eb2f96"},scheduled_job:{icon:e.jsx(Oe,{}),color:"#a0d911"},configuration:{icon:e.jsx(ce,{}),color:"#2f54eb"}})[k]||{icon:e.jsx(ke,{}),color:"#8c8c8c"},w=k=>({active:"green",running:"green",inactive:"red",warning:"orange",pending:"blue"})[k]||"default",a=d(s.type);return e.jsx(vs,{size:"small",onClick:()=>o==null?void 0:o(s),style:{cursor:"pointer"},title:e.jsxs(f,{children:[e.jsx(bs,{style:{backgroundColor:a.color},children:a.icon}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:s.name}),e.jsx(fs,{type:"secondary",style:{fontSize:"12px"},children:s.category})]})]}),extra:e.jsxs(f,{children:[e.jsx(T,{type:"text",size:"small",icon:e.jsx(Fe,{}),onClick:k=>{k.stopPropagation(),x==null||x(s)},style:{color:"#1890ff"}}),l,e.jsx(U,{status:w(s.status),text:s.status})]}),children:u})},{Text:ie,Paragraph:_s}=M,je=b.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,ws=({entity:s,onClick:o,onEdit:x})=>{var u,l,d,w,a;return e.jsxs(q,{entity:s,onClick:o,onEdit:x,children:[e.jsx(_s,{ellipsis:{rows:2},style:{marginBottom:12},children:s.description}),e.jsxs(f,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(je,{children:[e.jsx(ie,{type:"secondary",children:"更新频率:"}),e.jsx(i,{color:"blue",children:s.updateFrequency})]}),e.jsxs(je,{children:[e.jsx(ie,{type:"secondary",children:"负责人:"}),e.jsx(ie,{children:s.owner})]}),e.jsxs(je,{children:[e.jsx(ie,{type:"secondary",children:"数据源:"}),e.jsx(f,{children:(u=s.dataSource)==null?void 0:u.map((k,p)=>e.jsx(i,{size:"small",children:k},p))})]}),e.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:8},children:[e.jsx(v,{title:"查看次数",value:(l=s.metrics)==null?void 0:l.viewCount,valueStyle:{fontSize:"14px"}}),e.jsx(v,{title:"导出次数",value:(d=s.metrics)==null?void 0:d.exportCount,valueStyle:{fontSize:"14px"}}),e.jsx(v,{title:"加载时间",value:(w=s.metrics)==null?void 0:w.avgLoadTime,valueStyle:{fontSize:"14px"}})]})]}),e.jsx("div",{style:{marginTop:12},children:(a=s.tags)==null?void 0:a.map((k,p)=>e.jsx(i,{size:"small",style:{marginBottom:4},children:k},p))})]})},{Text:Be,Paragraph:Ss}=M,Ts=b.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,Cs=({entity:s,onClick:o,onEdit:x})=>{var u;return e.jsxs(q,{entity:s,onClick:o,onEdit:x,children:[e.jsx(Ss,{ellipsis:{rows:2},style:{marginBottom:12},children:s.description}),e.jsxs(Ts,{children:[e.jsx(Be,{type:"secondary",children:"负责人:"}),e.jsx(Be,{children:s.owner})]}),e.jsx("div",{style:{marginTop:12},children:(u=s.tags)==null?void 0:u.map((l,d)=>e.jsx(i,{size:"small",style:{marginBottom:4},children:l},d))})]})},{Text:re,Paragraph:ks}=M,Ie=b.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,zs=({entity:s,onClick:o,onEdit:x})=>{var u,l;return e.jsxs(q,{entity:s,onClick:o,onEdit:x,extraActions:e.jsx(i,{color:"blue",children:s.version}),children:[e.jsx(ks,{ellipsis:{rows:2},style:{marginBottom:12},children:s.description}),e.jsxs(f,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(Ie,{children:[e.jsx(re,{type:"secondary",children:"负责人:"}),e.jsx(re,{children:s.owner})]}),e.jsxs(Ie,{children:[e.jsx(re,{type:"secondary",children:"技术栈:"}),e.jsx(f,{children:(u=s.techStack)==null?void 0:u.map((d,w)=>e.jsx(i,{size:"small",children:d},w))})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx(re,{type:"secondary",style:{fontSize:"12px"},children:"健康度"}),e.jsx(Ue,{percent:s.healthScore,size:"small",status:s.healthScore>80?"success":s.healthScore>60?"normal":"exception",style:{marginTop:4}})]})]}),e.jsx("div",{style:{marginTop:12},children:(l=s.tags)==null?void 0:l.map((d,w)=>e.jsx(i,{size:"small",style:{marginBottom:4},children:d},w))})]})},{Text:ae,Paragraph:Bs}=M,Re=b.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,Is=({entity:s,onClick:o,onEdit:x})=>{var l,d,w;const u=a=>({GET:"green",POST:"blue",PUT:"orange",DELETE:"red",PATCH:"purple"})[a]||"default";return e.jsxs(q,{entity:s,onClick:o,onEdit:x,extraActions:e.jsx(i,{color:u(s.method),children:s.method}),children:[e.jsx(Bs,{ellipsis:{rows:2},style:{marginBottom:12},children:s.description}),e.jsxs(f,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(Re,{children:[e.jsx(ae,{type:"secondary",children:"路径:"}),e.jsx(ae,{code:!0,style:{fontSize:"12px"},children:s.path})]}),e.jsxs(Re,{children:[e.jsx(ae,{type:"secondary",children:"负责人:"}),e.jsx(ae,{children:s.owner})]}),e.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:8},children:[e.jsx(v,{title:"调用次数",value:(l=s.metrics)==null?void 0:l.callCount,valueStyle:{fontSize:"14px"}}),e.jsx(v,{title:"响应时间",value:(d=s.metrics)==null?void 0:d.avgResponseTime,suffix:"ms",valueStyle:{fontSize:"14px"}})]})]}),e.jsx("div",{style:{marginTop:12},children:(w=s.tags)==null?void 0:w.map((a,k)=>e.jsx(i,{size:"small",style:{marginBottom:4},children:a},k))})]})},{Text:oe,Paragraph:Rs}=M,$e=b.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,$s=({entity:s,onClick:o,onEdit:x})=>{var u,l,d;return e.jsxs(q,{entity:s,onClick:o,onEdit:x,extraActions:e.jsx(i,{color:"red",children:s.technology}),children:[e.jsx(Rs,{ellipsis:{rows:2},style:{marginBottom:12},children:s.description}),e.jsxs(f,{direction:"vertical",style:{width:"100%"},children:[e.jsxs($e,{children:[e.jsx(oe,{type:"secondary",children:"连接地址:"}),e.jsxs(oe,{code:!0,style:{fontSize:"12px"},children:[s.host,":",s.port]})]}),e.jsxs($e,{children:[e.jsx(oe,{type:"secondary",children:"负责人:"}),e.jsx(oe,{children:s.owner})]}),e.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:8},children:[e.jsx(v,{title:"连接数",value:(u=s.metrics)==null?void 0:u.connectionCount,valueStyle:{fontSize:"14px"}}),e.jsx(v,{title:"存储大小",value:(l=s.metrics)==null?void 0:l.storageSize,suffix:"GB",valueStyle:{fontSize:"14px"}})]})]}),e.jsx("div",{style:{marginTop:12},children:(d=s.tags)==null?void 0:d.map((w,a)=>e.jsx(i,{size:"small",style:{marginBottom:4},children:w},a))})]})},{Text:le,Paragraph:Es}=M,Ee=b.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,Ls=({entity:s,onClick:o,onEdit:x})=>{var u;return e.jsxs(q,{entity:s,onClick:o,onEdit:x,children:[e.jsx(Es,{ellipsis:{rows:2},style:{marginBottom:12},children:s.description}),e.jsxs(Ee,{children:[e.jsx(le,{type:"secondary",children:"数据库:"}),e.jsx(le,{children:s.database})]}),e.jsxs(Ee,{children:[e.jsx(le,{type:"secondary",children:"负责人:"}),e.jsx(le,{children:s.owner})]}),e.jsx("div",{style:{marginTop:12},children:(u=s.tags)==null?void 0:u.map((l,d)=>e.jsx(i,{size:"small",style:{marginBottom:4},children:l},d))})]})},{Text:Le,Paragraph:Ps}=M,Ms=b.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,Gs=({entity:s,onClick:o,onEdit:x})=>{var u;return e.jsxs(q,{entity:s,onClick:o,onEdit:x,children:[e.jsx(Ps,{ellipsis:{rows:2},style:{marginBottom:12},children:s.description}),e.jsxs(Ms,{children:[e.jsx(Le,{type:"secondary",children:"负责人:"}),e.jsx(Le,{children:s.owner})]}),e.jsx("div",{style:{marginTop:12},children:(u=s.tags)==null?void 0:u.map((l,d)=>e.jsx(i,{size:"small",style:{marginBottom:4},children:l},d))})]})},As=({entity:s,onClick:o,onEdit:x})=>(()=>{switch(s.type){case"report":return e.jsx(ws,{entity:s,onClick:o,onEdit:x});case"business_link":return e.jsx(Cs,{entity:s,onClick:o,onEdit:x});case"business_system":return e.jsx(zs,{entity:s,onClick:o,onEdit:x});case"api":return e.jsx(Is,{entity:s,onClick:o,onEdit:x});case"database":return e.jsx($s,{entity:s,onClick:o,onEdit:x});case"table":return e.jsx(Ls,{entity:s,onClick:o,onEdit:x});case"middleware":case"microservice":case"scheduled_job":case"configuration":default:return e.jsx(Gs,{entity:s,onClick:o,onEdit:x})}})(),Ns=[{id:"business_scenario_plane",name:"业务场景平面",level:1,color:"#e6f7ff",borderColor:"#1890ff",description:"核心业务场景和用户旅程"},{id:"business_link_plane",name:"业务链路平面",level:2,color:"#f6ffed",borderColor:"#52c41a",description:"业务场景的具体执行链路"},{id:"application_plane",name:"应用平面",level:3,color:"#fff7e6",borderColor:"#faad14",description:"业务系统和应用服务层"},{id:"middleware_plane",name:"中间件平面",level:4,color:"#f9f0ff",borderColor:"#722ed1",description:"中间件和基础服务层"},{id:"infrastructure_plane",name:"基础设施平面",level:5,color:"#fff2f0",borderColor:"#f5222d",description:"基础设施和资源层"}],Qs=[{id:"business_scenario_1",name:"电商下单场景",type:"business_scenario",level:1,plane:"business_scenario_plane",description:"用户在电商平台完成商品购买的完整流程",status:"active"},{id:"business_scenario_2",name:"支付结算场景",type:"business_scenario",level:1,plane:"business_scenario_plane",description:"处理用户支付和商户结算的完整业务场景",status:"active"},{id:"business_link_1",name:"用户下单链路",type:"business_link",level:2,plane:"business_link_plane",description:"从商品选择到订单确认的业务链路",status:"active"},{id:"business_link_2",name:"支付处理链路",type:"business_link",level:2,plane:"business_link_plane",description:"支付验证、扣款、确认的业务链路",status:"active"},{id:"business_link_3",name:"风控审核链路",type:"business_link",level:2,plane:"business_link_plane",description:"交易风险识别和安全审核链路",status:"active"},{id:"business_link_4",name:"资金结算链路",type:"business_link",level:2,plane:"business_link_plane",description:"商户资金结算和清分业务链路",status:"active"},{id:"system_1",name:"用户中心系统",type:"business_system",level:3,plane:"application_plane",description:"管理用户信息、认证、权限的核心系统",status:"running",version:"v2.1.0",instances:6},{id:"system_2",name:"商品管理系统",type:"business_system",level:3,plane:"application_plane",description:"商品信息、价格、促销管理系统",status:"running",version:"v1.8.2",instances:4},{id:"system_3",name:"订单管理系统",type:"business_system",level:3,plane:"application_plane",description:"订单生命周期管理的核心系统",status:"running",version:"v3.0.1",instances:8},{id:"system_4",name:"支付网关系统",type:"business_system",level:3,plane:"application_plane",description:"统一支付接入和路由系统",status:"running",version:"v1.9.3",instances:10},{id:"system_5",name:"钱包系统",type:"business_system",level:3,plane:"application_plane",description:"用户钱包余额和虚拟账户管理系统",status:"running",version:"v2.3.1",instances:8},{id:"system_6",name:"风控系统",type:"business_system",level:3,plane:"application_plane",description:"交易风险识别和反欺诈系统",status:"running",version:"v1.7.2",instances:6},{id:"system_7",name:"清结算系统",type:"business_system",level:3,plane:"application_plane",description:"资金清分和商户结算系统",status:"running",version:"v2.0.5",instances:4},{id:"system_8",name:"账务系统",type:"business_system",level:3,plane:"application_plane",description:"资金流水和账务记录系统",status:"running",version:"v1.5.8",instances:6},{id:"middleware_1",name:"API网关",type:"middleware",level:4,plane:"middleware_plane",description:"统一API接入、路由、限流、认证网关",status:"running",technology:"Kong",instances:6},{id:"middleware_2",name:"消息队列",type:"middleware",level:4,plane:"middleware_plane",description:"异步消息处理和事件驱动架构支撑",status:"running",technology:"RocketMQ",instances:9},{id:"middleware_3",name:"规则引擎",type:"middleware",level:4,plane:"middleware_plane",description:"风控规则和业务规则执行引擎",status:"running",technology:"Drools",instances:4},{id:"infrastructure_1",name:"Kubernetes集群",type:"infrastructure",level:5,plane:"infrastructure_plane",description:"容器编排和微服务运行平台",status:"running",nodes:24,region:"华东-1"},{id:"db_cluster_payment",name:"支付数据库集群",type:"infrastructure",level:5,plane:"infrastructure_plane",description:"支付交易专用高可用MySQL集群",status:"running",technology:"MySQL 8.0",nodes:10,config:"2主8从",region:"华东-1",databases:["payment_core","wallet_account","transaction_log"]},{id:"db_cluster_risk",name:"风控数据库集群",type:"infrastructure",level:5,plane:"infrastructure_plane",description:"风控数据和规则存储MySQL集群",status:"running",technology:"MySQL 8.0",nodes:6,config:"1主5从",region:"华东-1",databases:["risk_control","fraud_detection","rule_engine"]},{id:"db_cluster_settlement",name:"清结算数据库集群",type:"infrastructure",level:5,plane:"infrastructure_plane",description:"资金清算和结算数据MySQL集群",status:"running",technology:"MySQL 8.0",nodes:8,config:"2主6从",region:"华东-1",databases:["settlement_core","accounting_ledger","merchant_account"]}],Ds=[{source:"business_scenario_1",target:"business_link_1",type:"contains",strength:1},{source:"business_scenario_2",target:"business_link_2",type:"contains",strength:1},{source:"business_scenario_2",target:"business_link_3",type:"contains",strength:1},{source:"business_scenario_2",target:"business_link_4",type:"contains",strength:1},{source:"business_link_1",target:"system_1",type:"depends_on",strength:.9},{source:"business_link_1",target:"system_2",type:"depends_on",strength:.8},{source:"business_link_1",target:"system_3",type:"depends_on",strength:1},{source:"business_link_2",target:"system_4",type:"depends_on",strength:1},{source:"business_link_2",target:"system_5",type:"depends_on",strength:.9},{source:"business_link_3",target:"system_6",type:"depends_on",strength:1},{source:"business_link_4",target:"system_7",type:"depends_on",strength:1},{source:"business_link_4",target:"system_8",type:"depends_on",strength:.9},{source:"system_4",target:"middleware_1",type:"uses",strength:1},{source:"system_5",target:"middleware_1",type:"uses",strength:.9},{source:"system_6",target:"middleware_3",type:"uses",strength:1},{source:"system_7",target:"middleware_2",type:"uses",strength:.9},{source:"system_8",target:"middleware_2",type:"uses",strength:.8},{source:"middleware_1",target:"infrastructure_1",type:"runs_on",strength:1},{source:"middleware_2",target:"infrastructure_1",type:"runs_on",strength:1},{source:"middleware_3",target:"infrastructure_1",type:"runs_on",strength:1},{source:"system_4",target:"db_cluster_payment",type:"stores_in",strength:1},{source:"system_5",target:"db_cluster_payment",type:"stores_in",strength:1},{source:"system_6",target:"db_cluster_risk",type:"stores_in",strength:1},{source:"system_7",target:"db_cluster_settlement",type:"stores_in",strength:1},{source:"system_8",target:"db_cluster_settlement",type:"stores_in",strength:1}],Ws={title:"电商平台业务关系图谱",description:"从业务场景到基础设施的完整技术架构关系图",levels:[{level:1,name:"业务场景层",description:"核心业务场景和用户旅程",color:"#1890ff"},{level:2,name:"业务链路层",description:"业务场景的具体执行链路",color:"#52c41a"},{level:3,name:"业务系统层",description:"支撑业务链路的应用系统",color:"#faad14"},{level:4,name:"中间件层",description:"系统间通信和基础服务中间件",color:"#722ed1"},{level:5,name:"基础设施层",description:"底层计算、存储、网络基础设施",color:"#f5222d"}],relationTypes:[{type:"contains",description:"包含关系",color:"#1890ff",strokeWidth:3},{type:"depends_on",description:"依赖关系",color:"#52c41a",strokeWidth:2},{type:"uses",description:"使用关系",color:"#faad14",strokeWidth:2},{type:"runs_on",description:"运行关系",color:"#722ed1",strokeWidth:2},{type:"stores_in",description:"存储关系",color:"#f5222d",strokeWidth:1}]},qs={planes:Ns,nodes:Qs,links:Ds,metadata:Ws},Fs=b.div`
  width: 100%;
  height: 800px;
  border: 1px solid var(--border-color);
  border-radius: 8px;
  position: relative;
  background-color: var(--background-color);
  overflow: hidden;
`,Os=b.div`
  position: absolute;
  top: 16px;
  right: 16px;
  z-index: 10;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  padding: 8px;
  box-shadow: var(--card-shadow);
`,Ys=b.div`
  position: absolute;
  top: 16px;
  left: 16px;
  z-index: 10;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  padding: 12px;
  box-shadow: var(--card-shadow);
  max-width: 300px;
`,Vs=b.div`
  position: absolute;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  padding: 12px;
  box-shadow: var(--card-shadow);
  pointer-events: none;
  z-index: 20;
  max-width: 250px;
  font-size: 12px;
  line-height: 1.4;
`,Ne=()=>{var te;const{t:s}=Ge(["relationships","common"]),o=S.useRef(null),x=S.useRef(null),[u,l]=S.useState(!0),[d,w]=S.useState(null),[a,k]=S.useState(null),[p,F]=S.useState(null),[R,h]=S.useState(null),de=(n,y)=>({1:"#1890ff",2:"#52c41a",3:"#faad14",4:"#722ed1",5:"#f5222d"})[y]||"#8c8c8c",pe=n=>({contains:"#1890ff",depends_on:"#52c41a",uses:"#faad14",runs_on:"#722ed1",stores_in:"#f5222d",logs_to:"#8c8c8c"})[n]||"#d9d9d9",O=n=>({1:20,2:16,3:14,4:12,5:10})[n]||12,E=(n,y,L,G)=>{if(y.filter(H=>H.plane===n.id).length===0)return null;const c=G/5;return{x:50,y:(n.level-1)*c+50,width:L-100,height:c-20,rx:12,ry:12}},Z=()=>{if(!o.current||!x.current||!a)return;const n=x.current,y=ze(o.current),L=n.clientWidth,G=n.clientHeight;y.selectAll("*").remove(),y.attr("width",L).attr("height",G);const B=ps().scaleExtent([.1,3]).on("zoom",t=>{c.attr("transform",t.transform)});y.call(B);const c=y.append("g");c.append("g").attr("class","planes").selectAll("g").data(a.planes).enter().append("g").attr("class","plane").each(function(t){const r=E(t,a.nodes,L,G);if(!r)return;const _=ze(this);_.append("rect").attr("x",r.x).attr("y",r.y).attr("width",r.width).attr("height",r.height).attr("rx",r.rx).attr("ry",r.ry).attr("fill",t.color).attr("stroke",t.borderColor).attr("stroke-width",2).attr("stroke-dasharray","5,5").attr("opacity",.3),_.append("text").attr("x",r.x+20).attr("y",r.y+25).attr("font-size","16px").attr("font-weight","bold").attr("fill",t.borderColor).text(t.name),_.append("text").attr("x",r.x+20).attr("y",r.y+45).attr("font-size","12px").attr("fill","var(--text-secondary)").text(t.description)});const C=hs(a.nodes).force("link",xs(a.links).id(t=>t.id).distance(t=>{const r=t.source.level,_=t.target.level;return Math.abs(r-_)===1?80:120}).strength(t=>t.strength)).force("charge",us().strength(-200)).force("center",ms(L/2,G/2)).force("collision",gs().radius(t=>O(t.level)+8)).force("plane",()=>{a.nodes.forEach(t=>{const r=a.planes.find(ne=>ne.id===t.plane);if(!r)return;const _=E(r,a.nodes,L,G);if(!_)return;const g=30,N=_.x+g,P=_.x+_.width-g,J=_.y+g+50,K=_.y+_.height-g;t.x<N&&(t.x=N),t.x>P&&(t.x=P),t.y<J&&(t.y=J),t.y>K&&(t.y=K)})}),H=c.append("defs");a.metadata.relationTypes.forEach(t=>{H.append("marker").attr("id",`arrow-${t.type}`).attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("fill",t.color)});const ge=c.append("g").attr("class","links").selectAll("line").data(a.links).enter().append("line").attr("stroke",t=>pe(t.type)).attr("stroke-width",t=>{const r=a.metadata.relationTypes.find(_=>_.type===t.type);return(r==null?void 0:r.strokeWidth)||1}).attr("stroke-opacity",.8).attr("marker-end",t=>`url(#arrow-${t.type})`),Y=c.append("g").attr("class","nodes").selectAll("g").data(a.nodes).enter().append("g").attr("class","node").call(ys().on("start",(t,r)=>{t.active||C.alphaTarget(.3).restart(),r.fx=r.x,r.fy=r.y}).on("drag",(t,r)=>{r.fx=t.x,r.fy=t.y}).on("end",(t,r)=>{t.active||C.alphaTarget(0);const _=a.planes.find(g=>g.id===r.plane);if(_){const g=E(_,a.nodes,L,G);if(g){const P=g.x+30,J=g.x+g.width-30,K=g.y+30+50,ne=g.y+g.height-30;r.fx<P&&(r.fx=P),r.fx>J&&(r.fx=J),r.fy<K&&(r.fy=K),r.fy>ne&&(r.fy=ne)}}}));Y.append("circle").attr("r",t=>O(t.level)).attr("fill",t=>de(t.type,t.level)).attr("stroke","#fff").attr("stroke-width",2).style("cursor","pointer"),Y.append("text").text(t=>t.name).attr("x",0).attr("y",t=>O(t.level)+15).attr("text-anchor","middle").attr("font-size","10px").attr("fill","var(--text-color)").style("pointer-events","none"),Y.on("mouseover",(t,r)=>{const _=new Set;_.add(r.id),a.links.forEach(g=>{const N=typeof g.source=="string"?g.source:g.source.id,P=typeof g.target=="string"?g.target:g.target.id;N===r.id&&_.add(P),P===r.id&&_.add(N)}),Y.style("opacity",g=>_.has(g.id)?1:.3),ge.style("opacity",g=>{const N=typeof g.source=="string"?g.source:g.source.id,P=typeof g.target=="string"?g.target:g.target.id;return N===r.id||P===r.id?1:.1}),h({x:t.pageX+10,y:t.pageY-10,content:r})}).on("mouseout",()=>{Y.style("opacity",1),ge.style("opacity",.8),h(null)}).on("click",(t,r)=>{F(r)}),C.on("tick",()=>{ge.attr("x1",t=>t.source.x).attr("y1",t=>t.source.y).attr("x2",t=>t.target.x).attr("y2",t=>t.target.y),Y.attr("transform",t=>`translate(${t.x},${t.y})`)});const Qe=()=>{y.transition().call(B.scaleBy,1.5)},De=()=>{y.transition().call(B.scaleBy,1/1.5)},We=()=>{y.transition().call(B.transform,js)},qe=()=>{a.nodes.forEach(t=>{t.fx=null,t.fy=null}),C.alpha(1).restart()};o.current.zoomIn=Qe,o.current.zoomOut=De,o.current.resetZoom=We,o.current.resetNodePositions=qe};S.useEffect(()=>{try{l(!0),k(qs),w(null)}catch{w("Failed to load relationship data")}finally{l(!1)}},[]),S.useEffect(()=>{if(a&&!u){const n=setTimeout(()=>{Z()},100);return()=>clearTimeout(n)}},[a,u]),S.useEffect(()=>{const n=()=>{a&&!u&&Z()};return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[a,u]);const he=()=>{var n,y;(y=(n=o.current)==null?void 0:n.zoomIn)==null||y.call(n)},xe=()=>{var n,y;(y=(n=o.current)==null?void 0:n.zoomOut)==null||y.call(n)},ue=()=>{var n,y;(y=(n=o.current)==null?void 0:n.resetZoom)==null||y.call(n)},me=()=>{var n,y;(y=(n=o.current)==null?void 0:n.resetNodePositions)==null||y.call(n)},se=()=>{Z()};return u?e.jsx($,{children:e.jsxs("div",{style:{textAlign:"center",padding:"100px 0"},children:[e.jsx(es,{size:"large"}),e.jsx("div",{style:{marginTop:16},children:"Loading relationship graph..."})]})}):d?e.jsx($,{children:e.jsx(ss,{message:"Error",description:d,type:"error",showIcon:!0})}):e.jsxs($,{title:s("relationships:businessRelationshipGraph"),style:{marginBottom:24},children:[e.jsxs(Fs,{ref:x,children:[e.jsx("svg",{ref:o}),e.jsx(Os,{children:e.jsxs(f,{direction:"vertical",size:"small",children:[e.jsx(T,{size:"small",icon:e.jsx(ts,{}),onClick:he,title:s("relationships:zoomIn")}),e.jsx(T,{size:"small",icon:e.jsx(ns,{}),onClick:xe,title:s("relationships:zoomOut")}),e.jsx(T,{size:"small",icon:e.jsx(is,{}),onClick:ue,title:s("relationships:resetView")}),e.jsx(T,{size:"small",icon:e.jsx(rs,{}),onClick:me,title:s("relationships:resetNodePositions")}),e.jsx(T,{size:"small",icon:e.jsx(ee,{}),onClick:se,title:s("relationships:refreshGraph")})]})}),e.jsxs(Ys,{children:[e.jsx("div",{style:{marginBottom:12,fontWeight:"bold",fontSize:"14px"},children:s("relationships:legend")}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{marginBottom:4,fontSize:"12px",fontWeight:"bold"},children:[s("relationships:planes"),":"]}),a==null?void 0:a.planes.map(n=>e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:2},children:[e.jsx("div",{style:{width:16,height:12,backgroundColor:n.color,border:`1px solid ${n.borderColor}`,borderRadius:2,marginRight:6}}),e.jsx("span",{style:{fontSize:"11px"},children:n.name})]},n.id))]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsxs("div",{style:{marginBottom:4,fontSize:"12px",fontWeight:"bold"},children:[s("relationships:nodeTypes"),":"]}),a==null?void 0:a.metadata.levels.map(n=>e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:2},children:[e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",backgroundColor:n.color,marginRight:6}}),e.jsx("span",{style:{fontSize:"11px"},children:n.name})]},n.level))]}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:4,fontSize:"12px",fontWeight:"bold"},children:[s("relationships:relationTypes"),":"]}),a==null?void 0:a.metadata.relationTypes.map(n=>e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:2},children:[e.jsx("div",{style:{width:16,height:2,backgroundColor:n.color,marginRight:6}}),e.jsx("span",{style:{fontSize:"11px"},children:n.description})]},n.type))]})]}),R&&e.jsxs(Vs,{style:{left:R.x,top:R.y},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:4},children:R.content.name}),e.jsxs("div",{style:{marginBottom:2},children:[s("relationships:type"),": ",R.content.type]}),e.jsxs("div",{style:{marginBottom:2},children:[s("relationships:level"),": ",R.content.level]}),e.jsxs("div",{style:{marginBottom:2},children:[s("relationships:plane"),": ",R.content.plane]}),e.jsxs("div",{style:{marginBottom:2},children:[s("relationships:status"),":",e.jsx(i,{color:R.content.status==="active"||R.content.status==="running"?"green":"red",size:"small",style:{marginLeft:4},children:R.content.status})]}),e.jsx("div",{style:{fontSize:"11px",color:"var(--text-secondary)"},children:R.content.description})]})]}),p&&e.jsx($,{title:`${s("relationships:nodeDetails")}: ${p.name}`,size:"small",style:{marginTop:16},extra:e.jsx(T,{size:"small",onClick:()=>F(null),children:s("common:close")}),children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16},children:[e.jsxs("div",{children:[e.jsxs("strong",{children:[s("relationships:basicInfo"),":"]}),e.jsxs("div",{children:["ID: ",p.id]}),e.jsxs("div",{children:[s("relationships:type"),": ",p.type]}),e.jsxs("div",{children:[s("relationships:level"),": ",p.level]}),e.jsxs("div",{children:[s("relationships:plane"),": ",p.plane]}),e.jsxs("div",{children:[s("relationships:status"),": ",e.jsx(i,{color:p.status==="active"||p.status==="running"?"green":"red",children:p.status})]})]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[s("common:description"),":"]}),e.jsx("div",{children:p.description})]}),p.instances&&e.jsxs("div",{children:[e.jsx("strong",{children:"实例信息:"}),e.jsxs("div",{children:["实例数: ",p.instances]}),p.version&&e.jsxs("div",{children:["版本: ",p.version]}),p.technology&&e.jsxs("div",{children:["技术栈: ",p.technology]})]}),p.nodes&&e.jsxs("div",{children:[e.jsxs("strong",{children:[s("relationships:clusterInfo"),":"]}),e.jsxs("div",{children:[s("relationships:nodeCount"),": ",p.nodes]}),p.config&&e.jsxs("div",{children:[s("relationships:config"),": ",p.config]}),p.technology&&e.jsxs("div",{children:[s("relationships:technology"),": ",p.technology]}),p.region&&e.jsxs("div",{children:[s("relationships:region"),": ",p.region]})]}),p.databases&&e.jsxs("div",{children:[e.jsxs("strong",{children:[s("relationships:databases"),":"]}),e.jsx("div",{style:{marginTop:4},children:p.databases.map((n,y)=>e.jsx(i,{color:"blue",style:{marginBottom:4},children:n},y))})]}),p.metrics&&e.jsxs("div",{children:[e.jsx("strong",{children:"业务指标:"}),e.jsxs("div",{children:["日均量: ",(te=p.metrics.dailyVolume)==null?void 0:te.toLocaleString()]}),e.jsxs("div",{children:["成功率: ",p.metrics.successRate,"%"]})]})]})})]})},Xs=[{id:"report_001",name:"日销售报表",type:"report",category:"业务报表",status:"active",description:"每日销售数据统计报表，包含订单量、销售额、转化率等关键指标",owner:"数据分析团队",updateFrequency:"每日",lastUpdated:"2024-12-17 08:00:00",dataSource:["order_center","payment_core"],metrics:{viewCount:1250,exportCount:89,avgLoadTime:"2.3s"},tags:["销售","日报","核心指标"]},{id:"report_002",name:"用户行为分析报表",type:"report",category:"用户报表",status:"active",description:"用户访问路径、停留时间、转化漏斗分析报表",owner:"产品运营团队",updateFrequency:"实时",lastUpdated:"2024-12-17 14:30:00",dataSource:["user_behavior","page_analytics"],metrics:{viewCount:890,exportCount:45,avgLoadTime:"1.8s"},tags:["用户行为","实时","转化分析"]},{id:"business_link_001",name:"用户注册链路",type:"business_link",category:"用户管理",status:"running",description:"用户从注册到激活的完整业务流程",owner:"用户中心团队",avgResponseTime:"850ms",successRate:98.5,dailyVolume:2500,dependencies:["user_service","sms_service","email_service"],sla:{responseTime:"< 1s",availability:"99.9%",errorRate:"< 0.1%"},tags:["用户注册","核心链路","高频"]},{id:"business_link_002",name:"订单支付链路",type:"business_link",category:"交易管理",status:"running",description:"从下单到支付完成的核心交易链路",owner:"交易团队",avgResponseTime:"1.2s",successRate:99.2,dailyVolume:15e3,dependencies:["order_service","payment_gateway","risk_control"],sla:{responseTime:"< 2s",availability:"99.95%",errorRate:"< 0.05%"},tags:["订单支付","核心链路","高可用"]},{id:"system_001",name:"用户中心系统",type:"business_system",category:"核心系统",status:"running",description:"统一用户管理、认证、权限控制系统",owner:"基础架构团队",version:"v2.1.0",instances:6,technology:"Spring Boot + MySQL",resources:{cpu:"24 cores",memory:"48GB",storage:"500GB"},metrics:{qps:5e3,responseTime:"120ms",errorRate:"0.02%"},tags:["用户管理","核心系统","微服务"]},{id:"system_002",name:"订单管理系统",type:"business_system",category:"核心系统",status:"running",description:"订单全生命周期管理系统",owner:"订单团队",version:"v3.0.1",instances:8,technology:"Spring Cloud + MySQL",resources:{cpu:"32 cores",memory:"64GB",storage:"1TB"},metrics:{qps:8e3,responseTime:"200ms",errorRate:"0.01%"},tags:["订单管理","核心系统","高并发"]},{id:"api_001",name:"用户登录接口",type:"api",category:"用户接口",status:"active",description:"用户登录认证接口，支持多种登录方式",owner:"用户中心团队",method:"POST",path:"/api/v1/user/login",version:"v1.2",responseTime:"95ms",qps:1200,successRate:99.8,rateLimit:"1000/min",authentication:"JWT Token",tags:["用户登录","高频接口","认证"]},{id:"api_002",name:"订单创建接口",type:"api",category:"交易接口",status:"active",description:"创建新订单的核心接口",owner:"订单团队",method:"POST",path:"/api/v1/order/create",version:"v2.0",responseTime:"180ms",qps:800,successRate:99.5,rateLimit:"500/min",authentication:"Bearer Token",tags:["订单创建","核心接口","交易"]},{id:"database_001",name:"用户数据库集群",type:"database",category:"MySQL集群",status:"running",description:"用户相关数据存储的MySQL主从集群",owner:"DBA团队",technology:"MySQL 8.0",config:"1主4从",nodes:5,storage:"2TB",connections:500,qps:15e3,region:"华东-1",backup:"每日全量+实时增量",tags:["用户数据","MySQL","主从集群"]},{id:"database_002",name:"订单数据库集群",type:"database",category:"MySQL集群",status:"running",description:"订单交易数据存储的MySQL分库分表集群",owner:"DBA团队",technology:"MySQL 8.0",config:"2主6从",nodes:8,storage:"5TB",connections:800,qps:25e3,region:"华东-1",backup:"每日全量+实时增量",tags:["订单数据","MySQL","分库分表"]},{id:"table_001",name:"用户基础信息表",type:"table",category:"用户表",status:"active",description:"存储用户基础信息的核心表",owner:"用户中心团队",database:"user_center",tableName:"user_basic_info",rowCount:5e6,dataSize:"2.5GB",indexCount:8,partitions:12,lastAnalyzed:"2024-12-17 02:00:00",growthRate:"1000/day",tags:["用户信息","核心表","大表"]},{id:"table_002",name:"订单主表",type:"table",category:"订单表",status:"active",description:"存储订单主要信息的核心表",owner:"订单团队",database:"order_center",tableName:"order_main",rowCount:2e7,dataSize:"15GB",indexCount:12,partitions:24,lastAnalyzed:"2024-12-17 01:30:00",growthRate:"5000/day",tags:["订单信息","核心表","分区表"]},{id:"middleware_001",name:"Redis缓存集群",type:"middleware",category:"缓存中间件",status:"running",description:"分布式缓存集群，提供高性能数据访问",owner:"基础架构团队",technology:"Redis 7.0",config:"3主6从",nodes:9,memory:"256GB",hitRate:95.8,qps:5e4,region:"华东-1",tags:["缓存","Redis","高性能"]},{id:"middleware_002",name:"消息队列集群",type:"middleware",category:"消息中间件",status:"running",description:"异步消息处理和事件驱动架构支撑",owner:"基础架构团队",technology:"RocketMQ",config:"3节点集群",nodes:3,topics:45,dailyMessages:1e7,storage:"1TB",region:"华东-1",tags:["消息队列","RocketMQ","异步处理"]},{id:"service_001",name:"用户认证服务",type:"microservice",category:"基础服务",status:"running",description:"提供统一用户认证和授权服务",owner:"用户中心团队",version:"v1.8.0",instances:4,language:"Java",framework:"Spring Boot",port:8080,healthCheck:"/health",metrics:{qps:2e3,responseTime:"80ms",errorRate:"0.01%"},tags:["认证服务","微服务","基础组件"]},{id:"job_001",name:"订单状态同步任务",type:"scheduled_job",category:"数据同步",status:"running",description:"定时同步订单状态到数据仓库",owner:"数据团队",schedule:"0 */5 * * * *",lastRun:"2024-12-17 14:25:00",nextRun:"2024-12-17 14:30:00",avgDuration:"45s",successRate:99.5,processedRecords:15e3,tags:["定时任务","数据同步","订单"]},{id:"config_001",name:"支付配置中心",type:"configuration",category:"业务配置",status:"active",description:"支付相关的配置参数管理",owner:"支付团队",configCount:156,environment:"production",lastModified:"2024-12-17 10:15:00",version:"v2.3.1",encrypted:!0,tags:["支付配置","配置中心","生产环境"]}],Zs={entities:Xs},{Title:fe,Paragraph:ve}=M,{Search:Hs}=ls,{Option:I}=Ce,Js=b.div`
  padding: 24px;
`,Ks=b.div`
  margin-bottom: 24px;
`,Pe=b.div`
  min-height: 500px;
`,Q=b($)`
  .ant-card-body {
    padding: 16px;
  }
`,Us=b.div`
  margin-bottom: 24px;
  padding: 16px;
  background: var(--card-bg);
  border-radius: 8px;
  border: 1px solid var(--border-color);
`,et=b.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
  gap: 16px;
`,mt=()=>{const{t:s}=Ge(["entities","common"]),o=as(),[x,u]=S.useState("entities"),[l,d]=S.useState("all"),[w,a]=S.useState(""),[k,p]=S.useState("all"),[F,R]=S.useState("all"),[h,de]=S.useState(null),[pe,O]=S.useState(!1),[E,Z]=S.useState([]);S.useEffect(()=>{Ae(s("entities:title")),Z(Zs.entities)},[s]);const he=()=>{o("/entities/create")},xe=c=>{o(`/entities/edit/${c.id}`)},ue=c=>{u(c)},me=c=>{de(c),O(!0)},se=()=>({total:E.length,active:E.filter(m=>m.status==="active"||m.status==="running").length,inactive:E.filter(m=>m.status==="inactive").length,warning:E.filter(m=>m.status==="warning").length}),te=()=>{const c={};return E.forEach(m=>{c[m.type]=(c[m.type]||0)+1}),c},n=()=>{let c=E;return l!=="all"&&(c=c.filter(m=>m.type===l)),w&&(c=c.filter(m=>{var C;return m.name.toLowerCase().includes(w.toLowerCase())||m.description.toLowerCase().includes(w.toLowerCase())||((C=m.tags)==null?void 0:C.some(H=>H.toLowerCase().includes(w.toLowerCase())))})),k!=="all"&&(c=c.filter(m=>m.type===k)),F!=="all"&&(c=c.filter(m=>m.status===F)),c},y=()=>{const c=se(),m=n();return e.jsxs(Pe,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[e.jsxs("div",{children:[e.jsx(fe,{level:3,style:{margin:0},children:s("entities:title")}),e.jsx(ve,{style:{marginTop:8,marginBottom:0},children:s("entities:subtitle")})]}),e.jsxs(f,{children:[e.jsx(T,{icon:e.jsx(Se,{}),children:s("common:export")}),e.jsx(T,{icon:e.jsx(ee,{}),children:s("common:refresh")}),e.jsx(T,{type:"primary",icon:e.jsx(Te,{}),onClick:he,children:s("entities:createEntity")})]})]}),e.jsxs(W,{gutter:16,style:{marginBottom:24},children:[e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(Q,{children:e.jsx(v,{title:s("entities:stats.totalEntities"),value:c.total,suffix:s("common:unit.count"),valueStyle:{color:"#1890ff"}})})}),e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(Q,{children:e.jsx(v,{title:s("entities:stats.activeEntities"),value:c.active,suffix:s("common:unit.count"),valueStyle:{color:"#52c41a"}})})}),e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(Q,{children:e.jsx(v,{title:s("entities:stats.warningEntities"),value:c.warning,suffix:s("common:unit.count"),valueStyle:{color:"#faad14"}})})}),e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(Q,{children:e.jsx(v,{title:s("entities:stats.errorEntities"),value:c.inactive,suffix:s("common:unit.count"),valueStyle:{color:"#f5222d"}})})})]}),e.jsx("div",{style:{marginBottom:16},children:e.jsxs(f,{wrap:!0,children:[e.jsxs(i.CheckableTag,{checked:l==="all",onChange:()=>d("all"),children:["全部 (",c.total,")"]}),e.jsxs(i.CheckableTag,{checked:l==="report",onChange:()=>d("report"),children:["📊 ",s("entities:types.report")," (",B.report||0,")"]}),e.jsxs(i.CheckableTag,{checked:l==="business_link",onChange:()=>d("business_link"),children:["🔗 ",s("entities:types.businessLink")," (",B.business_link||0,")"]}),e.jsxs(i.CheckableTag,{checked:l==="business_system",onChange:()=>d("business_system"),children:["🏢 ",s("entities:types.businessSystem")," (",B.business_system||0,")"]}),e.jsxs(i.CheckableTag,{checked:l==="api",onChange:()=>d("api"),children:["🔌 ",s("entities:types.api")," (",B.api||0,")"]}),e.jsxs(i.CheckableTag,{checked:l==="database",onChange:()=>d("database"),children:["💾 ",s("entities:types.database")," (",B.database||0,")"]}),e.jsxs(i.CheckableTag,{checked:l==="table",onChange:()=>d("table"),children:["📋 ",s("entities:types.table")," (",B.table||0,")"]}),e.jsxs(i.CheckableTag,{checked:l==="middleware",onChange:()=>d("middleware"),children:["☁️ ",s("entities:types.middleware")," (",B.middleware||0,")"]}),e.jsxs(i.CheckableTag,{checked:l==="microservice",onChange:()=>d("microservice"),children:["🔧 ",s("entities:types.microservice")," (",B.microservice||0,")"]}),e.jsxs(i.CheckableTag,{checked:l==="scheduled_job",onChange:()=>d("scheduled_job"),children:["⏰ ",s("entities:types.scheduledJob")," (",B.scheduled_job||0,")"]}),e.jsxs(i.CheckableTag,{checked:l==="configuration",onChange:()=>d("configuration"),children:["⚙️ 配置 (",B.configuration||0,")"]})]})}),e.jsx(Us,{children:e.jsxs(W,{gutter:16,align:"middle",children:[e.jsx(j,{flex:"auto",children:e.jsx(Hs,{placeholder:s("entities:searchPlaceholder"),value:w,onChange:C=>a(C.target.value),style:{width:"100%"},allowClear:!0})}),e.jsx(j,{children:e.jsxs(Ce,{value:k,onChange:p,style:{width:120},placeholder:s("entities:typeFilter"),children:[e.jsx(I,{value:"all",children:s("entities:allTypes")}),e.jsx(I,{value:"report",children:s("entities:types.report")}),e.jsx(I,{value:"business_link",children:s("entities:types.businessLink")}),e.jsx(I,{value:"business_system",children:s("entities:types.businessSystem")}),e.jsx(I,{value:"api",children:s("entities:types.api")}),e.jsx(I,{value:"database",children:s("entities:types.database")}),e.jsx(I,{value:"table",children:s("entities:types.table")}),e.jsx(I,{value:"middleware",children:s("entities:types.middleware")}),e.jsx(I,{value:"microservice",children:s("entities:types.microservice")}),e.jsx(I,{value:"scheduled_job",children:s("entities:types.scheduledJob")}),e.jsx(I,{value:"configuration",children:s("entities:types.configuration")})]})}),e.jsx(j,{children:e.jsxs(Ce,{value:F,onChange:R,style:{width:100},placeholder:"状态",children:[e.jsx(I,{value:"all",children:"所有状态"}),e.jsx(I,{value:"active",children:"活跃"}),e.jsx(I,{value:"running",children:"运行中"}),e.jsx(I,{value:"inactive",children:"停用"}),e.jsx(I,{value:"warning",children:"告警"})]})})]})}),m.length>0?e.jsx(et,{children:m.map(C=>e.jsx(As,{entity:C,onClick:me,onEdit:xe},C.id))}):e.jsx(cs,{description:s("entities:noEntitiesFound"),style:{margin:"60px 0"}})]})},L=()=>{var c;return h?e.jsxs(os,{title:`${s("entities:entityDetail")}: ${h.name}`,placement:"right",width:600,onClose:()=>O(!1),open:pe,children:[e.jsxs(z,{column:1,bordered:!0,size:"small",children:[e.jsx(z.Item,{label:s("entities:entityId"),children:h.id}),e.jsx(z.Item,{label:s("entities:entityName"),children:h.name}),e.jsx(z.Item,{label:s("entities:entityType"),children:e.jsx(i,{color:"blue",children:h.type})}),e.jsx(z.Item,{label:s("entities:category"),children:h.category}),e.jsx(z.Item,{label:"状态",children:e.jsx(U,{status:h.status==="active"||h.status==="running"?"success":"error",text:h.status})}),e.jsx(z.Item,{label:"描述",children:h.description}),e.jsx(z.Item,{label:"负责人",children:h.owner}),h.version&&e.jsx(z.Item,{label:"版本",children:h.version}),h.technology&&e.jsx(z.Item,{label:"技术栈",children:h.technology}),h.instances&&e.jsx(z.Item,{label:"实例数",children:h.instances}),h.method&&e.jsx(z.Item,{label:"请求方法",children:e.jsx(i,{color:h.method==="GET"?"green":"blue",children:h.method})}),h.path&&e.jsx(z.Item,{label:s("entities:apiPath"),children:e.jsx("code",{children:h.path})}),h.database&&e.jsx(z.Item,{label:s("entities:belongsToDatabase"),children:h.database}),h.tableName&&e.jsx(z.Item,{label:s("entities:tableName"),children:e.jsx("code",{children:h.tableName})}),e.jsx(z.Item,{label:"标签",children:e.jsx(f,{children:(c=h.tags)==null?void 0:c.map((m,C)=>e.jsx(i,{children:m},C))})})]}),h.metrics&&e.jsx($,{title:"性能指标",size:"small",style:{marginTop:16},children:e.jsx(W,{gutter:16,children:Object.entries(h.metrics).map(([m,C])=>e.jsx(j,{span:8,children:e.jsx(v,{title:m,value:C,valueStyle:{fontSize:"14px"}})},m))})}),h.sla&&e.jsx($,{title:"SLA指标",size:"small",style:{marginTop:16},children:e.jsx(z,{column:1,size:"small",children:Object.entries(h.sla).map(([m,C])=>e.jsx(z.Item,{label:m,children:C},m))})})]}):null},G=()=>e.jsxs(Pe,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[e.jsxs("div",{children:[e.jsx(fe,{level:3,style:{margin:0},children:s("entities:relationshipGraph")}),e.jsx(ve,{style:{marginTop:8,marginBottom:0},children:s("entities:relationshipGraphDesc")})]}),e.jsxs(f,{children:[e.jsx(T,{icon:e.jsx(Se,{}),children:s("entities:exportGraph")}),e.jsx(T,{icon:e.jsx(ce,{}),children:s("entities:graphSettings")}),e.jsx(T,{icon:e.jsx(ee,{}),children:s("entities:refreshGraph")})]})]}),e.jsxs(W,{gutter:16,style:{marginBottom:24},children:[e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(Q,{children:e.jsx(v,{title:s("entities:stats.totalRelations"),value:25,suffix:s("common:unitRelation"),valueStyle:{color:"#1890ff"}})})}),e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(Q,{children:e.jsx(v,{title:s("entities:stats.relationTypes"),value:5,suffix:s("common:unitType"),valueStyle:{color:"#52c41a"}})})}),e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(Q,{children:e.jsx(v,{title:s("entities:stats.graphNodes"),value:21,suffix:s("common:unit.count"),valueStyle:{color:"#faad14"}})})}),e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(Q,{children:e.jsx(v,{title:s("entities:stats.connectedSystems"),value:5,suffix:s("common:unit.count"),valueStyle:{color:"#722ed1"}})})})]}),e.jsx(Ne,{})]}),B=te();return e.jsxs(Js,{children:[e.jsx(Ks,{children:e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:e.jsxs("div",{children:[e.jsxs(fe,{level:2,style:{margin:0},children:[s("entities:title"),e.jsx(U,{count:"NEW",style:{backgroundColor:"#52c41a",marginLeft:12,fontSize:12}})]}),e.jsx(ve,{style:{marginTop:8,marginBottom:0,fontSize:16},children:s("entities:description")})]})})}),e.jsx($,{children:e.jsxs(X,{activeKey:x,onChange:ue,size:"large",tabBarStyle:{marginBottom:24},children:[e.jsx(X.TabPane,{tab:e.jsxs(f,{children:[e.jsx(_e,{}),s("entities:title"),e.jsx(U,{count:se().total,showZero:!0})]}),children:y()},"entities"),e.jsx(X.TabPane,{tab:e.jsxs(f,{children:[e.jsx(we,{}),s("entities:relationshipGraph")]}),children:G()},"relationships")]})}),L()]})},{Title:be,Paragraph:A}=M,st=b.div`
  padding: 24px;
`,tt=b.div`
  margin-bottom: 24px;
`,Me=b.div`
  min-height: 500px;
`,D=b($)`
  .ant-card-body {
    padding: 16px;
  }
`,V=b($)`
  height: 100%;
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }
`,gt=()=>{const[s,o]=S.useState("entities");S.useEffect(()=>{Ae("实体关系")},[]);const x=d=>{o(d)},u=()=>e.jsxs(Me,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[e.jsxs("div",{children:[e.jsx(be,{level:3,style:{margin:0},children:"实体管理"}),e.jsx(A,{style:{marginTop:8,marginBottom:0},children:"管理系统中的各种实体对象，包括实体类型定义、实体实例创建和属性配置。"})]}),e.jsxs(f,{children:[e.jsx(T,{icon:e.jsx(ye,{}),children:"搜索"}),e.jsx(T,{icon:e.jsx(ds,{}),children:"筛选"}),e.jsx(T,{icon:e.jsx(ee,{}),children:"刷新"}),e.jsx(T,{type:"primary",icon:e.jsx(Te,{}),children:"创建实体"})]})]}),e.jsxs(W,{gutter:16,style:{marginBottom:24},children:[e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(D,{children:e.jsx(v,{title:"实体类型",value:0,suffix:"个",valueStyle:{color:"#1890ff"}})})}),e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(D,{children:e.jsx(v,{title:"实体实例",value:0,suffix:"个",valueStyle:{color:"#52c41a"}})})}),e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(D,{children:e.jsx(v,{title:"活跃实体",value:0,suffix:"个",valueStyle:{color:"#faad14"}})})}),e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(D,{children:e.jsx(v,{title:"异常实体",value:0,suffix:"个",valueStyle:{color:"#f5222d"}})})})]}),e.jsxs(W,{gutter:16,children:[e.jsx(j,{xs:24,md:12,lg:8,children:e.jsxs(V,{title:e.jsxs(f,{children:[e.jsx(_e,{style:{color:"#1890ff"}}),"实体类型管理"]}),children:[e.jsx(A,{children:"定义和管理不同类型的实体，包括属性定义、约束规则和生命周期配置。"}),e.jsxs("div",{children:[e.jsx(i,{color:"blue",children:"类型定义"}),e.jsx(i,{color:"blue",children:"属性配置"}),e.jsx(i,{color:"blue",children:"约束规则"})]})]})}),e.jsx(j,{xs:24,md:12,lg:8,children:e.jsxs(V,{title:e.jsxs(f,{children:[e.jsx(Te,{style:{color:"#52c41a"}}),"实体实例管理"]}),children:[e.jsx(A,{children:"创建、编辑和管理具体的实体实例，支持批量操作和状态管理。"}),e.jsxs("div",{children:[e.jsx(i,{color:"green",children:"实例创建"}),e.jsx(i,{color:"green",children:"批量操作"}),e.jsx(i,{color:"green",children:"状态管理"})]})]})}),e.jsx(j,{xs:24,md:12,lg:8,children:e.jsxs(V,{title:e.jsxs(f,{children:[e.jsx(ye,{style:{color:"#faad14"}}),"搜索与过滤"]}),children:[e.jsx(A,{children:"强大的搜索和过滤功能，支持多维度查询和高级筛选条件。"}),e.jsxs("div",{children:[e.jsx(i,{color:"orange",children:"全文搜索"}),e.jsx(i,{color:"orange",children:"高级筛选"}),e.jsx(i,{color:"orange",children:"快速定位"})]})]})})]})]}),l=()=>e.jsxs(Me,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[e.jsxs("div",{children:[e.jsx(be,{level:3,style:{margin:0},children:"关系图谱"}),e.jsx(A,{style:{marginTop:8,marginBottom:0},children:"基于D3.js的交互式关系图谱，展示从业务场景到基础设施的完整技术架构关系。"})]}),e.jsxs(f,{children:[e.jsx(T,{icon:e.jsx(Se,{}),children:"导出图谱"}),e.jsx(T,{icon:e.jsx(ce,{}),children:"图谱设置"}),e.jsx(T,{icon:e.jsx(ee,{}),children:"刷新图谱"})]})]}),e.jsxs(W,{gutter:16,style:{marginBottom:24},children:[e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(D,{children:e.jsx(v,{title:"关系总数",value:25,suffix:"条",valueStyle:{color:"#1890ff"}})})}),e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(D,{children:e.jsx(v,{title:"关系类型",value:5,suffix:"种",valueStyle:{color:"#52c41a"}})})}),e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(D,{children:e.jsx(v,{title:"图谱节点",value:21,suffix:"个",valueStyle:{color:"#faad14"}})})}),e.jsx(j,{xs:24,sm:12,md:6,children:e.jsx(D,{children:e.jsx(v,{title:"支付系统",value:5,suffix:"个",valueStyle:{color:"#722ed1"}})})})]}),e.jsx(Ne,{}),e.jsxs(W,{gutter:16,style:{marginTop:24},children:[e.jsx(j,{xs:24,md:12,lg:8,children:e.jsxs(V,{title:e.jsxs(f,{children:[e.jsx(we,{style:{color:"#1890ff"}}),"多层级架构"]}),children:[e.jsx(A,{children:"展示从业务场景、业务链路、业务系统、中间件到基础设施的5层架构关系。"}),e.jsxs("div",{children:[e.jsx(i,{color:"blue",children:"业务场景"}),e.jsx(i,{color:"green",children:"业务链路"}),e.jsx(i,{color:"orange",children:"业务系统"}),e.jsx(i,{color:"purple",children:"中间件"}),e.jsx(i,{color:"red",children:"基础设施"})]})]})}),e.jsx(j,{xs:24,md:12,lg:8,children:e.jsxs(V,{title:e.jsxs(f,{children:[e.jsx(ye,{style:{color:"#52c41a"}}),"交互式探索"]}),children:[e.jsx(A,{children:"展示完整的支付结算生态系统，包含支付网关、钱包、风控、清结算等核心系统。"}),e.jsxs("div",{children:[e.jsx(i,{color:"blue",children:"支付网关"}),e.jsx(i,{color:"green",children:"钱包系统"}),e.jsx(i,{color:"orange",children:"风控系统"}),e.jsx(i,{color:"purple",children:"清结算"}),e.jsx(i,{color:"red",children:"账务系统"})]})]})}),e.jsx(j,{xs:24,md:12,lg:8,children:e.jsxs(V,{title:e.jsxs(f,{children:[e.jsx(ce,{style:{color:"#faad14"}}),"关系类型"]}),children:[e.jsx(A,{children:"支持包含、依赖、使用、运行、存储、日志等6种关系类型的可视化展示。"}),e.jsxs("div",{children:[e.jsx(i,{color:"orange",children:"包含关系"}),e.jsx(i,{color:"orange",children:"依赖关系"}),e.jsx(i,{color:"orange",children:"使用关系"}),e.jsx(i,{color:"orange",children:"运行关系"})]})]})})]})]});return e.jsxs(st,{children:[e.jsx(tt,{children:e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:e.jsxs("div",{children:[e.jsxs(be,{level:2,style:{margin:0},children:["实体关系",e.jsx(U,{count:"开发中",style:{backgroundColor:"#faad14",marginLeft:12,fontSize:12}})]}),e.jsx(A,{style:{marginTop:8,marginBottom:0,fontSize:16},children:"统一管理系统中的实体对象和它们之间的关系，提供完整的实体生命周期管理和关系可视化分析。"})]})})}),e.jsx($,{children:e.jsxs(X,{activeKey:s,onChange:x,size:"large",tabBarStyle:{marginBottom:24},children:[e.jsx(X.TabPane,{tab:e.jsxs(f,{children:[e.jsx(_e,{}),"实体管理"]}),children:u()},"entities"),e.jsx(X.TabPane,{tab:e.jsxs(f,{children:[e.jsx(we,{}),"关系图谱"]}),children:l()},"relationships")]})})]})};export{bt as EntityCreatePage,wt as EntityEditPage,ft as EntityForm,mt as EntityManagement,gt as EntityRelationship,mt as default};

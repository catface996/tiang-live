import{s as U,d as rt,i as at,T as J,a as tt}from"./transform-CtUPqxAi.js";function lt(e){let r;for(;r=e.sourceEvent;)e=r;return e}function K(e,r){if(e=lt(e),r===void 0&&(r=e.currentTarget),r){var h=r.ownerSVGElement||r;if(h.createSVGPoint){var g=h.createSVGPoint();return g.x=e.clientX,g.y=e.clientY,g=g.matrixTransform(r.getScreenCTM().inverse()),[g.x,g.y]}if(r.getBoundingClientRect){var z=r.getBoundingClientRect();return[e.clientX-z.left-r.clientLeft,e.clientY-z.top-r.clientTop]}}return[e.pageX,e.pageY]}const ht={passive:!1},W={capture:!0,passive:!1};function et(e){e.stopImmediatePropagation()}function O(e){e.preventDefault(),e.stopImmediatePropagation()}function st(e){var r=e.document.documentElement,h=U(e).on("dragstart.drag",O,W);"onselectstart"in r?h.on("selectstart.drag",O,W):(r.__noselect=r.style.MozUserSelect,r.style.MozUserSelect="none")}function ct(e,r){var h=e.document.documentElement,g=U(e).on("dragstart.drag",null);r&&(g.on("click.drag",O,W),setTimeout(function(){g.on("click.drag",null)},0)),"onselectstart"in h?g.on("selectstart.drag",null):(h.style.MozUserSelect=h.__noselect,delete h.__noselect)}const H=e=>()=>e;function ot(e,{sourceEvent:r,subject:h,target:g,identifier:z,active:v,x:f,y:M,dx:k,dy:w,dispatch:E}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:r,enumerable:!0,configurable:!0},subject:{value:h,enumerable:!0,configurable:!0},target:{value:g,enumerable:!0,configurable:!0},identifier:{value:z,enumerable:!0,configurable:!0},active:{value:v,enumerable:!0,configurable:!0},x:{value:f,enumerable:!0,configurable:!0},y:{value:M,enumerable:!0,configurable:!0},dx:{value:k,enumerable:!0,configurable:!0},dy:{value:w,enumerable:!0,configurable:!0},_:{value:E}})}ot.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function ft(e){return!e.ctrlKey&&!e.button}function mt(){return this.parentNode}function gt(e,r){return r??{x:e.x,y:e.y}}function dt(){return navigator.maxTouchPoints||"ontouchstart"in this}function kt(){var e=ft,r=mt,h=gt,g=dt,z={},v=rt("start","drag","end"),f=0,M,k,w,E,G=0;function p(o){o.on("mousedown.drag",C).filter(g).on("touchstart.drag",j).on("touchmove.drag",a,ht).on("touchend.drag touchcancel.drag",q).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function C(o,m){if(!(E||!e.call(this,o,m))){var d=S(this,r.call(this,o,m),o,m,"mouse");d&&(U(o.view).on("mousemove.drag",F,W).on("mouseup.drag",V,W),st(o.view),et(o),w=!1,M=o.clientX,k=o.clientY,d("start",o))}}function F(o){if(O(o),!w){var m=o.clientX-M,d=o.clientY-k;w=m*m+d*d>G}z.mouse("drag",o)}function V(o){U(o.view).on("mousemove.drag mouseup.drag",null),ct(o.view,w),O(o),z.mouse("end",o)}function j(o,m){if(e.call(this,o,m)){var d=o.changedTouches,b=r.call(this,o,m),_=d.length,D,Y;for(D=0;D<_;++D)(Y=S(this,b,o,m,d[D].identifier,d[D]))&&(et(o),Y("start",o,d[D]))}}function a(o){var m=o.changedTouches,d=m.length,b,_;for(b=0;b<d;++b)(_=z[m[b].identifier])&&(O(o),_("drag",o,m[b]))}function q(o){var m=o.changedTouches,d=m.length,b,_;for(E&&clearTimeout(E),E=setTimeout(function(){E=null},500),b=0;b<d;++b)(_=z[m[b].identifier])&&(et(o),_("end",o,m[b]))}function S(o,m,d,b,_,D){var Y=v.copy(),P=K(D||d,m),Z,A,t;if((t=h.call(o,new ot("beforestart",{sourceEvent:d,target:p,identifier:_,active:f,x:P[0],y:P[1],dx:0,dy:0,dispatch:Y}),b))!=null)return Z=t.x-P[0]||0,A=t.y-P[1]||0,function u(n,i,s){var c=P,l;switch(n){case"start":z[_]=u,l=f++;break;case"end":delete z[_],--f;case"drag":P=K(s||i,m),l=f;break}Y.call(n,o,new ot(n,{sourceEvent:i,subject:t,target:p,identifier:_,active:l,x:P[0]+Z,y:P[1]+A,dx:P[0]-c[0],dy:P[1]-c[1],dispatch:Y}),b)}}return p.filter=function(o){return arguments.length?(e=typeof o=="function"?o:H(!!o),p):e},p.container=function(o){return arguments.length?(r=typeof o=="function"?o:H(o),p):r},p.subject=function(o){return arguments.length?(h=typeof o=="function"?o:H(o),p):h},p.touchable=function(o){return arguments.length?(g=typeof o=="function"?o:H(!!o),p):g},p.on=function(){var o=v.on.apply(v,arguments);return o===v?p:o},p.clickDistance=function(o){return arguments.length?(G=(o=+o)*o,p):Math.sqrt(G)},p}var pt=1e-12;function ut(e){return((e=Math.exp(e))+1/e)/2}function yt(e){return((e=Math.exp(e))-1/e)/2}function vt(e){return((e=Math.exp(2*e))-1)/(e+1)}const bt=function e(r,h,g){function z(v,f){var M=v[0],k=v[1],w=v[2],E=f[0],G=f[1],p=f[2],C=E-M,F=G-k,V=C*C+F*F,j,a;if(V<pt)a=Math.log(p/w)/r,j=function(b){return[M+b*C,k+b*F,w*Math.exp(r*b*a)]};else{var q=Math.sqrt(V),S=(p*p-w*w+g*V)/(2*w*h*q),o=(p*p-w*w-g*V)/(2*p*h*q),m=Math.log(Math.sqrt(S*S+1)-S),d=Math.log(Math.sqrt(o*o+1)-o);a=(d-m)/r,j=function(b){var _=b*a,D=ut(m),Y=w/(h*q)*(D*vt(r*_+m)-yt(m));return[M+Y*C,k+Y*F,w*D/ut(r*_+m)]}}return j.duration=a*1e3*r/Math.SQRT2,j}return z.rho=function(v){var f=Math.max(.001,+v),M=f*f,k=M*M;return e(f,M,k)},z}(Math.SQRT2,2,4),L=e=>()=>e;function zt(e,{sourceEvent:r,target:h,transform:g,dispatch:z}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:r,enumerable:!0,configurable:!0},target:{value:h,enumerable:!0,configurable:!0},transform:{value:g,enumerable:!0,configurable:!0},_:{value:z}})}function nt(e){e.stopImmediatePropagation()}function Q(e){e.preventDefault(),e.stopImmediatePropagation()}function wt(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Tt(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function it(){return this.__zoom||at}function Mt(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function _t(){return navigator.maxTouchPoints||"ontouchstart"in this}function xt(e,r,h){var g=e.invertX(r[0][0])-h[0][0],z=e.invertX(r[1][0])-h[1][0],v=e.invertY(r[0][1])-h[0][1],f=e.invertY(r[1][1])-h[1][1];return e.translate(z>g?(g+z)/2:Math.min(0,g)||Math.max(0,z),f>v?(v+f)/2:Math.min(0,v)||Math.max(0,f))}function Dt(){var e=wt,r=Tt,h=xt,g=Mt,z=_t,v=[0,1/0],f=[[-1/0,-1/0],[1/0,1/0]],M=250,k=bt,w=rt("start","zoom","end"),E,G,p,C=500,F=150,V=0,j=10;function a(t){t.property("__zoom",it).on("wheel.zoom",_,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",Y).filter(z).on("touchstart.zoom",P).on("touchmove.zoom",Z).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}a.transform=function(t,u,n,i){var s=t.selection?t.selection():t;s.property("__zoom",it),t!==s?m(t,u,n,i):s.interrupt().each(function(){d(this,arguments).event(i).start().zoom(null,typeof u=="function"?u.apply(this,arguments):u).end()})},a.scaleBy=function(t,u,n,i){a.scaleTo(t,function(){var s=this.__zoom.k,c=typeof u=="function"?u.apply(this,arguments):u;return s*c},n,i)},a.scaleTo=function(t,u,n,i){a.transform(t,function(){var s=r.apply(this,arguments),c=this.__zoom,l=n==null?o(s):typeof n=="function"?n.apply(this,arguments):n,y=c.invert(l),T=typeof u=="function"?u.apply(this,arguments):u;return h(S(q(c,T),l,y),s,f)},n,i)},a.translateBy=function(t,u,n,i){a.transform(t,function(){return h(this.__zoom.translate(typeof u=="function"?u.apply(this,arguments):u,typeof n=="function"?n.apply(this,arguments):n),r.apply(this,arguments),f)},null,i)},a.translateTo=function(t,u,n,i,s){a.transform(t,function(){var c=r.apply(this,arguments),l=this.__zoom,y=i==null?o(c):typeof i=="function"?i.apply(this,arguments):i;return h(at.translate(y[0],y[1]).scale(l.k).translate(typeof u=="function"?-u.apply(this,arguments):-u,typeof n=="function"?-n.apply(this,arguments):-n),c,f)},i,s)};function q(t,u){return u=Math.max(v[0],Math.min(v[1],u)),u===t.k?t:new J(u,t.x,t.y)}function S(t,u,n){var i=u[0]-n[0]*t.k,s=u[1]-n[1]*t.k;return i===t.x&&s===t.y?t:new J(t.k,i,s)}function o(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function m(t,u,n,i){t.on("start.zoom",function(){d(this,arguments).event(i).start()}).on("interrupt.zoom end.zoom",function(){d(this,arguments).event(i).end()}).tween("zoom",function(){var s=this,c=arguments,l=d(s,c).event(i),y=r.apply(s,c),T=n==null?o(y):typeof n=="function"?n.apply(s,c):n,B=Math.max(y[1][0]-y[0][0],y[1][1]-y[0][1]),x=s.__zoom,I=typeof u=="function"?u.apply(s,c):u,R=k(x.invert(T).concat(B/x.k),I.invert(T).concat(B/I.k));return function(X){if(X===1)X=I;else{var $=R(X),N=B/$[2];X=new J(N,T[0]-$[0]*N,T[1]-$[1]*N)}l.zoom(null,X)}})}function d(t,u,n){return!n&&t.__zooming||new b(t,u)}function b(t,u){this.that=t,this.args=u,this.active=0,this.sourceEvent=null,this.extent=r.apply(t,u),this.taps=0}b.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,u){return this.mouse&&t!=="mouse"&&(this.mouse[1]=u.invert(this.mouse[0])),this.touch0&&t!=="touch"&&(this.touch0[1]=u.invert(this.touch0[0])),this.touch1&&t!=="touch"&&(this.touch1[1]=u.invert(this.touch1[0])),this.that.__zoom=u,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var u=U(this.that).datum();w.call(t,this.that,new zt(t,{sourceEvent:this.sourceEvent,target:a,transform:this.that.__zoom,dispatch:w}),u)}};function _(t,...u){if(!e.apply(this,arguments))return;var n=d(this,u).event(t),i=this.__zoom,s=Math.max(v[0],Math.min(v[1],i.k*Math.pow(2,g.apply(this,arguments)))),c=K(t);if(n.wheel)(n.mouse[0][0]!==c[0]||n.mouse[0][1]!==c[1])&&(n.mouse[1]=i.invert(n.mouse[0]=c)),clearTimeout(n.wheel);else{if(i.k===s)return;n.mouse=[c,i.invert(c)],tt(this),n.start()}Q(t),n.wheel=setTimeout(l,F),n.zoom("mouse",h(S(q(i,s),n.mouse[0],n.mouse[1]),n.extent,f));function l(){n.wheel=null,n.end()}}function D(t,...u){if(p||!e.apply(this,arguments))return;var n=t.currentTarget,i=d(this,u,!0).event(t),s=U(t.view).on("mousemove.zoom",T,!0).on("mouseup.zoom",B,!0),c=K(t,n),l=t.clientX,y=t.clientY;st(t.view),nt(t),i.mouse=[c,this.__zoom.invert(c)],tt(this),i.start();function T(x){if(Q(x),!i.moved){var I=x.clientX-l,R=x.clientY-y;i.moved=I*I+R*R>V}i.event(x).zoom("mouse",h(S(i.that.__zoom,i.mouse[0]=K(x,n),i.mouse[1]),i.extent,f))}function B(x){s.on("mousemove.zoom mouseup.zoom",null),ct(x.view,i.moved),Q(x),i.event(x).end()}}function Y(t,...u){if(e.apply(this,arguments)){var n=this.__zoom,i=K(t.changedTouches?t.changedTouches[0]:t,this),s=n.invert(i),c=n.k*(t.shiftKey?.5:2),l=h(S(q(n,c),i,s),r.apply(this,u),f);Q(t),M>0?U(this).transition().duration(M).call(m,l,i,t):U(this).call(a.transform,l,i,t)}}function P(t,...u){if(e.apply(this,arguments)){var n=t.touches,i=n.length,s=d(this,u,t.changedTouches.length===i).event(t),c,l,y,T;for(nt(t),l=0;l<i;++l)y=n[l],T=K(y,this),T=[T,this.__zoom.invert(T),y.identifier],s.touch0?!s.touch1&&s.touch0[2]!==T[2]&&(s.touch1=T,s.taps=0):(s.touch0=T,c=!0,s.taps=1+!!E);E&&(E=clearTimeout(E)),c&&(s.taps<2&&(G=T[0],E=setTimeout(function(){E=null},C)),tt(this),s.start())}}function Z(t,...u){if(this.__zooming){var n=d(this,u).event(t),i=t.changedTouches,s=i.length,c,l,y,T;for(Q(t),c=0;c<s;++c)l=i[c],y=K(l,this),n.touch0&&n.touch0[2]===l.identifier?n.touch0[0]=y:n.touch1&&n.touch1[2]===l.identifier&&(n.touch1[0]=y);if(l=n.that.__zoom,n.touch1){var B=n.touch0[0],x=n.touch0[1],I=n.touch1[0],R=n.touch1[1],X=(X=I[0]-B[0])*X+(X=I[1]-B[1])*X,$=($=R[0]-x[0])*$+($=R[1]-x[1])*$;l=q(l,Math.sqrt(X/$)),y=[(B[0]+I[0])/2,(B[1]+I[1])/2],T=[(x[0]+R[0])/2,(x[1]+R[1])/2]}else if(n.touch0)y=n.touch0[0],T=n.touch0[1];else return;n.zoom("touch",h(S(l,y,T),n.extent,f))}}function A(t,...u){if(this.__zooming){var n=d(this,u).event(t),i=t.changedTouches,s=i.length,c,l;for(nt(t),p&&clearTimeout(p),p=setTimeout(function(){p=null},C),c=0;c<s;++c)l=i[c],n.touch0&&n.touch0[2]===l.identifier?delete n.touch0:n.touch1&&n.touch1[2]===l.identifier&&delete n.touch1;if(n.touch1&&!n.touch0&&(n.touch0=n.touch1,delete n.touch1),n.touch0)n.touch0[1]=this.__zoom.invert(n.touch0[0]);else if(n.end(),n.taps===2&&(l=K(l,this),Math.hypot(G[0]-l[0],G[1]-l[1])<j)){var y=U(this).on("dblclick.zoom");y&&y.apply(this,arguments)}}}return a.wheelDelta=function(t){return arguments.length?(g=typeof t=="function"?t:L(+t),a):g},a.filter=function(t){return arguments.length?(e=typeof t=="function"?t:L(!!t),a):e},a.touchable=function(t){return arguments.length?(z=typeof t=="function"?t:L(!!t),a):z},a.extent=function(t){return arguments.length?(r=typeof t=="function"?t:L([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),a):r},a.scaleExtent=function(t){return arguments.length?(v[0]=+t[0],v[1]=+t[1],a):[v[0],v[1]]},a.translateExtent=function(t){return arguments.length?(f[0][0]=+t[0][0],f[1][0]=+t[1][0],f[0][1]=+t[0][1],f[1][1]=+t[1][1],a):[[f[0][0],f[0][1]],[f[1][0],f[1][1]]]},a.constrain=function(t){return arguments.length?(h=t,a):h},a.duration=function(t){return arguments.length?(M=+t,a):M},a.interpolate=function(t){return arguments.length?(k=t,a):k},a.on=function(){var t=w.on.apply(w,arguments);return t===w?a:t},a.clickDistance=function(t){return arguments.length?(V=(t=+t)*t,a):Math.sqrt(V)},a.tapDistance=function(t){return arguments.length?(j=+t,a):j},a}export{kt as d,Dt as z};

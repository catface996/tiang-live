import{a as _,b as G,u as J,c as Y,j as e,d as b}from"./index-i3_CIisb.js";import{r as y,Z as ee,_ as se,$ as te,Q as re,B as m,N as u,O as ae,T as ie,a0 as le,k as v,u as P,i as F,a1 as oe,a2 as ne,a3 as de,a4 as ce,y as x,d as j,C as n,S as p,a5 as xe,a as L,X as q,a6 as pe,a7 as fe,j as f,h as he,a8 as me,a9 as A,U as H,aa as ue}from"./antd-C0IAgzs2.js";import{s as je}from"./index-Daowydkz.js";import{g as ge}from"./reportService-DqILwhV_.js";import"./vendor-DJG_os-6.js";const{Title:ye,Paragraph:W,Text:c}=ie,$=b.div`
  padding: 24px;
  min-height: 100vh;
  background: ${i=>i.$isDark?"#000000":"#f5f5f5"};
  transition: all 0.3s ease;
`,E=b(f)`
  margin-bottom: 24px;
  border-radius: 8px;
  box-shadow: ${i=>i.$isDark?"0 2px 8px rgba(255, 255, 255, 0.05)":"0 2px 8px rgba(0, 0, 0, 0.06)"};
  border: ${i=>i.$isDark?"1px solid #303030":"1px solid #f0f0f0"};
  background: ${i=>i.$isDark?"#141414":"#ffffff"};
  transition: all 0.3s ease;
  
  .ant-card-body {
    padding: 24px;
  }
  
  .ant-card-head {
    background: ${i=>i.$isDark?"#141414":"#ffffff"};
    border-bottom: ${i=>i.$isDark?"1px solid #303030":"1px solid #f0f0f0"};
  }
`,g=b(f)`
  text-align: center;
  border-radius: 8px;
  background: ${i=>i.$isDark?"#141414":"#ffffff"};
  border: ${i=>i.$isDark?"1px solid #303030":"1px solid #f0f0f0"};
  transition: all 0.3s ease;
  
  .ant-statistic-content {
    color: ${i=>i.$isDark?"#ffffff":"#262626"};
  }
`,Re=()=>{var T;const[i,I]=y.useState(!0),[l,S]=y.useState(null),{id:R}=_(),k=G(),{t}=J(["reports","common"]),{currentTheme:K}=Y(r=>r.theme);ee.useToken();const a=K==="dark";y.useEffect(()=>{je(t("reports:detail.title")),(async()=>{try{I(!0);const d=await ge(R||"");S(d)}catch(d){console.error("Failed to load report data:",d),S(null)}finally{I(!1)}})()},[t,R]);const M=r=>({published:"green",draft:"orange",archived:"default"})[r]||"default",N=r=>({published:t("reports:status.published"),draft:t("reports:status.draft"),archived:t("reports:status.archived")})[r]||r,O=r=>({healthy:"success",warning:"warning",critical:"error"})[r]||"default",D=r=>({high:"red",medium:"orange",low:"blue"})[r]||"default",Q=[{title:t("reports:detail.service"),dataIndex:"service",key:"service",width:"25%"},{title:t("reports:detail.status"),dataIndex:"status",key:"status",width:"15%",render:r=>e.jsx(se,{status:O(r),text:t(r==="healthy"?"reports:detail.healthy":r==="warning"?"reports:detail.warning":"reports:detail.critical")})},{title:t("reports:detail.responseTime"),dataIndex:"responseTime",key:"responseTime",width:"15%"},{title:t("reports:detail.errorRate"),dataIndex:"errorRate",key:"errorRate",width:"15%"},{title:t("reports:detail.availability"),dataIndex:"availability",key:"availability",width:"15%"},{title:t("reports:detail.requests"),dataIndex:"requests",key:"requests",width:"15%"}];return i?e.jsx($,{$isDark:a,children:e.jsxs("div",{style:{textAlign:"center",padding:"100px 0"},children:[e.jsx(te,{size:"large"}),e.jsx("div",{style:{marginTop:16,color:a?"#ffffff":"#666666"},children:t("reports:detail.loading")})]})}):l?e.jsxs($,{$isDark:a,children:[e.jsxs(u,{style:{marginBottom:24},children:[e.jsx(u.Item,{children:e.jsx(ae,{})}),e.jsx(u.Item,{children:e.jsx("span",{onClick:()=>k("/reports"),style:{cursor:"pointer"},children:t("reports:title")})}),e.jsx(u.Item,{children:l.name})]}),e.jsxs(E,{$isDark:a,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs(ye,{level:2,style:{margin:0,color:a?"#ffffff":"#262626"},children:[e.jsx(le,{style:{marginRight:12}}),l.name]}),e.jsxs(v,{style:{marginTop:8},children:[e.jsx(P,{color:M(l.status),children:N(l.status)}),e.jsxs(c,{type:"secondary",children:[e.jsx(F,{})," ",l.author]}),e.jsxs(c,{type:"secondary",children:[e.jsx(oe,{})," ",l.createdAt]})]})]}),e.jsxs(v,{children:[e.jsx(m,{icon:e.jsx(ne,{}),children:t("reports:detail.share")}),e.jsx(m,{icon:e.jsx(de,{}),children:t("reports:detail.print")}),e.jsx(m,{type:"primary",icon:e.jsx(ce,{}),children:t("reports:detail.download")})]})]}),e.jsx(W,{style:{color:a?"#ffffff":"#595959",fontSize:16},children:l.description}),e.jsxs(x,{column:4,style:{marginTop:24},children:[e.jsx(x.Item,{label:t("reports:detail.fileSize"),children:l.size}),e.jsx(x.Item,{label:t("reports:detail.downloads"),children:l.downloads}),e.jsx(x.Item,{label:t("reports:detail.lastModified"),children:l.lastModified}),e.jsx(x.Item,{label:t("reports:detail.reportId"),children:l.id})]})]}),l.summary&&e.jsxs(j,{gutter:[16,16],style:{marginBottom:24},children:[e.jsx(n,{xs:24,sm:12,md:6,children:e.jsx(g,{$isDark:a,children:e.jsx(p,{title:t("reports:detail.totalServices"),value:l.summary.totalServices,prefix:e.jsx(xe,{}),valueStyle:{color:"#1890ff"}})})}),e.jsx(n,{xs:24,sm:12,md:6,children:e.jsx(g,{$isDark:a,children:e.jsx(p,{title:t("reports:detail.healthyServices"),value:l.summary.healthyServices,prefix:e.jsx(L,{}),valueStyle:{color:"#52c41a"}})})}),e.jsx(n,{xs:24,sm:12,md:6,children:e.jsx(g,{$isDark:a,children:e.jsx(p,{title:t("reports:detail.warningServices"),value:l.summary.warningServices,prefix:e.jsx(q,{}),valueStyle:{color:"#faad14"}})})}),e.jsx(n,{xs:24,sm:12,md:6,children:e.jsx(g,{$isDark:a,children:e.jsx(p,{title:t("reports:detail.overallScore"),value:l.summary.overallScore,suffix:"%",prefix:e.jsx(pe,{}),valueStyle:{color:"#722ed1"}})})})]}),(T=l.sections)==null?void 0:T.map((r,d)=>{var w,C;return e.jsxs(E,{$isDark:a,title:r.titleKey?t(`reports:sections.${r.titleKey}`):r.title,children:[e.jsx(W,{style:{color:a?"#ffffff":"#595959"},children:r.content}),r.type==="analysis"&&r.data&&e.jsx(fe,{columns:Q,dataSource:r.data,pagination:!1,size:"middle",style:{marginTop:16}}),r.type==="trend"&&e.jsxs("div",{children:[r.metrics&&e.jsx(j,{gutter:[16,16],style:{marginBottom:24},children:r.metrics.map((s,o)=>e.jsx(n,{xs:24,sm:12,md:6,children:e.jsxs(f,{size:"small",children:[e.jsx(p,{title:s.name,value:s.current,precision:s.name.includes("率")?1:0,valueStyle:{color:s.status==="good"?"#3f8600":s.status==="warning"||s.status==="critical"?"#cf1322":"#1890ff"},prefix:s.trend.startsWith("+")?e.jsx(he,{}):s.trend.startsWith("-")?e.jsx(me,{}):null,suffix:e.jsxs("span",{style:{fontSize:"12px",marginLeft:"8px"},children:["(",s.trend,")"]})}),e.jsx("div",{style:{fontSize:"12px",color:a?"#ffffff80":"#00000073",marginTop:"8px"},children:s.description})]})},o))}),r.trendData&&e.jsxs("div",{style:{background:a?"#1f1f1f":"#fafafa",padding:"16px",borderRadius:"6px",marginTop:"16px"},children:[e.jsx("div",{style:{marginBottom:"16px",fontWeight:"bold"},children:"趋势图表"}),Object.entries(r.trendData).map(([s,o])=>{var B,z;return e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("div",{style:{marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:s==="responseTime"?"响应时间趋势":s==="throughput"?"吞吐量趋势":s==="errorRate"?"错误率趋势":s==="availability"?"可用性趋势":s}),e.jsx("div",{style:{display:"flex",alignItems:"end",height:"100px",gap:"4px",padding:"8px",background:a?"#262626":"#ffffff",borderRadius:"4px"},children:o.map((h,U)=>{const V=Math.max(...o.map(Z=>Z.value)),X=h.value/V*80;return e.jsx("div",{style:{flex:1,height:`${X}px`,background:s==="errorRate"?"#ff4d4f":s==="availability"&&h.value<99?"#faad14":"#1890ff",borderRadius:"2px",position:"relative",minHeight:"4px"},title:`${h.date}: ${h.value}${s==="responseTime"?"ms":s==="throughput"?"K req/s":s==="errorRate"||s==="availability"?"%":""}`},U)})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:a?"#ffffff80":"#00000073",marginTop:"4px"},children:[e.jsx("span",{children:(B=o[0])==null?void 0:B.date}),e.jsx("span",{children:(z=o[o.length-1])==null?void 0:z.date})]})]},s)})]}),r.analysis&&e.jsx("div",{style:{marginTop:"24px"},children:e.jsxs(j,{gutter:[16,16],children:[e.jsx(n,{xs:24,md:12,children:e.jsx(f,{title:"关键发现",size:"small",children:e.jsx("ul",{style:{paddingLeft:"16px",margin:0},children:(w=r.analysis.keyFindings)==null?void 0:w.map((s,o)=>e.jsx("li",{style:{marginBottom:"8px"},children:s},o))})})}),e.jsx(n,{xs:24,md:12,children:e.jsx(f,{title:"根本原因",size:"small",children:e.jsx("ul",{style:{paddingLeft:"16px",margin:0},children:(C=r.analysis.rootCauses)==null?void 0:C.map((s,o)=>e.jsx("li",{style:{marginBottom:"8px"},children:s},o))})})})]})})]}),r.type==="recommendations"&&r.recommendations&&e.jsx(A,{style:{marginTop:16},children:r.recommendations.map((s,o)=>e.jsx(A.Item,{color:D(s.priority),dot:s.priority==="high"?e.jsx(q,{}):s.priority==="medium"?e.jsx(ue,{}):e.jsx(L,{}),children:e.jsxs("div",{children:[e.jsxs(v,{children:[e.jsx(P,{color:D(s.priority),children:s.priority==="high"?t("reports:detail.highPriority"):s.priority==="medium"?t("reports:detail.mediumPriority"):t("reports:detail.lowPriority")}),e.jsx(c,{strong:!0,style:{color:a?"#ffffff":"#262626"},children:s.item})]}),e.jsx("div",{style:{marginTop:8,paddingLeft:0},children:e.jsxs(j,{gutter:[16,8],children:[e.jsx(n,{span:12,children:e.jsxs(c,{type:"secondary",children:[e.jsx(H,{})," ",t("reports:detail.deadline"),": ",s.deadline]})}),s.assignee&&e.jsx(n,{span:12,children:e.jsxs(c,{type:"secondary",children:[e.jsx(F,{})," ",t("reports:detail.assignee"),": ",s.assignee]})}),s.estimatedHours&&e.jsx(n,{span:12,children:e.jsxs(c,{type:"secondary",children:[e.jsx(H,{})," ",t("reports:detail.estimatedHours"),": ",s.estimatedHours]})}),s.impact&&e.jsx(n,{span:24,children:e.jsxs(c,{type:"secondary",style:{fontStyle:"italic"},children:[t("reports:detail.expectedImpact"),": ",s.impact]})})]})})]})},o))})]},d)})]}):e.jsx($,{$isDark:a,children:e.jsx(re,{message:t("reports:detail.notFound"),description:t("reports:detail.notFoundDesc"),type:"error",showIcon:!0,action:e.jsx(m,{size:"small",onClick:()=>k("/reports"),children:t("common:back")})})})};export{Re as default};

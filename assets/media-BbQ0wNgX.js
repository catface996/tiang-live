import{m as yt,b as mt,h as ct,P as q,by as wt,Z as Lt,ay as bt,bz as Rt,bA as Ct,bB as ot,bC as vt,bD as U,bE as It,bF as N,_ as Bt,a as Dt,bG as ut,O,f as z,ai as kt,bH as _t,ah as Pt,bI as St,bJ as Et,bK as Tt,j as xt,a2 as A,bL as Ht,g as Ot,l as At}from"./vendor-CsGdsTBW.js";function S(e){return isFinite(e)}function Ft(e,t,i){var r=t.x==null?0:t.x,n=t.x2==null?1:t.x2,a=t.y==null?0:t.y,s=t.y2==null?0:t.y2;t.global||(r=r*i.width+i.x,n=n*i.width+i.x,a=a*i.height+i.y,s=s*i.height+i.y),r=S(r)?r:0,n=S(n)?n:1,a=S(a)?a:0,s=S(s)?s:0;var f=e.createLinearGradient(r,a,n,s);return f}function Mt(e,t,i){var r=i.width,n=i.height,a=Math.min(r,n),s=t.x==null?.5:t.x,f=t.y==null?.5:t.y,h=t.r==null?.5:t.r;t.global||(s=s*r+i.x,f=f*n+i.y,h=h*a),s=S(s)?s:.5,f=S(f)?f:.5,h=h>=0&&S(h)?h:.5;var u=e.createRadialGradient(s,f,0,s,f,h);return u}function Z(e,t,i){for(var r=t.type==="radial"?Mt(e,t,i):Ft(e,t,i),n=t.colorStops,a=0;a<n.length;a++)r.addColorStop(n[a].offset,n[a].color);return r}function Wt(e,t){if(e===t||!e&&!t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!0;return!1}function F(e){return parseInt(e,10)}function M(e,t,i){var r=["width","height"][t],n=["clientWidth","clientHeight"][t],a=["paddingLeft","paddingTop"][t],s=["paddingRight","paddingBottom"][t];if(i[r]!=null&&i[r]!=="auto")return parseFloat(i[r]);var f=document.defaultView.getComputedStyle(e);return(e[n]||F(f[r])||F(e.style[r]))-(F(f[a])||0)-(F(f[s])||0)|0}function Nt(e,t){return!e||e==="solid"||!(t>0)?null:e==="dashed"?[4*t,2*t]:e==="dotted"?[t]:mt(e)?[e]:ct(e)?e:null}function dt(e){var t=e.style,i=t.lineDash&&t.lineWidth>0&&Nt(t.lineDash,t.lineWidth),r=t.lineDashOffset;if(i){var n=t.strokeNoScale&&e.getLineScale?e.getLineScale():1;n&&n!==1&&(i=yt(i,function(a){return a/n}),r/=n)}return[i,r]}var Vt=new bt(!0);function V(e){var t=e.stroke;return!(t==null||t==="none"||!(e.lineWidth>0))}function Q(e){return typeof e=="string"&&e!=="none"}function G(e){var t=e.fill;return t!=null&&t!=="none"}function $(e,t){if(t.fillOpacity!=null&&t.fillOpacity!==1){var i=e.globalAlpha;e.globalAlpha=t.fillOpacity*t.opacity,e.fill(),e.globalAlpha=i}else e.fill()}function j(e,t){if(t.strokeOpacity!=null&&t.strokeOpacity!==1){var i=e.globalAlpha;e.globalAlpha=t.strokeOpacity*t.opacity,e.stroke(),e.globalAlpha=i}else e.stroke()}function X(e,t,i){var r=ot(t.image,t.__image,i);if(vt(r)){var n=e.createPattern(r,t.repeat||"repeat");if(typeof DOMMatrix=="function"&&n&&n.setTransform){var a=new DOMMatrix;a.translateSelf(t.x||0,t.y||0),a.rotateSelf(0,0,(t.rotation||0)*It),a.scaleSelf(t.scaleX||1,t.scaleY||1),n.setTransform(a)}return n}}function Gt(e,t,i,r){var n,a=V(i),s=G(i),f=i.strokePercent,h=f<1,u=!t.path;(!t.silent||h)&&u&&t.createPathProxy();var v=t.path||Vt,o=t.__dirty;if(!r){var _=i.fill,p=i.stroke,w=s&&!!_.colorStops,y=a&&!!p.colorStops,d=s&&!!_.image,g=a&&!!p.image,l=void 0,m=void 0,L=void 0,D=void 0,C=void 0;(w||y)&&(C=t.getBoundingRect()),w&&(l=o?Z(e,_,C):t.__canvasFillGradient,t.__canvasFillGradient=l),y&&(m=o?Z(e,p,C):t.__canvasStrokeGradient,t.__canvasStrokeGradient=m),d&&(L=o||!t.__canvasFillPattern?X(e,_,t):t.__canvasFillPattern,t.__canvasFillPattern=L),g&&(D=o||!t.__canvasStrokePattern?X(e,p,t):t.__canvasStrokePattern,t.__canvasStrokePattern=L),w?e.fillStyle=l:d&&(L?e.fillStyle=L:s=!1),y?e.strokeStyle=m:g&&(D?e.strokeStyle=D:a=!1)}var R=t.getGlobalScale();v.setScale(R[0],R[1],t.segmentIgnoreThreshold);var c,I;e.setLineDash&&i.lineDash&&(n=dt(t),c=n[0],I=n[1]);var B=!0;(u||o&Rt)&&(v.setDPR(e.dpr),h?v.setContext(null):(v.setContext(e),B=!1),v.reset(),t.buildPath(v,t.shape,r),v.toStatic(),t.pathUpdated()),B&&v.rebuildPath(e,h?f:1),c&&(e.setLineDash(c),e.lineDashOffset=I),r||(i.strokeFirst?(a&&j(e,i),s&&$(e,i)):(s&&$(e,i),a&&j(e,i))),c&&e.setLineDash([])}function Ut(e,t,i){var r=t.__image=ot(i.image,t.__image,t,t.onload);if(!(!r||!vt(r))){var n=i.x||0,a=i.y||0,s=t.getWidth(),f=t.getHeight(),h=r.width/r.height;if(s==null&&f!=null?s=f*h:f==null&&s!=null?f=s/h:s==null&&f==null&&(s=r.width,f=r.height),i.sWidth&&i.sHeight){var u=i.sx||0,v=i.sy||0;e.drawImage(r,u,v,i.sWidth,i.sHeight,n,a,s,f)}else if(i.sx&&i.sy){var u=i.sx,v=i.sy,o=s-u,_=f-v;e.drawImage(r,u,v,o,_,n,a,s,f)}else e.drawImage(r,n,a,s,f)}}function Yt(e,t,i){var r,n=i.text;if(n!=null&&(n+=""),n){e.font=i.font||Ct,e.textAlign=i.textAlign,e.textBaseline=i.textBaseline;var a=void 0,s=void 0;e.setLineDash&&i.lineDash&&(r=dt(t),a=r[0],s=r[1]),a&&(e.setLineDash(a),e.lineDashOffset=s),i.strokeFirst?(V(i)&&e.strokeText(n,i.x,i.y),G(i)&&e.fillText(n,i.x,i.y)):(G(i)&&e.fillText(n,i.x,i.y),V(i)&&e.strokeText(n,i.x,i.y)),a&&e.setLineDash([])}}var tt=["shadowBlur","shadowOffsetX","shadowOffsetY"],it=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function lt(e,t,i,r,n){var a=!1;if(!r&&(i=i||{},t===i))return!1;if(r||t.opacity!==i.opacity){b(e,n),a=!0;var s=Math.max(Math.min(t.opacity,1),0);e.globalAlpha=isNaN(s)?U.opacity:s}(r||t.blend!==i.blend)&&(a||(b(e,n),a=!0),e.globalCompositeOperation=t.blend||U.blend);for(var f=0;f<tt.length;f++){var h=tt[f];(r||t[h]!==i[h])&&(a||(b(e,n),a=!0),e[h]=e.dpr*(t[h]||0))}return(r||t.shadowColor!==i.shadowColor)&&(a||(b(e,n),a=!0),e.shadowColor=t.shadowColor||U.shadowColor),a}function et(e,t,i,r,n){var a=x(t,n.inHover),s=r?null:i&&x(i,n.inHover)||{};if(a===s)return!1;var f=lt(e,a,s,r,n);if((r||a.fill!==s.fill)&&(f||(b(e,n),f=!0),Q(a.fill)&&(e.fillStyle=a.fill)),(r||a.stroke!==s.stroke)&&(f||(b(e,n),f=!0),Q(a.stroke)&&(e.strokeStyle=a.stroke)),(r||a.opacity!==s.opacity)&&(f||(b(e,n),f=!0),e.globalAlpha=a.opacity==null?1:a.opacity),t.hasStroke()){var h=a.lineWidth,u=h/(a.strokeNoScale&&t.getLineScale?t.getLineScale():1);e.lineWidth!==u&&(f||(b(e,n),f=!0),e.lineWidth=u)}for(var v=0;v<it.length;v++){var o=it[v],_=o[0];(r||a[_]!==s[_])&&(f||(b(e,n),f=!0),e[_]=a[_]||o[1])}return f}function zt(e,t,i,r,n){return lt(e,x(t,n.inHover),i&&x(i,n.inHover),r,n)}function gt(e,t){var i=t.transform,r=e.dpr||1;i?e.setTransform(r*i[0],r*i[1],r*i[2],r*i[3],r*i[4],r*i[5]):e.setTransform(r,0,0,r,0,0)}function Zt(e,t,i){for(var r=!1,n=0;n<e.length;n++){var a=e[n];r=r||a.isZeroArea(),gt(t,a),t.beginPath(),a.buildPath(t,a.shape),t.clip()}i.allClipped=r}function Xt(e,t){return e&&t?e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]:!(!e&&!t)}var rt=1,at=2,nt=3,st=4;function Jt(e){var t=G(e),i=V(e);return!(e.lineDash||!(+t^+i)||t&&typeof e.fill!="string"||i&&typeof e.stroke!="string"||e.strokePercent<1||e.strokeOpacity<1||e.fillOpacity<1)}function b(e,t){t.batchFill&&e.fill(),t.batchStroke&&e.stroke(),t.batchFill="",t.batchStroke=""}function x(e,t){return t&&e.__hoverStyle||e.style}function Kt(e,t){E(e,t,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function E(e,t,i,r){var n=t.transform;if(!t.shouldBePainted(i.viewWidth,i.viewHeight,!1,!1)){t.__dirty&=~N,t.__isRendered=!1;return}var a=t.__clipPaths,s=i.prevElClipPaths,f=!1,h=!1;if((!s||Wt(a,s))&&(s&&s.length&&(b(e,i),e.restore(),h=f=!0,i.prevElClipPaths=null,i.allClipped=!1,i.prevEl=null),a&&a.length&&(b(e,i),e.save(),Zt(a,e,i),f=!0),i.prevElClipPaths=a),i.allClipped){t.__isRendered=!1;return}t.beforeBrush&&t.beforeBrush(),t.innerBeforeBrush();var u=i.prevEl;u||(h=f=!0);var v=t instanceof q&&t.autoBatch&&Jt(t.style);f||Xt(n,u.transform)?(b(e,i),gt(e,t)):v||b(e,i);var o=x(t,i.inHover);t instanceof q?(i.lastDrawType!==rt&&(h=!0,i.lastDrawType=rt),et(e,t,u,h,i),(!v||!i.batchFill&&!i.batchStroke)&&e.beginPath(),Gt(e,t,o,v),v&&(i.batchFill=o.fill||"",i.batchStroke=o.stroke||"")):t instanceof wt?(i.lastDrawType!==nt&&(h=!0,i.lastDrawType=nt),et(e,t,u,h,i),Yt(e,t,o)):t instanceof Lt?(i.lastDrawType!==at&&(h=!0,i.lastDrawType=at),zt(e,t,u,h,i),Ut(e,t,o)):t.getTemporalDisplayables&&(i.lastDrawType!==st&&(h=!0,i.lastDrawType=st),qt(e,t,i)),v&&r&&b(e,i),t.innerAfterBrush(),t.afterBrush&&t.afterBrush(),i.prevEl=t,t.__dirty=0,t.__isRendered=!0}function qt(e,t,i){var r=t.getDisplayables(),n=t.getTemporalDisplayables();e.save();var a={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:i.viewWidth,viewHeight:i.viewHeight,inHover:i.inHover},s,f;for(s=t.getCursor(),f=r.length;s<f;s++){var h=r[s];h.beforeBrush&&h.beforeBrush(),h.innerBeforeBrush(),E(e,h,a,s===f-1),h.innerAfterBrush(),h.afterBrush&&h.afterBrush(),a.prevEl=h}for(var u=0,v=n.length;u<v;u++){var h=n[u];h.beforeBrush&&h.beforeBrush(),h.innerBeforeBrush(),E(e,h,a,u===v-1),h.innerAfterBrush(),h.afterBrush&&h.afterBrush(),a.prevEl=h}t.clearTemporalDisplayables(),t.notClear=!0,e.restore()}function ft(e,t,i){var r=Pt.createCanvas(),n=t.getWidth(),a=t.getHeight(),s=r.style;return s&&(s.position="absolute",s.left="0",s.top="0",s.width=n+"px",s.height=a+"px",r.setAttribute("data-zr-dom-id",e)),r.width=n*i,r.height=a*i,r}var Y=function(e){Bt(t,e);function t(i,r,n){var a=e.call(this)||this;a.motionBlur=!1,a.lastFrameAlpha=.7,a.dpr=1,a.virtual=!1,a.config={},a.incremental=!1,a.zlevel=0,a.maxRepaintRectCount=5,a.__dirty=!0,a.__firstTimePaint=!0,a.__used=!1,a.__drawIndex=0,a.__startIndex=0,a.__endIndex=0,a.__prevStartIndex=null,a.__prevEndIndex=null;var s;n=n||_t,typeof i=="string"?s=ft(i,r,n):Dt(i)&&(s=i,i=s.id),a.id=i,a.dom=s;var f=s.style;return f&&(ut(s),s.onselectstart=function(){return!1},f.padding="0",f.margin="0",f.borderWidth="0"),a.painter=r,a.dpr=n,a}return t.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},t.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},t.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},t.prototype.setUnpainted=function(){this.__firstTimePaint=!0},t.prototype.createBackBuffer=function(){var i=this.dpr;this.domBack=ft("back-"+this.id,this.painter,i),this.ctxBack=this.domBack.getContext("2d"),i!==1&&this.ctxBack.scale(i,i)},t.prototype.createRepaintRects=function(i,r,n,a){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var s=[],f=this.maxRepaintRectCount,h=!1,u=new O(0,0,0,0);function v(l){if(!(!l.isFinite()||l.isZero()))if(s.length===0){var m=new O(0,0,0,0);m.copy(l),s.push(m)}else{for(var L=!1,D=1/0,C=0,R=0;R<s.length;++R){var c=s[R];if(c.intersect(l)){var I=new O(0,0,0,0);I.copy(c),I.union(l),s[R]=I,L=!0;break}else if(h){u.copy(l),u.union(c);var B=l.width*l.height,T=c.width*c.height,k=u.width*u.height,H=k-B-T;H<D&&(D=H,C=R)}}if(h&&(s[C].union(l),L=!0),!L){var m=new O(0,0,0,0);m.copy(l),s.push(m)}h||(h=s.length>=f)}}for(var o=this.__startIndex;o<this.__endIndex;++o){var _=i[o];if(_){var p=_.shouldBePainted(n,a,!0,!0),w=_.__isRendered&&(_.__dirty&N||!p)?_.getPrevPaintRect():null;w&&v(w);var y=p&&(_.__dirty&N||!_.__isRendered)?_.getPaintRect():null;y&&v(y)}}for(var o=this.__prevStartIndex;o<this.__prevEndIndex;++o){var _=r[o],p=_&&_.shouldBePainted(n,a,!0,!0);if(_&&(!p||!_.__zr)&&_.__isRendered){var w=_.getPrevPaintRect();w&&v(w)}}var d;do{d=!1;for(var o=0;o<s.length;){if(s[o].isZero()){s.splice(o,1);continue}for(var g=o+1;g<s.length;)s[o].intersect(s[g])?(d=!0,s[o].union(s[g]),s.splice(g,1)):g++;o++}}while(d);return this._paintRects=s,s},t.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},t.prototype.resize=function(i,r){var n=this.dpr,a=this.dom,s=a.style,f=this.domBack;s&&(s.width=i+"px",s.height=r+"px"),a.width=i*n,a.height=r*n,f&&(f.width=i*n,f.height=r*n,n!==1&&this.ctxBack.scale(n,n))},t.prototype.clear=function(i,r,n){var a=this.dom,s=this.ctx,f=a.width,h=a.height;r=r||this.clearColor;var u=this.motionBlur&&!i,v=this.lastFrameAlpha,o=this.dpr,_=this;u&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(a,0,0,f/o,h/o));var p=this.domBack;function w(y,d,g,l){if(s.clearRect(y,d,g,l),r&&r!=="transparent"){var m=void 0;if(St(r)){var L=r.global||r.__width===g&&r.__height===l;m=L&&r.__canvasGradient||Z(s,r,{x:0,y:0,width:g,height:l}),r.__canvasGradient=m,r.__width=g,r.__height=l}else Et(r)&&(r.scaleX=r.scaleX||o,r.scaleY=r.scaleY||o,m=X(s,r,{dirty:function(){_.setUnpainted(),_.painter.refresh()}}));s.save(),s.fillStyle=m||r,s.fillRect(y,d,g,l),s.restore()}u&&(s.save(),s.globalAlpha=v,s.drawImage(p,y,d,g,l),s.restore())}!n||u?w(0,0,f,h):n.length&&z(n,function(y){w(y.x*o,y.y*o,y.width*o,y.height*o)})},t}(kt),ht=1e5,P=314159,W=.01,Qt=.001;function $t(e){return e?e.__builtin__?!0:!(typeof e.resize!="function"||typeof e.refresh!="function"):!1}function jt(e,t){var i=document.createElement("div");return i.style.cssText=["position:relative","width:"+e+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",i}var ii=function(){function e(t,i,r,n){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var a=!t.nodeName||t.nodeName.toUpperCase()==="CANVAS";this._opts=r=At({},r||{}),this.dpr=r.devicePixelRatio||_t,this._singleCanvas=a,this.root=t;var s=t.style;s&&(ut(t),t.innerHTML=""),this.storage=i;var f=this._zlevelList;this._prevDisplayList=[];var h=this._layers;if(a){var v=t,o=v.width,_=v.height;r.width!=null&&(o=r.width),r.height!=null&&(_=r.height),this.dpr=r.devicePixelRatio||1,v.width=o*this.dpr,v.height=_*this.dpr,this._width=o,this._height=_;var p=new Y(v,this,this.dpr);p.__builtin__=!0,p.initContext(),h[P]=p,p.zlevel=P,f.push(P),this._domRoot=t}else{this._width=M(t,0,r),this._height=M(t,1,r);var u=this._domRoot=jt(this._width,this._height);t.appendChild(u)}}return e.prototype.getType=function(){return"canvas"},e.prototype.isSingleCanvas=function(){return this._singleCanvas},e.prototype.getViewportRoot=function(){return this._domRoot},e.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},e.prototype.refresh=function(t){var i=this.storage.getDisplayList(!0),r=this._prevDisplayList,n=this._zlevelList;this._redrawId=Math.random(),this._paintList(i,r,t,this._redrawId);for(var a=0;a<n.length;a++){var s=n[a],f=this._layers[s];if(!f.__builtin__&&f.refresh){var h=a===0?this._backgroundColor:null;f.refresh(h)}}return this._opts.useDirtyRect&&(this._prevDisplayList=i.slice()),this},e.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},e.prototype._paintHoverList=function(t){var i=t.length,r=this._hoverlayer;if(r&&r.clear(),!!i){for(var n={inHover:!0,viewWidth:this._width,viewHeight:this._height},a,s=0;s<i;s++){var f=t[s];f.__inHover&&(r||(r=this._hoverlayer=this.getLayer(ht)),a||(a=r.ctx,a.save()),E(a,f,n,s===i-1))}a&&a.restore()}},e.prototype.getHoverLayer=function(){return this.getLayer(ht)},e.prototype.paintOne=function(t,i){Kt(t,i)},e.prototype._paintList=function(t,i,r,n){if(this._redrawId===n){r=r||!1,this._updateLayerStatus(t);var a=this._doPaintList(t,i,r),s=a.finished,f=a.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),f&&this._paintHoverList(t),s)this.eachLayer(function(u){u.afterBrush&&u.afterBrush()});else{var h=this;Tt(function(){h._paintList(t,i,r,n)})}}},e.prototype._compositeManually=function(){var t=this.getLayer(P).ctx,i=this._domRoot.width,r=this._domRoot.height;t.clearRect(0,0,i,r),this.eachBuiltinLayer(function(n){n.virtual&&t.drawImage(n.dom,0,0,i,r)})},e.prototype._doPaintList=function(t,i,r){for(var n=this,a=[],s=this._opts.useDirtyRect,f=0;f<this._zlevelList.length;f++){var h=this._zlevelList[f],u=this._layers[h];u.__builtin__&&u!==this._hoverlayer&&(u.__dirty||r)&&a.push(u)}for(var v=!0,o=!1,_=function(y){var d=a[y],g=d.ctx,l=s&&d.createRepaintRects(t,i,p._width,p._height),m=r?d.__startIndex:d.__drawIndex,L=!r&&d.incremental&&Date.now,D=L&&Date.now(),C=d.zlevel===p._zlevelList[0]?p._backgroundColor:null;if(d.__startIndex===d.__endIndex)d.clear(!1,C,l);else if(m===d.__startIndex){var R=t[m];(!R.incremental||!R.notClear||r)&&d.clear(!1,C,l)}m===-1&&(console.error("For some unknown reason. drawIndex is -1"),m=d.__startIndex);var c,I=function(H){var J={inHover:!1,allClipped:!1,prevEl:null,viewWidth:n._width,viewHeight:n._height};for(c=m;c<d.__endIndex;c++){var K=t[c];if(K.__inHover&&(o=!0),n._doPaintEl(K,d,s,H,J,c===d.__endIndex-1),L){var pt=Date.now()-D;if(pt>15)break}}J.prevElClipPaths&&g.restore()};if(l)if(l.length===0)c=d.__endIndex;else for(var B=p.dpr,T=0;T<l.length;++T){var k=l[T];g.save(),g.beginPath(),g.rect(k.x*B,k.y*B,k.width*B,k.height*B),g.clip(),I(k),g.restore()}else g.save(),I(),g.restore();d.__drawIndex=c,d.__drawIndex<d.__endIndex&&(v=!1)},p=this,w=0;w<a.length;w++)_(w);return xt.wxa&&z(this._layers,function(y){y&&y.ctx&&y.ctx.draw&&y.ctx.draw()}),{finished:v,needsRefreshHover:o}},e.prototype._doPaintEl=function(t,i,r,n,a,s){var f=i.ctx;if(r){var h=t.getPaintRect();(!n||h&&h.intersect(n))&&(E(f,t,a,s),t.setPrevPaintRect(h))}else E(f,t,a,s)},e.prototype.getLayer=function(t,i){this._singleCanvas&&!this._needsManuallyCompositing&&(t=P);var r=this._layers[t];return r||(r=new Y("zr_"+t,this,this.dpr),r.zlevel=t,r.__builtin__=!0,this._layerConfig[t]?A(r,this._layerConfig[t],!0):this._layerConfig[t-W]&&A(r,this._layerConfig[t-W],!0),i&&(r.virtual=i),this.insertLayer(t,r),r.initContext()),r},e.prototype.insertLayer=function(t,i){var r=this._layers,n=this._zlevelList,a=n.length,s=this._domRoot,f=null,h=-1;if(!r[t]&&$t(i)){if(a>0&&t>n[0]){for(h=0;h<a-1&&!(n[h]<t&&n[h+1]>t);h++);f=r[n[h]]}if(n.splice(h+1,0,t),r[t]=i,!i.virtual)if(f){var u=f.dom;u.nextSibling?s.insertBefore(i.dom,u.nextSibling):s.appendChild(i.dom)}else s.firstChild?s.insertBefore(i.dom,s.firstChild):s.appendChild(i.dom);i.painter||(i.painter=this)}},e.prototype.eachLayer=function(t,i){for(var r=this._zlevelList,n=0;n<r.length;n++){var a=r[n];t.call(i,this._layers[a],a)}},e.prototype.eachBuiltinLayer=function(t,i){for(var r=this._zlevelList,n=0;n<r.length;n++){var a=r[n],s=this._layers[a];s.__builtin__&&t.call(i,s,a)}},e.prototype.eachOtherLayer=function(t,i){for(var r=this._zlevelList,n=0;n<r.length;n++){var a=r[n],s=this._layers[a];s.__builtin__||t.call(i,s,a)}},e.prototype.getLayers=function(){return this._layers},e.prototype._updateLayerStatus=function(t){this.eachBuiltinLayer(function(o,_){o.__dirty=o.__used=!1});function i(o){a&&(a.__endIndex!==o&&(a.__dirty=!0),a.__endIndex=o)}if(this._singleCanvas)for(var r=1;r<t.length;r++){var n=t[r];if(n.zlevel!==t[r-1].zlevel||n.incremental){this._needsManuallyCompositing=!0;break}}var a=null,s=0,f,h;for(h=0;h<t.length;h++){var n=t[h],u=n.zlevel,v=void 0;f!==u&&(f=u,s=0),n.incremental?(v=this.getLayer(u+Qt,this._needsManuallyCompositing),v.incremental=!0,s=1):v=this.getLayer(u+(s>0?W:0),this._needsManuallyCompositing),v.__builtin__||Ht("ZLevel "+u+" has been used by unkown layer "+v.id),v!==a&&(v.__used=!0,v.__startIndex!==h&&(v.__dirty=!0),v.__startIndex=h,v.incremental?v.__drawIndex=-1:v.__drawIndex=h,i(h),a=v),n.__dirty&N&&!n.__inHover&&(v.__dirty=!0,v.incremental&&v.__drawIndex<0&&(v.__drawIndex=h))}i(h),this.eachBuiltinLayer(function(o,_){!o.__used&&o.getElementCount()>0&&(o.__dirty=!0,o.__startIndex=o.__endIndex=o.__drawIndex=0),o.__dirty&&o.__drawIndex<0&&(o.__drawIndex=o.__startIndex)})},e.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},e.prototype._clearLayer=function(t){t.clear()},e.prototype.setBackgroundColor=function(t){this._backgroundColor=t,z(this._layers,function(i){i.setUnpainted()})},e.prototype.configLayer=function(t,i){if(i){var r=this._layerConfig;r[t]?A(r[t],i,!0):r[t]=i;for(var n=0;n<this._zlevelList.length;n++){var a=this._zlevelList[n];if(a===t||a===t+W){var s=this._layers[a];A(s,r[t],!0)}}}},e.prototype.delLayer=function(t){var i=this._layers,r=this._zlevelList,n=i[t];n&&(n.dom.parentNode.removeChild(n.dom),delete i[t],r.splice(Ot(r,t),1))},e.prototype.resize=function(t,i){if(this._domRoot.style){var r=this._domRoot;r.style.display="none";var n=this._opts,a=this.root;if(t!=null&&(n.width=t),i!=null&&(n.height=i),t=M(a,0,n),i=M(a,1,n),r.style.display="",this._width!==t||i!==this._height){r.style.width=t+"px",r.style.height=i+"px";for(var s in this._layers)this._layers.hasOwnProperty(s)&&this._layers[s].resize(t,i);this.refresh(!0)}this._width=t,this._height=i}else{if(t==null||i==null)return;this._width=t,this._height=i,this.getLayer(P).resize(t,i)}return this},e.prototype.clearLayer=function(t){var i=this._layers[t];i&&i.clear()},e.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},e.prototype.getRenderedCanvas=function(t){if(t=t||{},this._singleCanvas&&!this._compositeManually)return this._layers[P].dom;var i=new Y("image",this,t.pixelRatio||this.dpr);i.initContext(),i.clear(!1,t.backgroundColor||this._backgroundColor);var r=i.ctx;if(t.pixelRatio<=this.dpr){this.refresh();var n=i.dom.width,a=i.dom.height;this.eachLayer(function(o){o.__builtin__?r.drawImage(o.dom,0,0,n,a):o.renderToCanvas&&(r.save(),o.renderToCanvas(r),r.restore())})}else for(var s={inHover:!1,viewWidth:this._width,viewHeight:this._height},f=this.storage.getDisplayList(!0),h=0,u=f.length;h<u;h++){var v=f[h];E(r,v,s,h===u-1)}return i.dom},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e}();export{ii as C,M as a,Kt as b,dt as g};

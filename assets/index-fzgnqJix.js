import{a as y,j as e,R as vt}from"./react-Ce7XF6j7.js";import{u as _e,aC as d,b3 as he,g as He,n as Qe,aS as le,aQ as Te,aF as oe,au as Je,_ as xe,S as Ce,c as Ze,a3 as Ye,az as h,a7 as Fe,B as C,bl as Ct,ap as de,K as Xe,a4 as Pe,a1 as me,bm as we,bg as ye,e as wt,bq as Ve,ai as De,aa as Dt,U as re,V as m,X as $e,a6 as Ue,ag as Le,ah as v,d as g,ab as Ge,a8 as $t,a9 as It,aW as Tt,al as Ft,an as Pt}from"./react-dom-lwsOmxvp.js";import{u as Rt}from"./index-BcnT2YWE.js";import{d5 as zt}from"./vendor-C33h3vmx.js";import{S as At}from"./SearchFilterBar-BU5SIIUk.js";import"./redux-CiqK6azd.js";import"./echarts-core-DhwA57WF.js";import"./media-DReEfpSm.js";import"./cytoscape-Le_BSg_G.js";import"./antd-icons-CI4I6I7B.js";import"./dayjs-CTfHAVUH.js";import"./emotion-BhZTwsuK.js";import"./mermaid-DiWIFDeh.js";import"./d3-BDva1q7J.js";import"./lodash-BORto0-T.js";import"./i18n-CMVetavo.js";const qt=()=>{const t=zt.create({baseURL:"https://api.ai-ops.com/api/v1",timeout:1e4,headers:{"Content-Type":"application/json"}});return t.interceptors.request.use(i=>{const r=localStorage.getItem("auth_token");return r&&i.headers&&(i.headers.Authorization=`Bearer ${r}`),i},i=>Promise.reject(i)),t.interceptors.response.use(i=>{var r;return((r=i.data)==null?void 0:r.data)!==void 0,i.data},i=>{var o,s,k,x,D;const r={code:((s=(o=i.response)==null?void 0:o.status)==null?void 0:s.toString())||"UNKNOWN",message:((x=(k=i.response)==null?void 0:k.data)==null?void 0:x.message)||i.message||"请求失败",details:(D=i.response)==null?void 0:D.data,timestamp:new Date().toISOString()};return Promise.reject(r)}),t},S=qt();class Mt{async getDataSources(){try{return(await S.get("/entity-scan/data-sources")).data}catch(i){return console.error("Failed to fetch data sources:",i),this.getMockDataSources()}}async createDataSource(i){try{return(await S.post("/entity-scan/data-sources",i)).data}catch(r){throw console.error("Failed to create data source:",r),r}}async updateDataSource(i,r){try{return(await S.put(`/entity-scan/data-sources/${i}`,r)).data}catch(o){throw console.error("Failed to update data source:",o),o}}async deleteDataSource(i){try{await S.delete(`/entity-scan/data-sources/${i}`)}catch(r){throw console.error("Failed to delete data source:",r),r}}async testDataSourceConnection(i){try{return(await S.post(`/entity-scan/data-sources/${i}/test`)).data}catch(r){return console.error("Failed to test data source connection:",r),{success:!1,message:"连接测试失败"}}}async startScanTask(i){try{return(await S.post("/entity-scan/tasks",i)).data}catch(r){throw console.error("Failed to start scan task:",r),r}}async getScanTasks(){try{return(await S.get("/entity-scan/tasks")).data}catch(i){return console.error("Failed to fetch scan tasks:",i),[]}}async getScanTask(i){try{return(await S.get(`/entity-scan/tasks/${i}`)).data}catch(r){throw console.error("Failed to fetch scan task:",r),r}}async pauseScanTask(i){try{await S.post(`/entity-scan/tasks/${i}/pause`)}catch(r){throw console.error("Failed to pause scan task:",r),r}}async resumeScanTask(i){try{await S.post(`/entity-scan/tasks/${i}/resume`)}catch(r){throw console.error("Failed to resume scan task:",r),r}}async stopScanTask(i){try{await S.post(`/entity-scan/tasks/${i}/stop`)}catch(r){throw console.error("Failed to stop scan task:",r),r}}async getScanResults(i){try{return(await S.get(`/entity-scan/tasks/${i}/results`)).data}catch(r){return console.error("Failed to fetch scan results:",r),[]}}async generateEntities(i,r){try{return(await S.post(`/entity-scan/tasks/${i}/generate`,{selectedResults:r})).data}catch(o){throw console.error("Failed to generate entities:",o),o}}getMockDataSources(){return[{id:"mysql-prod",name:"生产环境MySQL",type:"database",description:"生产环境主数据库，包含用户、订单、商品等核心业务数据",config:{host:"prod-mysql.example.com",port:3306,database:"business_db",username:"scan_user"},status:"connected",lastScan:"2024-06-17 14:30:00",entityCount:156},{id:"api-crm",name:"CRM系统API",type:"api",description:"CRM系统REST API，包含客户、联系人、销售机会等数据",config:{baseUrl:"https://crm.example.com/api/v1",apiKey:"***hidden***",endpoints:["/customers","/contacts","/opportunities"]},status:"connected",lastScan:"2024-06-16 09:15:00",entityCount:89},{id:"cloud-oss",name:"阿里云OSS",type:"cloud",description:"对象存储服务，包含文档、图片、视频等文件资源",config:{endpoint:"oss-cn-hangzhou.aliyuncs.com",bucket:"business-files",accessKeyId:"***hidden***"},status:"disconnected",entityCount:0},{id:"prometheus-prod",name:"生产环境Prometheus",type:"monitoring",subType:"prometheus",description:"Prometheus监控系统，包含应用指标、系统指标、业务指标等时序数据",config:{url:"http://prometheus.example.com:9090",basicAuth:{username:"admin",password:"***hidden***"},timeout:3e4,maxSamples:5e4},status:"connected",lastScan:"2024-06-17 16:45:00",entityCount:234},{id:"grafana-prod",name:"生产环境Grafana",type:"monitoring",subType:"grafana",description:"Grafana可视化平台，包含仪表板、数据源、告警规则等配置信息",config:{url:"http://grafana.example.com:3000",apiKey:"***hidden***",orgId:1,includeDashboards:!0,includeDataSources:!0,includeAlerts:!0},status:"connected",lastScan:"2024-06-17 15:20:00",entityCount:67},{id:"influxdb-metrics",name:"InfluxDB时序数据库",type:"metrics",subType:"influxdb",description:"InfluxDB时序数据库，存储应用性能指标和业务监控数据",config:{url:"http://influxdb.example.com:8086",database:"metrics",username:"metrics_user",password:"***hidden***",retention:"30d"},status:"connected",lastScan:"2024-06-17 12:15:00",entityCount:145},{id:"elasticsearch-logs",name:"Elasticsearch日志系统",type:"monitoring",subType:"elasticsearch",description:"Elasticsearch集群，存储应用日志、访问日志、错误日志等结构化数据",config:{hosts:["http://es1.example.com:9200","http://es2.example.com:9200"],username:"elastic",password:"***hidden***",indices:["app-logs-*","access-logs-*","error-logs-*"],version:"8.x"},status:"connected",lastScan:"2024-06-17 11:30:00",entityCount:89},{id:"jaeger-tracing",name:"Jaeger链路追踪",type:"monitoring",subType:"jaeger",description:"Jaeger分布式链路追踪系统，包含服务调用链、性能指标等数据",config:{queryUrl:"http://jaeger.example.com:16686",collectorUrl:"http://jaeger.example.com:14268",services:["user-service","order-service","payment-service"],lookback:"24h"},status:"connected",lastScan:"2024-06-17 10:45:00",entityCount:56},{id:"zabbix-monitor",name:"Zabbix监控系统",type:"monitoring",subType:"zabbix",description:"Zabbix企业级监控系统，包含主机、应用、网络设备等监控数据",config:{url:"http://zabbix.example.com/zabbix",username:"admin",password:"***hidden***",apiVersion:"6.0",hostGroups:["Linux servers","Web servers","Database servers"]},status:"disconnected",entityCount:0},{id:"datadog-apm",name:"Datadog APM",type:"monitoring",subType:"datadog",description:"Datadog应用性能监控，包含应用指标、日志、链路追踪等数据",config:{apiKey:"***hidden***",appKey:"***hidden***",site:"datadoghq.com",services:["web-app","api-gateway","background-jobs"],env:"production"},status:"connected",lastScan:"2024-06-17 09:30:00",entityCount:78}]}}const Bt=new Mt,{Title:Et,Text:Kt,Paragraph:Ot}=Ze,{Option:ce}=me,{TextArea:Ie}=h,{TabPane:Vt}=Je,Ut=({visible:t,onCancel:i,onOk:r,dataSource:o})=>{const{t:s}=_e(["entityScan","common"]),[k]=d.useForm(),[x,D]=y.useState("prometheus"),[A,b]=y.useState(null),[Se,q]=y.useState(!1),be=[{key:"prometheus",name:s("entityScan:dataSourceConfig.types.prometheus.name"),icon:e.jsx(he,{style:{color:"#e6522c"}}),description:s("entityScan:dataSourceConfig.types.prometheus.description"),defaultPort:9090,features:s("entityScan:dataSourceConfig.types.prometheus.features",{returnObjects:!0})},{key:"grafana",name:s("entityScan:dataSourceConfig.types.grafana.name"),icon:e.jsx(He,{style:{color:"#f46800"}}),description:s("entityScan:dataSourceConfig.types.grafana.description"),defaultPort:3e3,features:s("entityScan:dataSourceConfig.types.grafana.features",{returnObjects:!0})},{key:"elasticsearch",name:s("entityScan:dataSourceConfig.types.elasticsearch.name"),icon:e.jsx(Qe,{style:{color:"#005571"}}),description:s("entityScan:dataSourceConfig.types.elasticsearch.description"),defaultPort:9200,features:s("entityScan:dataSourceConfig.types.elasticsearch.features",{returnObjects:!0})},{key:"influxdb",name:s("entityScan:dataSourceConfig.types.influxdb.name"),icon:e.jsx(le,{style:{color:"#22adf6"}}),description:s("entityScan:dataSourceConfig.types.influxdb.description"),defaultPort:8086,features:s("entityScan:dataSourceConfig.types.influxdb.features",{returnObjects:!0})},{key:"jaeger",name:s("entityScan:dataSourceConfig.types.jaeger.name"),icon:e.jsx(le,{style:{color:"#60d0e4"}}),description:s("entityScan:dataSourceConfig.types.jaeger.description"),defaultPort:16686,features:s("entityScan:dataSourceConfig.types.jaeger.features",{returnObjects:!0})},{key:"zabbix",name:s("entityScan:dataSourceConfig.types.zabbix.name"),icon:e.jsx(Te,{style:{color:"#d40000"}}),description:s("entityScan:dataSourceConfig.types.zabbix.description"),defaultPort:80,features:s("entityScan:dataSourceConfig.types.zabbix.features",{returnObjects:!0})},{key:"datadog",name:s("entityScan:dataSourceConfig.types.datadog.name"),icon:e.jsx(he,{style:{color:"#632ca6"}}),description:s("entityScan:dataSourceConfig.types.datadog.description"),defaultPort:443,features:s("entityScan:dataSourceConfig.types.datadog.features",{returnObjects:!0})}];be.find(u=>u.key===x);const ue=async()=>{try{q(!0);const u=await k.validateFields();await new Promise(je=>setTimeout(je,2e3));const I=Math.random()>.3;b({success:I,message:s(I?"entityScan:dataSourceConfig.messages.testSuccess":"entityScan:dataSourceConfig.messages.testFailed")})}catch{b({success:!1,message:s("entityScan:dataSourceConfig.messages.validationFailed")})}finally{q(!1)}},Re=()=>{switch(x){case"prometheus":return e.jsxs(e.Fragment,{children:[e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.url"),name:["config","url"],rules:[{required:!0,message:s("entityScan:dataSourceConfig.fields.urlRequired")}],children:e.jsx(h,{placeholder:"http://prometheus.example.com:9090"})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.authType"),name:["config","authType"],children:e.jsxs(me,{defaultValue:"none",children:[e.jsx(ce,{value:"none",children:s("entityScan:dataSourceConfig.fields.authNone")}),e.jsx(ce,{value:"basic",children:s("entityScan:dataSourceConfig.fields.authBasic")}),e.jsx(ce,{value:"bearer",children:s("entityScan:dataSourceConfig.fields.authToken")})]})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.username"),name:["config","username"],children:e.jsx(h,{placeholder:s("entityScan:dataSourceConfig.fields.usernamePlaceholder")})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.password"),name:["config","password"],children:e.jsx(h.Password,{placeholder:s("entityScan:dataSourceConfig.fields.passwordPlaceholder")})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.timeout"),name:["config","timeout"],children:e.jsx(we,{min:1,max:300,defaultValue:30})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.maxSamples"),name:["config","maxSamples"],children:e.jsx(we,{min:1e3,max:1e6,defaultValue:5e4})})]});case"grafana":return e.jsxs(e.Fragment,{children:[e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.url"),name:["config","url"],rules:[{required:!0,message:s("entityScan:dataSourceConfig.fields.urlRequired")}],children:e.jsx(h,{placeholder:"http://grafana.example.com:3000"})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.apiKey"),name:["config","apiKey"],rules:[{required:!0,message:s("entityScan:dataSourceConfig.fields.apiKeyRequired")}],children:e.jsx(h.Password,{placeholder:"Grafana API Key"})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.orgId"),name:["config","orgId"],children:e.jsx(we,{min:1,defaultValue:1})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.includeDashboards"),name:["config","includeDashboards"],valuePropName:"checked",children:e.jsx(ye,{defaultChecked:!0})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.includeDataSources"),name:["config","includeDataSources"],valuePropName:"checked",children:e.jsx(ye,{defaultChecked:!0})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.includeAlerts"),name:["config","includeAlerts"],valuePropName:"checked",children:e.jsx(ye,{})})]});case"elasticsearch":return e.jsxs(e.Fragment,{children:[e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.cluster"),name:["config","hosts"],rules:[{required:!0,message:s("entityScan:dataSourceConfig.fields.clusterRequired")}],children:e.jsx(Ie,{placeholder:`http://es1.example.com:9200
http://es2.example.com:9200`,rows:3})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.username"),name:["config","username"],children:e.jsx(h,{placeholder:"elastic"})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.password"),name:["config","password"],children:e.jsx(h.Password,{placeholder:s("entityScan:dataSourceConfig.fields.passwordPlaceholder")})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.indices"),name:["config","indices"],children:e.jsx(Ie,{placeholder:`app-logs-*
access-logs-*
error-logs-*`,rows:3})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.version"),name:["config","version"],children:e.jsxs(me,{defaultValue:"8.x",children:[e.jsx(ce,{value:"7.x",children:"7.x"}),e.jsx(ce,{value:"8.x",children:"8.x"})]})})]});case"influxdb":return e.jsxs(e.Fragment,{children:[e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.url"),name:["config","url"],rules:[{required:!0,message:s("entityScan:dataSourceConfig.fields.urlRequired")}],children:e.jsx(h,{placeholder:"http://influxdb.example.com:8086"})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.database"),name:["config","database"],rules:[{required:!0,message:s("entityScan:dataSourceConfig.fields.databaseRequired")}],children:e.jsx(h,{placeholder:"metrics"})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.username"),name:["config","username"],children:e.jsx(h,{placeholder:s("entityScan:dataSourceConfig.fields.usernamePlaceholder")})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.password"),name:["config","password"],children:e.jsx(h.Password,{placeholder:s("entityScan:dataSourceConfig.fields.passwordPlaceholder")})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.retention"),name:["config","retention"],children:e.jsx(h,{placeholder:"30d"})})]});default:return e.jsx(de,{message:s("entityScan:dataSourceConfig.configForm"),description:s("entityScan:dataSourceConfig.selectTypeDescription"),type:"info",showIcon:!0})}};return e.jsx(oe,{title:s("entityScan:dataSourceConfig.title"),open:t,onCancel:i,onOk:()=>k.submit(),okText:s("common:save"),cancelText:s("common:cancel"),width:800,destroyOnClose:!0,children:e.jsx(d,{form:k,layout:"vertical",onFinish:r,initialValues:o,children:e.jsx(Je,{activeKey:x,onChange:D,children:be.map(u=>e.jsxs(Vt,{tab:e.jsxs(Ce,{children:[u.icon,u.name]}),children:[e.jsx(xe,{size:"small",style:{marginBottom:16},children:e.jsxs(Ce,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.icon,e.jsx(Et,{level:5,style:{margin:0},children:u.name})]}),e.jsx(Ot,{style:{margin:0,color:"#666"},children:u.description}),e.jsxs("div",{children:[e.jsxs(Kt,{strong:!0,children:[s("entityScan:dataSourceConfig.mainFeatures"),": "]}),u.features.map(I=>e.jsx(Ye,{color:"blue",style:{margin:"2px"},children:I},I))]})]})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.name"),name:"name",rules:[{required:!0,message:s("entityScan:dataSourceConfig.fields.nameRequired")}],children:e.jsx(h,{placeholder:`${u.name}${s("entityScan:dataSourceConfig.fields.namePlaceholder")}`})}),e.jsx(d.Item,{label:s("entityScan:dataSourceConfig.fields.description"),name:"description",children:e.jsx(Ie,{placeholder:`${u.name}${s("entityScan:dataSourceConfig.fields.descriptionPlaceholder")}`,rows:2})}),e.jsx(Fe,{}),Re(),e.jsx(Fe,{}),e.jsxs(Ce,{children:[e.jsx(C,{icon:e.jsx(Ct,{}),onClick:ue,loading:Se,children:s("entityScan:dataSourceConfig.testConnection")}),A&&e.jsx(de,{message:A.message,type:A.success?"success":"error",showIcon:!0,icon:A.success?e.jsx(Xe,{}):e.jsx(Pe,{}),style:{flex:1}})]})]},u.key))})})})},{Title:Ne,Text:w,Paragraph:Lt}=Ze,{Option:ja}=me,{TextArea:ka}=h,Gt=g.div`
  padding: 24px;
`,Nt=g.div`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 24px;
`,Wt=g.div`
  flex: 1;
`,_t=g.div`
  display: flex;
  gap: 8px;
  align-items: center;
`,Ht=g(xe)`
  margin-bottom: 24px;
  border-radius: 8px;
  background: ${t=>t.$isDark?"linear-gradient(145deg, #1a1a1a, #141414)":"linear-gradient(145deg, #ffffff, #fafafa)"};
  border: 1px solid ${t=>t.$isDark?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)"};
  
  .ant-card-body {
    padding: 20px;
  }
`,P=g.div`
  text-align: center;
  padding: 16px;
  border-radius: 8px;
  background: ${t=>t.$isDark?"rgba(255, 255, 255, 0.03)":"rgba(0, 0, 0, 0.02)"};
  border: 1px solid ${t=>t.$isDark?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.04)"};
  transition: all 0.3s ease;
  
  &:hover {
    background: ${t=>t.$isDark?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.04)"};
    transform: translateY(-2px);
  }
`,R=g.div`
  font-size: 28px;
  font-weight: bold;
  margin-bottom: 8px;
  color: ${t=>t.color||"#1890ff"};
`,z=g.div`
  font-size: 14px;
  color: ${t=>t.$isDark?"rgba(255, 255, 255, 0.65)":"rgba(0, 0, 0, 0.65)"};
  font-weight: 500;
`,We=g(xe)`
  margin-bottom: 24px;
  border-radius: 8px;
  box-shadow: ${t=>t.$isDark?"0 2px 8px rgba(255, 255, 255, 0.05)":"0 2px 8px rgba(0, 0, 0, 0.06)"};
  
  .ant-card-head {
    border-bottom: 1px solid ${t=>t.$isDark?"#303030":"#f0f0f0"};
  }
`,Qt=g(xe)`
  height: 100%;
  transition: all 0.3s ease;
  cursor: pointer;
  border-radius: 8px;
  background: ${t=>t.$isDark?"linear-gradient(145deg, #1a1a1a, #141414)":"linear-gradient(145deg, #ffffff, #fafafa)"};
  border: 1px solid ${t=>t.$isDark?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)"};
  box-shadow: ${t=>t.$isDark?"0 2px 8px rgba(0, 0, 0, 0.4), 0 1px 2px rgba(255, 255, 255, 0.05)":"0 2px 8px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.02)"};
  
  &:hover {
    transform: translateY(-3px);
    background: ${t=>t.$isDark?"linear-gradient(145deg, #1f1f1f, #1a1a1a)":"linear-gradient(145deg, #ffffff, #f8f9fa)"};
    border-color: ${t=>t.$isDark?"rgba(255, 255, 255, 0.15)":"rgba(24, 144, 255, 0.3)"};
    box-shadow: ${t=>t.$isDark?"0 6px 20px rgba(0, 0, 0, 0.6), 0 3px 6px rgba(255, 255, 255, 0.08)":"0 6px 20px rgba(24, 144, 255, 0.15), 0 3px 6px rgba(0, 0, 0, 0.08)"};
  }
  
  .ant-card-body {
    padding: 20px;
    background: transparent;
  }
`,Jt=g.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
`,Zt=g.div`
  display: flex;
  align-items: center;
  gap: 12px;
`,Yt=g.div`
  width: 40px;
  height: 40px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  color: white;
  position: relative;
  background: ${t=>{switch(t.type){case"mysql":return"linear-gradient(135deg, #4479A1, #336791)";case"postgresql":return"linear-gradient(135deg, #336791, #2E5984)";case"mongodb":return"linear-gradient(135deg, #47A248, #3E8E41)";case"redis":return"linear-gradient(135deg, #DC382D, #B92C20)";case"elasticsearch":return"linear-gradient(135deg, #005571, #004A5C)";case"api":return"linear-gradient(135deg, #1890ff, #096dd9)";case"file":return"linear-gradient(135deg, #722ed1, #531dab)";default:return"linear-gradient(135deg, #8c8c8c, #595959)"}}};
  box-shadow: ${t=>t.$isDark?"0 2px 8px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)":"0 2px 8px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2)"};
  
  &::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: inherit;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), transparent);
    pointer-events: none;
  }
`,Xt=g.div`
  display: flex;
  flex-direction: column;
  gap: 8px;
`,ea=g.div`
  display: flex;
  flex-direction: column;
  gap: 8px;
  
  .scan-btn-row {
    display: flex;
    width: 100%;
  }
  
  .action-btn-row {
    display: flex;
    justify-content: space-between;
    gap: 4px;
    
    .ant-btn {
      flex: 1;
      font-size: 12px;
      height: 26px;
      padding: 0 6px;
      border-radius: 4px;
    }
  }
`,ta=g.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 6px 12px;
  margin: 2px 0;
  border-radius: 4px;
  font-size: 12px;
  background: ${t=>t.$isDark?"rgba(255, 255, 255, 0.03)":"rgba(0, 0, 0, 0.02)"};
  border: 1px solid ${t=>t.$isDark?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.04)"};
  transition: all 0.2s ease;
  
  &:hover {
    background: ${t=>t.$isDark?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.04)"};
  }
`,aa=g.span`
  font-weight: 500;
  color: ${t=>t.$isDark?"rgba(255, 255, 255, 0.65)":"rgba(0, 0, 0, 0.65)"};
`,sa=g.span`
  color: ${t=>t.$isDark?"rgba(255, 255, 255, 0.85)":"rgba(0, 0, 0, 0.85)"};
  font-weight: 500;
`,na=g(Ye)`
  font-weight: bold;
  
  ${t=>{switch(t.status){case"success":return"background: #f6ffed; border-color: #b7eb8f; color: #52c41a;";case"error":return"background: #fff2f0; border-color: #ffccc7; color: #ff4d4f;";case"warning":return"background: #fffbe6; border-color: #ffe58f; color: #faad14;";case"processing":return"background: #e6f7ff; border-color: #91d5ff; color: #1890ff;";default:return"background: #fafafa; border-color: #d9d9d9; color: #595959;"}}}
`,va=()=>{const{t}=_e(["entityScan","common"]),i=wt(),{currentTheme:r}=Rt(a=>a.theme),o=r==="dark",[s]=d.useForm(),[k,x]=y.useState([]),[D,A]=y.useState([]),[b,Se]=y.useState([]),[q,be]=y.useState(""),[ue,Re]=y.useState(!1),[u,I]=y.useState(null),[je,et]=y.useState(!1),[tt,ke]=y.useState(!1),[at,ve]=y.useState(!1),[T,st]=y.useState(""),[fe,nt]=y.useState("all"),[ge,it]=y.useState("all"),F=()=>{const a=k.length,n=k.filter(p=>p.status==="connected").length,l=b.length,c=b.filter(p=>p.selected).length,f=D.filter(p=>p.status==="completed").length,j=D.filter(p=>p.status==="running").length;return{totalDataSources:a,connectedDataSources:n,totalEntities:l,selectedEntities:c,completedScans:f,runningScans:j}};y.useEffect(()=>{pe()},[]);const pe=async()=>{try{const a=await Bt.getDataSources();x(a)}catch(a){console.error("Failed to load data sources:",a),x([])}},rt=(a,n)=>{switch(a){case"database":return e.jsx($e,{});case"api":return e.jsx(Pt,{});case"cloud":return e.jsx(Ft,{});case"monitoring":switch(n){case"prometheus":return e.jsx(he,{style:{color:"#e6522c"}});case"grafana":return e.jsx(He,{style:{color:"#f46800"}});case"elasticsearch":return e.jsx(Qe,{style:{color:"#005571"}});case"jaeger":return e.jsx(le,{style:{color:"#60d0e4"}});case"zabbix":return e.jsx(Te,{style:{color:"#d40000"}});case"datadog":return e.jsx(he,{style:{color:"#632ca6"}});default:return e.jsx(Te,{})}case"metrics":switch(n){case"influxdb":return e.jsx(le,{style:{color:"#22adf6"}});default:return e.jsx(le,{})}default:return e.jsx($e,{})}},ct=a=>{const n={connected:{color:"success",text:t("entityScan:dataSources.connected")},disconnected:{color:"default",text:t("entityScan:dataSources.disconnected")},error:{color:"error",text:t("entityScan:dataSources.error")},pending:{color:"default",text:t("entityScan:status.pending")},running:{color:"processing",text:t("entityScan:status.running")},completed:{color:"success",text:t("entityScan:status.completed")},failed:{color:"error",text:t("entityScan:status.failed")},paused:{color:"warning",text:t("entityScan:status.paused")}},l=n[a]||n.disconnected;return e.jsx(na,{status:l.color,children:l.text})},ot=()=>({database:{name:t("entityScan:dataSources.types.database"),color:"#1890ff"},api:{name:t("entityScan:dataSources.types.api"),color:"#52c41a"},cloud:{name:t("entityScan:dataSources.types.cloud"),color:"#722ed1"},monitoring:{name:t("entityScan:dataSources.types.monitoring"),color:"#fa8c16"},metrics:{name:t("entityScan:dataSources.types.metrics"),color:"#13c2c2"},file:{name:t("entityScan:dataSources.types.file"),color:"#eb2f96"}}),lt=()=>({mysql:"MySQL",postgresql:"PostgreSQL",mongodb:"MongoDB",redis:"Redis",elasticsearch:"Elasticsearch",prometheus:"Prometheus",grafana:"Grafana",jaeger:"Jaeger",zabbix:"Zabbix",datadog:"Datadog",influxdb:"InfluxDB"}),ze=a=>{const n={connected:{text:t("entityScan:dataSources.connected"),color:"success",icon:e.jsx(Xe,{})},disconnected:{text:t("entityScan:dataSources.disconnected"),color:"error",icon:e.jsx(Pe,{})},connecting:{text:t("entityScan:dataSources.connecting"),color:"processing",icon:e.jsx(De,{spin:!0})},error:{text:t("entityScan:dataSources.error"),color:"error",icon:e.jsx(Pe,{})}};return n[a]||n.disconnected},Ae=()=>k.filter(a=>{const n=!T||a.name.toLowerCase().includes(T.toLowerCase())||a.description.toLowerCase().includes(T.toLowerCase())||a.host.toLowerCase().includes(T.toLowerCase()),l=fe==="all"||a.type===fe,c=ge==="all"||a.status===ge;return n&&l&&c}),dt=()=>{const a=Ae(),n=ot(),l=lt();return a.map(c=>{const f=ze(c.status),j=n[c.type];return e.jsx(m,{xs:24,sm:12,lg:8,children:e.jsxs(Qt,{$isDark:o,children:[e.jsxs(Jt,{children:[e.jsxs(Zt,{children:[e.jsx(Yt,{type:c.subType||c.type,$isDark:o,children:rt(c.type,c.subType)}),e.jsxs("div",{children:[e.jsx(Ne,{level:5,style:{margin:0,fontSize:"16px"},children:c.name}),e.jsx(w,{type:"secondary",style:{fontSize:"12px"},children:l[c.subType]||(j==null?void 0:j.name)})]})]}),e.jsx(Ge,{status:f.color,text:f.text})]}),e.jsx(Xt,{children:ut(c).map((p,$)=>e.jsxs(ta,{$isDark:o,children:[e.jsxs(aa,{$isDark:o,children:[p.label,":"]}),e.jsx(sa,{$isDark:o,children:p.value})]},$))}),e.jsx(Fe,{style:{margin:"12px 0"}}),e.jsxs(ea,{children:[e.jsx("div",{className:"scan-btn-row",children:e.jsx(C,{type:"primary",size:"small",icon:e.jsx(Ve,{}),onClick:()=>mt(c),disabled:c.status!=="connected",loading:ue&&q===c.id,block:!0,children:ue&&q===c.id?t("entityScan:status.running"):t("entityScan:scanConfig.startScan")})}),e.jsxs("div",{className:"action-btn-row",children:[e.jsx(C,{type:"text",size:"small",icon:e.jsx($t,{}),onClick:()=>pt(c),children:t("common:view")}),e.jsx(C,{type:"text",size:"small",icon:e.jsx(It,{}),onClick:()=>yt(),children:t("common:edit")}),e.jsx(C,{type:"text",size:"small",icon:e.jsx(De,{}),onClick:()=>ht(c),loading:c.status==="connecting",children:t("entityScan:dataSources.testConnection")}),e.jsx(C,{type:"text",size:"small",danger:!0,icon:e.jsx(Tt,{}),onClick:()=>xt(c),children:t("common:delete")})]})]})]})},c.id)})},ut=a=>{var l,c,f,j,p,$,M,B,E,K,O,V,U,L,G,N,W,_,H,Q,J,Z,Y,X,ee,te,ae,se,ne,ie;const n=[];switch(a.type){case"database":n.push({label:t("entityScan:fields.host"),value:`${(l=a.config)==null?void 0:l.host}:${(c=a.config)==null?void 0:c.port}`},{label:t("entityScan:fields.database"),value:((f=a.config)==null?void 0:f.database)||"-"});break;case"api":n.push({label:t("entityScan:fields.baseUrl"),value:((j=a.config)==null?void 0:j.baseUrl)||"-"},{label:t("entityScan:fields.endpoints"),value:($=(p=a.config)==null?void 0:p.endpoints)!=null&&$.length?t("entityScan:units.endpoints",{count:a.config.endpoints.length}):"-"});break;case"cloud":n.push({label:t("entityScan:fields.endpoint"),value:((M=a.config)==null?void 0:M.endpoint)||"-"},{label:t("entityScan:fields.bucket"),value:((B=a.config)==null?void 0:B.bucket)||"-"});break;case"monitoring":switch(a.subType){case"prometheus":n.push({label:t("entityScan:fields.url"),value:((E=a.config)==null?void 0:E.url)||"-"},{label:t("entityScan:fields.maxSamples"),value:((O=(K=a.config)==null?void 0:K.maxSamples)==null?void 0:O.toString())||"-"});break;case"grafana":n.push({label:t("entityScan:fields.url"),value:((V=a.config)==null?void 0:V.url)||"-"},{label:t("entityScan:fields.orgId"),value:((L=(U=a.config)==null?void 0:U.orgId)==null?void 0:L.toString())||"-"});break;case"elasticsearch":n.push({label:t("entityScan:fields.hosts"),value:(N=(G=a.config)==null?void 0:G.hosts)!=null&&N.length?t("entityScan:units.nodes",{count:a.config.hosts.length}):"-"},{label:t("entityScan:fields.indices"),value:(_=(W=a.config)==null?void 0:W.indices)!=null&&_.length?t("entityScan:units.indices",{count:a.config.indices.length}):"-"});break;case"jaeger":n.push({label:t("entityScan:fields.queryUrl"),value:((H=a.config)==null?void 0:H.queryUrl)||"-"},{label:t("entityScan:fields.services"),value:(J=(Q=a.config)==null?void 0:Q.services)!=null&&J.length?t("entityScan:units.services",{count:a.config.services.length}):"-"});break;case"zabbix":n.push({label:t("entityScan:fields.url"),value:((Z=a.config)==null?void 0:Z.url)||"-"},{label:t("entityScan:fields.apiVersion"),value:((Y=a.config)==null?void 0:Y.apiVersion)||"-"});break;case"datadog":n.push({label:t("entityScan:fields.site"),value:((X=a.config)==null?void 0:X.site)||"-"},{label:t("entityScan:fields.environment"),value:((ee=a.config)==null?void 0:ee.env)||"-"});break;default:n.push({label:t("entityScan:fields.url"),value:((te=a.config)==null?void 0:te.url)||"-"})}break;case"metrics":switch(a.subType){case"influxdb":n.push({label:t("entityScan:fields.url"),value:((ae=a.config)==null?void 0:ae.url)||"-"},{label:t("entityScan:fields.database"),value:((se=a.config)==null?void 0:se.database)||"-"});break}break;case"file":n.push({label:t("entityScan:fields.path"),value:((ne=a.config)==null?void 0:ne.path)||"-"},{label:t("entityScan:fields.format"),value:((ie=a.config)==null?void 0:ie.format)||"-"});break;default:n.push({label:t("entityScan:fields.description"),value:a.description||"-"})}return n.push({label:t("entityScan:dataSources.lastScan"),value:a.lastScan||t("entityScan:status.neverScanned")},{label:t("entityScan:dataSources.entityCount"),value:t("entityScan:units.entities",{count:a.entityCount||0})}),n},ft=a=>{var c,f,j,p,$,M,B,E,K,O,V,U,L,G,N,W,_,H,Q,J,Z,Y,X,ee,te,ae,se,ne,ie,Me,Be,Ee,Ke,Oe;const n=[{key:"name",label:t("entityScan:fields.name"),value:a.name},{key:"type",label:t("entityScan:fields.type"),value:a.type},{key:"subType",label:t("entityScan:fields.subType"),value:a.subType},{key:"status",label:t("entityScan:fields.status"),value:a.status,isStatus:!0},{key:"description",label:t("entityScan:fields.description"),value:a.description}],l=[];switch(a.type){case"database":l.push({key:"host",label:t("entityScan:fields.host"),value:`${(c=a.config)==null?void 0:c.host}:${(f=a.config)==null?void 0:f.port}`},{key:"database",label:t("entityScan:fields.database"),value:((j=a.config)==null?void 0:j.database)||"-"},{key:"username",label:t("entityScan:fields.username"),value:(p=a.config)==null?void 0:p.username});break;case"api":l.push({key:"baseUrl",label:t("entityScan:fields.baseUrl"),value:($=a.config)==null?void 0:$.baseUrl},{key:"endpoints",label:t("entityScan:fields.endpoints"),value:(M=a.config)==null?void 0:M.endpoints,isArray:!0},{key:"apiKey",label:t("entityScan:fields.apiKey"),value:(B=a.config)!=null&&B.apiKey?"***hidden***":"-"});break;case"cloud":l.push({key:"endpoint",label:t("entityScan:fields.endpoint"),value:(E=a.config)==null?void 0:E.endpoint},{key:"bucket",label:t("entityScan:fields.bucket"),value:(K=a.config)==null?void 0:K.bucket},{key:"accessKeyId",label:t("entityScan:fields.accessKeyId"),value:(O=a.config)!=null&&O.accessKeyId?"***hidden***":"-"});break;case"monitoring":switch(a.subType){case"prometheus":l.push({key:"url",label:t("entityScan:fields.url"),value:(V=a.config)==null?void 0:V.url},{key:"timeout",label:t("entityScan:fields.timeout"),value:`${((U=a.config)==null?void 0:U.timeout)||0}ms`},{key:"maxSamples",label:t("entityScan:fields.maxSamples"),value:(L=a.config)==null?void 0:L.maxSamples});break;case"grafana":l.push({key:"url",label:t("entityScan:fields.url"),value:(G=a.config)==null?void 0:G.url},{key:"orgId",label:t("entityScan:fields.orgId"),value:(N=a.config)==null?void 0:N.orgId},{key:"includeDashboards",label:t("entityScan:fields.includeDashboards"),value:(W=a.config)!=null&&W.includeDashboards?t("common:yes"):t("common:no")});break;case"elasticsearch":l.push({key:"hosts",label:t("entityScan:fields.hosts"),value:(_=a.config)==null?void 0:_.hosts,isArray:!0},{key:"indices",label:t("entityScan:fields.indices"),value:(H=a.config)==null?void 0:H.indices,isArray:!0},{key:"version",label:t("entityScan:fields.version"),value:(Q=a.config)==null?void 0:Q.version});break;case"jaeger":l.push({key:"queryUrl",label:t("entityScan:fields.queryUrl"),value:(J=a.config)==null?void 0:J.queryUrl},{key:"services",label:t("entityScan:fields.services"),value:(Z=a.config)==null?void 0:Z.services,isArray:!0},{key:"lookback",label:t("entityScan:fields.lookback"),value:(Y=a.config)==null?void 0:Y.lookback});break;case"zabbix":l.push({key:"url",label:t("entityScan:fields.url"),value:(X=a.config)==null?void 0:X.url},{key:"apiVersion",label:t("entityScan:fields.apiVersion"),value:(ee=a.config)==null?void 0:ee.apiVersion},{key:"hostGroups",label:t("entityScan:fields.hostGroups"),value:(te=a.config)==null?void 0:te.hostGroups,isArray:!0});break;case"datadog":l.push({key:"site",label:t("entityScan:fields.site"),value:(ae=a.config)==null?void 0:ae.site},{key:"services",label:t("entityScan:fields.services"),value:(se=a.config)==null?void 0:se.services,isArray:!0},{key:"env",label:t("entityScan:fields.environment"),value:(ne=a.config)==null?void 0:ne.env});break}break;case"metrics":switch(a.subType){case"influxdb":l.push({key:"url",label:t("entityScan:fields.url"),value:(ie=a.config)==null?void 0:ie.url},{key:"database",label:t("entityScan:fields.database"),value:(Me=a.config)==null?void 0:Me.database},{key:"retention",label:t("entityScan:fields.retention"),value:(Be=a.config)==null?void 0:Be.retention});break}break;case"file":l.push({key:"path",label:t("entityScan:fields.path"),value:(Ee=a.config)==null?void 0:Ee.path},{key:"format",label:t("entityScan:fields.format"),value:(Ke=a.config)==null?void 0:Ke.format},{key:"encoding",label:t("entityScan:fields.encoding"),value:((Oe=a.config)==null?void 0:Oe.encoding)||"UTF-8"});break}return[...n,...l]},gt=a=>{if(a.isStatus){const n=ze(a.value);return e.jsx(Ge,{status:n.color,text:n.text})}return a.isArray&&Array.isArray(a.value)?a.value.join(", "):a.value||"-"},pt=a=>{const n=ft(a);oe.info({title:`${t("entityScan:dataSources.details")} - ${a.name}`,width:600,content:e.jsx("div",{style:{marginTop:16},children:e.jsx(re,{gutter:[16,8],children:n.map(l=>e.jsxs(vt.Fragment,{children:[e.jsx(m,{span:8,children:e.jsxs("strong",{children:[l.label,":"]})}),e.jsx(m,{span:16,children:gt(l)})]},l.key))})})})},yt=a=>{v.info("编辑数据源功能开发中...")},ht=async a=>{try{x(c=>c.map(f=>f.id===a.id?{...f,status:"connecting"}:f)),await new Promise(c=>setTimeout(c,2e3));const n=Math.random()>.3,l=n?"connected":"error";x(c=>c.map(f=>f.id===a.id?{...f,status:l,lastConnected:n?new Date().toLocaleString():f.lastConnected}:f)),v[n?"success":"error"](t(n?"entityScan:messages.connectionTestSuccess":"entityScan:messages.connectionTestFailed"))}catch{x(l=>l.map(c=>c.id===a.id?{...c,status:"error"}:c)),v.error(t("entityScan:messages.connectionTestFailed"))}},mt=a=>{if(a.status!=="connected"){v.warning(t("entityScan:messages.ensureConnectionFirst"));return}i(`/system-settings/entity-scan/${a.id}`)},xt=a=>{oe.confirm({title:t("common:confirmDelete"),content:t("entityScan:messages.confirmDeleteDataSource",{name:a.name}),okText:t("common:delete"),okType:"danger",cancelText:t("common:cancel"),onOk:()=>{x(n=>n.filter(l=>l.id!==a.id)),v.success(t("entityScan:messages.dataSourceDeleted"))}})},St=async()=>{try{v.loading(t("entityScan:messages.refreshingDataSources"),1),await pe(),v.success(t("entityScan:messages.refreshSuccess"))}catch{v.error(t("entityScan:messages.refreshFailed"))}},bt=()=>{ve(!0)},jt=a=>{console.log("Saving data source config:",a),v.success(t("entityScan:messages.dataSourceCreated")),ve(!1),pe()},kt=()=>{ve(!1)},qe=[{title:"选择",dataIndex:"selected",key:"selected",render:(a,n)=>e.jsx(ye,{checked:a,onChange:l=>{Se(c=>c.map(f=>f.id===n.id?{...f,selected:l}:f))}})},{title:"实体名称",dataIndex:"name",key:"name",render:(a,n)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:a}),e.jsxs(w,{type:"secondary",style:{fontSize:"12px"},children:["来源: ",n.source]})]})},{title:"实体类型",dataIndex:"type",key:"type"},{title:"置信度",dataIndex:"confidence",key:"confidence",render:a=>e.jsx("div",{children:e.jsx(Ue,{percent:Math.round(a*100),size:"small",status:a>.9?"success":a>.7?"normal":"exception"})})},{title:"属性数量",dataIndex:"attributes",key:"attributes",render:a=>Object.keys(a).length}];return e.jsxs(Gt,{children:[e.jsxs(Nt,{children:[e.jsxs(Wt,{children:[e.jsxs(Ne,{level:2,style:{margin:0},children:[e.jsx(Ve,{})," ",t("entityScan:title","实体扫描")]}),e.jsx(Lt,{style:{margin:"8px 0 0 0",color:o?"rgba(255, 255, 255, 0.65)":"rgba(0, 0, 0, 0.65)"},children:t("entityScan:description","从外部数据源扫描和生成实体定义，支持数据库、API、云服务等多种数据源类型。")})]}),e.jsxs(_t,{children:[e.jsx(C,{icon:e.jsx(De,{}),onClick:St,title:t("entityScan:dataSources.refreshDataSources"),children:t("common:refresh")}),e.jsx(C,{type:"primary",icon:e.jsx(Dt,{}),onClick:bt,children:t("entityScan:dataSources.addDataSource")})]})]}),e.jsx(Ht,{$isDark:o,title:t("entityScan:stats.title"),children:e.jsxs(re,{gutter:[16,16],children:[e.jsx(m,{xs:12,sm:8,lg:4,children:e.jsxs(P,{$isDark:o,children:[e.jsx(R,{color:"#1890ff",children:F().totalDataSources}),e.jsx(z,{$isDark:o,children:t("entityScan:stats.totalDataSources")})]})}),e.jsx(m,{xs:12,sm:8,lg:4,children:e.jsxs(P,{$isDark:o,children:[e.jsx(R,{color:"#52c41a",children:F().connectedDataSources}),e.jsx(z,{$isDark:o,children:t("entityScan:stats.connectedSources")})]})}),e.jsx(m,{xs:12,sm:8,lg:4,children:e.jsxs(P,{$isDark:o,children:[e.jsx(R,{color:"#722ed1",children:F().totalEntities}),e.jsx(z,{$isDark:o,children:t("entityScan:stats.totalEntities")})]})}),e.jsx(m,{xs:12,sm:8,lg:4,children:e.jsxs(P,{$isDark:o,children:[e.jsx(R,{color:"#fa8c16",children:F().selectedEntities}),e.jsx(z,{$isDark:o,children:t("entityScan:stats.selectedEntities")})]})}),e.jsx(m,{xs:12,sm:8,lg:4,children:e.jsxs(P,{$isDark:o,children:[e.jsx(R,{color:"#13c2c2",children:F().completedScans}),e.jsx(z,{$isDark:o,children:t("entityScan:stats.completedScans")})]})}),e.jsx(m,{xs:12,sm:8,lg:4,children:e.jsxs(P,{$isDark:o,children:[e.jsx(R,{color:"#eb2f96",children:F().runningScans}),e.jsx(z,{$isDark:o,children:t("entityScan:stats.runningScans")})]})})]})}),e.jsx(At,{searchValue:T,onSearchChange:st,searchPlaceholder:t("entityScan:dataSources.searchPlaceholder"),filters:[{key:"type",value:fe,onChange:nt,placeholder:t("entityScan:dataSources.filterByType"),width:120,options:[{value:"all",label:t("entityScan:dataSources.allTypes")},{value:"database",label:t("entityScan:dataSources.types.database")},{value:"api",label:t("entityScan:dataSources.types.api")},{value:"cloud",label:t("entityScan:dataSources.types.cloud")},{value:"monitoring",label:t("entityScan:dataSources.types.monitoring")},{value:"metrics",label:t("entityScan:dataSources.types.metrics")},{value:"file",label:t("entityScan:dataSources.types.file")}]},{key:"status",value:ge,onChange:it,placeholder:t("entityScan:dataSources.filterByStatus"),width:100,options:[{value:"all",label:t("entityScan:dataSources.allStatuses")},{value:"connected",label:t("entityScan:dataSources.connected")},{value:"disconnected",label:t("entityScan:dataSources.disconnected")},{value:"connecting",label:t("entityScan:dataSources.connecting")},{value:"error",label:t("entityScan:dataSources.error")}]}],onRefresh:()=>pe(),style:{marginBottom:24}}),e.jsx(re,{gutter:[16,16],style:{marginBottom:24},children:dt()}),Ae().length===0&&e.jsxs("div",{style:{textAlign:"center",padding:"40px 0",color:o?"rgba(255, 255, 255, 0.45)":"rgba(0, 0, 0, 0.45)",marginBottom:24},children:[e.jsx($e,{style:{fontSize:"48px",marginBottom:"16px"}}),e.jsx("div",{children:t("entityScan:dataSources.noDataSources")}),e.jsx("div",{style:{fontSize:"12px",marginTop:"8px"},children:t(T||fe!=="all"||ge!=="all"?"entityScan:dataSources.noMatchingDataSources":"entityScan:dataSources.configureDataSourcesFirst")})]}),u&&e.jsx(We,{$isDark:o,title:"扫描进度",children:e.jsxs(re,{gutter:16,children:[e.jsxs(m,{span:12,children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(w,{strong:!0,children:u.name}),ct(u.status)]}),e.jsx(Ue,{percent:u.progress,status:u.status==="failed"?"exception":"active"})]}),e.jsxs(re,{gutter:16,children:[e.jsx(m,{span:8,children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#1890ff"},children:u.scannedCount}),e.jsx(w,{type:"secondary",children:t("entityScan:progress.scanned")})]})}),e.jsx(m,{span:8,children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#52c41a"},children:u.generatedCount}),e.jsx(w,{type:"secondary",children:t("entityScan:progress.generated")})]})}),e.jsx(m,{span:8,children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff4d4f"},children:u.errorCount}),e.jsx(w,{type:"secondary",children:"错误"})]})})]})]}),e.jsx(m,{span:12,children:e.jsxs("div",{style:{height:"200px",overflow:"auto",background:o?"#1f1f1f":"#fafafa",padding:"12px",borderRadius:"6px"},children:[e.jsx(w,{strong:!0,children:"扫描日志:"}),u.logs.map((a,n)=>e.jsxs("div",{style:{fontSize:"12px",marginTop:"4px"},children:[e.jsxs(w,{type:"secondary",children:["[",new Date().toLocaleTimeString(),"]"]})," ",a]},n))]})})]})}),b.length>0&&e.jsxs(We,{$isDark:o,title:"扫描结果",children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(de,{message:t("entityScan:results.scanCompleted",{total:b.length,selected:b.filter(a=>a.selected).length}),type:"success",showIcon:!0,action:e.jsx(C,{size:"small",type:"primary",onClick:()=>ke(!0),children:"生成实体"})})}),e.jsx(Le,{dataSource:b,columns:qe,rowKey:"id",pagination:!1,size:"small"})]}),e.jsx(oe,{title:"数据源配置",open:je,onCancel:()=>et(!1),footer:null,width:600,children:e.jsx(de,{message:"数据源配置功能",description:"在这里可以配置数据源的连接参数、认证信息、扫描规则等。",type:"info",showIcon:!0})}),e.jsxs(oe,{title:t("entityScan:results.confirmGenerate"),open:tt,onCancel:()=>ke(!1),onOk:()=>{const a=b.filter(n=>n.selected).length;v.success(t("entityScan:messages.entitiesGenerated",{count:a})),ke(!1)},width:800,children:[e.jsx(de,{message:t("entityScan:results.willGenerate",{count:b.filter(a=>a.selected).length}),description:t("entityScan:results.generateDescription"),type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(Le,{dataSource:b.filter(a=>a.selected),columns:qe.filter(a=>a.key!=="selected"),rowKey:"id",pagination:!1,size:"small"})]}),e.jsx(Ut,{visible:at,onCancel:kt,onOk:jt})]})};export{va as default};

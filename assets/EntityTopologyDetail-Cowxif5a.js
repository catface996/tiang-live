import{j as e,u as Qe,d as O,a as He}from"./index-DWPu_TRF.js";import{T as _e,j as M,ae as ge,t as q,d as Xe,C as we,S as Se,ax as Pe,at as Ye,B as R,n as Me,$ as Je,y as Ue,o as $e,a8 as ke,f as ze,ab as Re,r as x,i as Ae,X as We,a7 as et,ba as tt,bb as nt,bc as st,bd as it,be as rt,bf as ot,aA as at,ai as H,ao as xe,J as lt,K as ct,az as dt,M as ye,l as Ne,bg as pt,b1 as U,ap as gt}from"./antd-DnS9M1TX.js";import{s as De,i as ht}from"./transform-CtUPqxAi.js";import{z as ut,d as mt}from"./zoom-DKpi6doi.js";import{s as xt,l as yt,m as ft,c as vt,a as jt}from"./manyBody-_p2vrwJ2.js";import"./vendor-DJG_os-6.js";const{Title:bt,Text:wt}=_e,At=({topologyData:C,onRefresh:F})=>{const V=()=>{};return e.jsx("div",{className:"topology-header",children:e.jsxs("div",{className:"header-content",children:[e.jsxs("div",{className:"header-left",children:[e.jsx(bt,{level:3,style:{margin:0},children:e.jsxs(M,{children:[e.jsx(ge,{}),C.name]})}),e.jsx("div",{className:"header-description",children:e.jsx(wt,{type:"secondary",children:C.description})}),e.jsx("div",{className:"header-tags",children:e.jsxs(M,{wrap:!0,children:[e.jsx(q,{color:"blue",children:C.type}),e.jsx(q,{color:"green",children:C.plane}),C.tags.map(s=>e.jsx(q,{children:s},s))]})})]}),e.jsx("div",{className:"header-right",children:e.jsxs(Xe,{gutter:16,children:[e.jsx(we,{span:6,children:e.jsx(Se,{title:"èŠ‚ç‚¹æ•°",value:C.stats.nodeCount,prefix:e.jsx(ge,{})})}),e.jsx(we,{span:6,children:e.jsx(Se,{title:"è¿æ¥æ•°",value:C.stats.linkCount,prefix:e.jsx(Pe,{})})}),e.jsx(we,{span:6,children:e.jsx(Se,{title:"å¥åº·åº¦",value:C.stats.healthScore,suffix:"%",prefix:e.jsx(Ye,{})})}),e.jsx(we,{span:6,children:e.jsxs(M,{direction:"vertical",children:[e.jsx(R,{icon:e.jsx(Me,{}),onClick:F,children:"åˆ·æ–°"}),e.jsx(R,{icon:e.jsx(Je,{}),onClick:V,children:"å¯¼å‡º"})]})})]})})]})})},{Text:fe}=_e,kt=({entities:C,dependencies:F,onDeleteEntity:V,onDeleteDependency:s,onAddEntity:T,onAddDependency:te,onAgentsClick:G})=>{const de=[{title:"åç§°",dataIndex:"name",key:"name",width:"50%",render:(A,c)=>e.jsxs(M,{children:[e.jsx(ge,{}),e.jsx(fe,{strong:!0,children:A})]})},{title:"ç±»å‹",dataIndex:"type",key:"type",width:"30%",render:A=>e.jsx("span",{children:A})},{title:"æ“ä½œ",key:"actions",width:"20%",render:(A,c)=>e.jsxs(M,{size:2,children:[e.jsx(R,{type:"text",size:"small",icon:e.jsx(ze,{}),onClick:()=>G(c),title:"æŸ¥çœ‹Agents"}),e.jsx(R,{type:"text",size:"small",danger:!0,icon:e.jsx(Re,{}),onClick:()=>V(c),title:"åˆ é™¤å®ä½“"})]})}],ne=[{title:"æºå®ä½“",dataIndex:"source",key:"source",width:"40%",render:A=>{const c=C.find(se=>se.id===A);return c?e.jsxs(M,{children:[e.jsx(ge,{}),e.jsx(fe,{strong:!0,children:c.name})]}):e.jsx(fe,{type:"secondary",children:A})}},{title:"ç›®æ ‡å®ä½“",dataIndex:"target",key:"target",width:"40%",render:A=>{const c=C.find(se=>se.id===A);return c?e.jsxs(M,{children:[e.jsx(ge,{}),e.jsx(fe,{strong:!0,children:c.name})]}):e.jsx(fe,{type:"secondary",children:A})}},{title:"æ“ä½œ",key:"actions",width:"20%",render:(A,c)=>e.jsx(R,{type:"text",size:"small",danger:!0,icon:e.jsx(Re,{}),onClick:()=>s(c),title:"åˆ é™¤ä¾èµ–å…³ç³»"})}];return e.jsx("div",{className:"content-left",children:e.jsx(Ue,{defaultActiveKey:"entities",className:"data-tabs",items:[{key:"entities",label:e.jsxs(M,{children:[e.jsx(ze,{}),"å®ä½“æ¸…å• (",C.length,")"]}),children:e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:16,textAlign:"right"},children:e.jsx(R,{type:"primary",size:"small",icon:e.jsx($e,{}),onClick:T,children:"é€‰æ‹©å®ä½“"})}),e.jsx(ke,{columns:de,dataSource:C,rowKey:"id",size:"small",pagination:!1,scroll:{y:"calc(100vh - 420px)"}})]})},{key:"dependencies",label:e.jsxs(M,{children:[e.jsx(Pe,{}),"ä¾èµ–å…³ç³» (",F.length,")"]}),children:e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:16,textAlign:"right"},children:e.jsx(R,{type:"primary",size:"small",icon:e.jsx($e,{}),onClick:te,children:"æ·»åŠ å…³ç³»"})}),e.jsx(ke,{columns:ne,dataSource:F,rowKey:"id",size:"small",pagination:!1,scroll:{y:"calc(100vh - 420px)"}})]})}]})})},It=[{id:"business_plane",name:"ä¸šåŠ¡åº”ç”¨å¹³é¢",level:1,color:"#e6f7ff",borderColor:"#1890ff",description:"ä¸šåŠ¡ç³»ç»Ÿå’Œåº”ç”¨æœåŠ¡å±‚",bounds:{minLevel:1,maxLevel:2}},{id:"middleware_plane",name:"ä¸­é—´ä»¶å¹³é¢",level:2,color:"#f9f0ff",borderColor:"#722ed1",description:"ä¸­é—´ä»¶å’ŒåŸºç¡€æœåŠ¡å±‚",bounds:{minLevel:3,maxLevel:3}},{id:"infrastructure_plane",name:"åŸºç¡€è®¾æ–½å¹³é¢",level:3,color:"#f0f8f8",borderColor:"#5F9EA0",description:"åŸºç¡€è®¾æ–½å’Œèµ„æºå±‚",bounds:{minLevel:4,maxLevel:5}}],Ct=[{id:"web-app-1",name:"Webåº”ç”¨æœåŠ¡",type:"web_application",level:1,plane:"business_plane",description:"å‰ç«¯Webåº”ç”¨æœåŠ¡ï¼Œå¤„ç†ç”¨æˆ·ç•Œé¢äº¤äº’",status:"active",version:"v2.1.0",instances:3,port:8080,technology:"React + Node.js"},{id:"api-gateway-1",name:"APIç½‘å…³",type:"api_gateway",level:2,plane:"business_plane",description:"ç»Ÿä¸€APIå…¥å£ï¼Œå¤„ç†è·¯ç”±å’Œè®¤è¯",status:"active",version:"v1.8.2",instances:2,port:8e3,technology:"Kong Gateway"},{id:"user-service-1",name:"ç”¨æˆ·æœåŠ¡",type:"microservice",level:2,plane:"business_plane",description:"ç”¨æˆ·ç®¡ç†å’Œè®¤è¯æœåŠ¡",status:"active",version:"v3.0.1",instances:4,port:8001,technology:"Spring Boot"},{id:"order-service-1",name:"è®¢å•æœåŠ¡",type:"microservice",level:2,plane:"business_plane",description:"è®¢å•å¤„ç†å’Œç®¡ç†æœåŠ¡",status:"active",version:"v2.5.3",instances:6,port:8002,technology:"Spring Boot"},{id:"redis-cluster-1",name:"Redisç¼“å­˜é›†ç¾¤",type:"cache_cluster",level:3,plane:"middleware_plane",description:"åˆ†å¸ƒå¼ç¼“å­˜é›†ç¾¤ï¼Œæä¾›é«˜é€Ÿæ•°æ®è®¿é—®",status:"active",nodes:6,config:"3ä¸»3ä»",technology:"Redis Cluster",region:"åä¸œ-1"},{id:"mq-cluster-1",name:"æ¶ˆæ¯é˜Ÿåˆ—é›†ç¾¤",type:"message_queue",level:3,plane:"middleware_plane",description:"å¼‚æ­¥æ¶ˆæ¯å¤„ç†å’ŒæœåŠ¡è§£è€¦",status:"active",nodes:3,config:"3èŠ‚ç‚¹é›†ç¾¤",technology:"RabbitMQ",region:"åä¸œ-1"},{id:"mysql-cluster-1",name:"MySQLæ•°æ®åº“é›†ç¾¤",type:"database_cluster",level:4,plane:"infrastructure_plane",description:"ä¸»ä»æ•°æ®åº“é›†ç¾¤ï¼Œå­˜å‚¨æ ¸å¿ƒä¸šåŠ¡æ•°æ®",status:"active",nodes:3,config:"1ä¸»2ä»",technology:"MySQL 8.0",databases:["user_db","order_db","product_db"],region:"åä¸œ-1"},{id:"k8s-cluster-1",name:"Kubernetesé›†ç¾¤",type:"container_platform",level:5,plane:"infrastructure_plane",description:"å®¹å™¨ç¼–æ’å¹³å°ï¼Œç®¡ç†åº”ç”¨éƒ¨ç½²å’Œæ‰©ç¼©å®¹",status:"active",nodes:12,config:"3ä¸»9å·¥ä½œèŠ‚ç‚¹",technology:"Kubernetes 1.28",region:"åä¸œ-1"},{id:"monitoring-1",name:"ç›‘æ§å‘Šè­¦ç³»ç»Ÿ",type:"monitoring_system",level:3,plane:"middleware_plane",description:"ç³»ç»Ÿç›‘æ§ã€æ—¥å¿—æ”¶é›†å’Œå‘Šè­¦é€šçŸ¥",status:"active",instances:2,technology:"Prometheus + Grafana",metrics:{dailyVolume:1e6,successRate:99.9}}],St=[{source:"web-app-1",target:"api-gateway-1",type:"depends_on",strength:.9},{source:"api-gateway-1",target:"user-service-1",type:"routes_to",strength:.8},{source:"api-gateway-1",target:"order-service-1",type:"routes_to",strength:.8},{source:"user-service-1",target:"redis-cluster-1",type:"uses",strength:.7},{source:"order-service-1",target:"redis-cluster-1",type:"uses",strength:.7},{source:"user-service-1",target:"mysql-cluster-1",type:"stores_in",strength:.9},{source:"order-service-1",target:"mysql-cluster-1",type:"stores_in",strength:.9},{source:"order-service-1",target:"mq-cluster-1",type:"publishes_to",strength:.6},{source:"user-service-1",target:"mq-cluster-1",type:"subscribes_to",strength:.6},{source:"web-app-1",target:"k8s-cluster-1",type:"runs_on",strength:.8},{source:"api-gateway-1",target:"k8s-cluster-1",type:"runs_on",strength:.8},{source:"user-service-1",target:"k8s-cluster-1",type:"runs_on",strength:.8},{source:"order-service-1",target:"k8s-cluster-1",type:"runs_on",strength:.8},{source:"monitoring-1",target:"k8s-cluster-1",type:"monitors",strength:.5},{source:"monitoring-1",target:"mysql-cluster-1",type:"monitors",strength:.5},{source:"monitoring-1",target:"redis-cluster-1",type:"monitors",strength:.5}],Et={levels:[{level:1,name:"å‰ç«¯åº”ç”¨å±‚",color:"#1890ff"},{level:2,name:"ä¸šåŠ¡æœåŠ¡å±‚",color:"#52c41a"},{level:3,name:"ä¸­é—´ä»¶å±‚",color:"#722ed1"},{level:4,name:"æ•°æ®å­˜å‚¨å±‚",color:"#faad14"},{level:5,name:"åŸºç¡€è®¾æ–½å±‚",color:"#5F9EA0"}],relationTypes:[{type:"depends_on",description:"ä¾èµ–äº",color:"#1890ff",strokeWidth:2},{type:"routes_to",description:"è·¯ç”±åˆ°",color:"#52c41a",strokeWidth:2},{type:"uses",description:"ä½¿ç”¨",color:"#722ed1",strokeWidth:2},{type:"stores_in",description:"å­˜å‚¨åœ¨",color:"#faad14",strokeWidth:2},{type:"runs_on",description:"è¿è¡Œåœ¨",color:"#f5222d",strokeWidth:2},{type:"publishes_to",description:"å‘å¸ƒåˆ°",color:"#13c2c2",strokeWidth:1},{type:"subscribes_to",description:"è®¢é˜…",color:"#eb2f96",strokeWidth:1},{type:"monitors",description:"ç›‘æ§",color:"#8c8c8c",strokeWidth:1}]},ve={planes:It,nodes:Ct,links:St,metadata:Et},_t=O.div`
  width: 100%;
  height: 800px;
  border: 1px solid var(--border-color);
  border-radius: 8px;
  position: relative;
  background-color: var(--background-color);
  overflow: hidden;
`,Tt=O.div`
  position: absolute;
  top: 16px;
  right: 16px;
  z-index: 10;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  padding: 8px;
  box-shadow: var(--card-shadow);
`,$t=O.div`
  position: absolute;
  top: 16px;
  left: 16px;
  z-index: 10;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  box-shadow: var(--card-shadow);
  max-width: 300px;
  transition: all 0.3s ease;
`,zt=O.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px;
  border-bottom: 1px solid var(--border-color);
  cursor: pointer;
  user-select: none;

  &:hover {
    background-color: var(--hover-bg);
  }
`,Rt=O.div`
  padding: ${C=>C.collapsed?"0":"12px"};
  max-height: ${C=>C.collapsed?"0":"400px"};
  overflow: hidden;
  transition: all 0.3s ease;
`,Nt=O.div`
  position: absolute;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  padding: 12px;
  box-shadow: var(--card-shadow);
  pointer-events: none;
  z-index: 20;
  max-width: 250px;
  font-size: 12px;
  line-height: 1.4;
`,Dt=({onNodeSelect:C,entities:F,dependencies:V})=>{var pe;const{t:s}=Qe(["common"]),T=x.useRef(null),te=x.useRef(null),[G,de]=x.useState(!0),[ne,A]=x.useState(null),[c,se]=x.useState(null),[m,L]=x.useState(null),[W,je]=x.useState(null),[ie,X]=x.useState(!0),Ie=(r,g)=>r==="agent"?"#722ed1":{1:"#1890ff",2:"#52c41a",3:"#722ed1",4:"#faad14",5:"#5F9EA0"}[g]||"#8c8c8c",Y=r=>({depends_on:"#1890ff",routes_to:"#52c41a",uses:"#722ed1",stores_in:"#faad14",runs_on:"#f5222d",publishes_to:"#13c2c2",subscribes_to:"#eb2f96",monitors:"#8c8c8c",manages:"#722ed1"})[r]||"#d9d9d9",Q=(r,g)=>g==="agent"?22:{1:20,2:18,3:16,4:14,5:12}[r]||14,he=(r,g,y,S)=>{if(g.filter(k=>k.plane===r.id).length===0)return null;const j=S/3;return{x:50,y:(r.level-1)*j+50,width:y-100,height:j-20,rx:12,ry:12}},re=()=>{if(!T.current||!te.current||!c)return;const r=te.current,g=De(T.current),y=r.clientWidth,S=r.clientHeight;g.selectAll("*").remove(),g.attr("width",y).attr("height",S);const f=ut().scaleExtent([.1,3]).on("zoom",n=>{j.attr("transform",n.transform)});g.call(f);const j=g.append("g");j.append("g").attr("class","planes").selectAll("g").data(c.planes).enter().append("g").attr("class","plane").each(function(n){const l=he(n,c.nodes,y,S);if(!l)return;const I=De(this);I.append("rect").attr("x",l.x).attr("y",l.y).attr("width",l.width).attr("height",l.height).attr("rx",l.rx).attr("ry",l.ry).attr("fill",n.color).attr("stroke",n.borderColor).attr("stroke-width",2).attr("stroke-dasharray","5,5").attr("opacity",.3),I.append("text").attr("x",l.x+20).attr("y",l.y+25).attr("font-size","16px").attr("font-weight","bold").attr("fill",n.borderColor).text(n.name),I.append("text").attr("x",l.x+20).attr("y",l.y+45).attr("font-size","12px").attr("fill","var(--text-secondary)").text(n.description)});const o=xt(c.nodes).force("link",yt(c.links).id(n=>n.id).distance(n=>{const l=n.source.level,I=n.target.level;return Math.abs(l-I)===1?80:120}).strength(n=>n.strength)).force("charge",ft().strength(-200)).force("center",vt(y/2,S/2)).force("collision",jt().radius(n=>Q(n.level,n.type)+8)).force("plane",()=>{c.nodes.forEach(n=>{const l=c.planes.find(ce=>ce.id===n.plane);if(!l)return;const I=he(l,c.nodes,y,S);if(!I)return;const h=30,J=I.x+h,Z=I.x+I.width-h,ae=I.y+h+50,le=I.y+I.height-h;n.x<J&&(n.x=J),n.x>Z&&(n.x=Z),n.y<ae&&(n.y=ae),n.y>le&&(n.y=le)})}),k=j.append("defs");c.metadata.relationTypes.forEach(n=>{k.append("marker").attr("id",`arrow-${n.type}`).attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("fill",n.color)});const z=j.append("g").attr("class","links").selectAll("line").data(c.links).enter().append("line").attr("stroke",n=>Y(n.type)).attr("stroke-width",n=>{const l=c.metadata.relationTypes.find(I=>I.type===n.type);return(l==null?void 0:l.strokeWidth)||1}).attr("stroke-opacity",.8).attr("stroke-dasharray",n=>n.type==="manages"?"5,5":null).attr("marker-end",n=>`url(#arrow-${n.type})`),E=j.append("g").attr("class","nodes").selectAll("g").data(c.nodes).enter().append("g").attr("class","node").call(mt().on("start",(n,l)=>{n.active||o.alphaTarget(.3).restart(),l.fx=l.x,l.fy=l.y}).on("drag",(n,l)=>{l.fx=n.x,l.fy=n.y}).on("end",(n,l)=>{n.active||o.alphaTarget(0);const I=c.planes.find(h=>h.id===l.plane);if(I){const h=he(I,c.nodes,y,S);if(h){const Z=h.x+30,ae=h.x+h.width-30,le=h.y+30+50,ce=h.y+h.height-30;l.fx<Z&&(l.fx=Z),l.fx>ae&&(l.fx=ae),l.fy<le&&(l.fy=le),l.fy>ce&&(l.fy=ce)}}}));E.append("circle").attr("r",n=>Q(n.level,n.type)).attr("fill",n=>Ie(n.type,n.level)).attr("stroke","#fff").attr("stroke-width",2).style("cursor","pointer"),E.filter(n=>n.type==="agent").append("text").text("ğŸ¤–").attr("x",0).attr("y",5).attr("text-anchor","middle").attr("font-size",n=>Q(n.level,n.type)*.8).style("pointer-events","none"),E.append("text").text(n=>n.name).attr("x",0).attr("y",n=>Q(n.level,n.type)+15).attr("text-anchor","middle").attr("font-size","10px").attr("fill","var(--text-color)").style("pointer-events","none"),E.on("mouseover",(n,l)=>{const I=new Set;I.add(l.id),c.links.forEach(h=>{const J=typeof h.source=="string"?h.source:h.source.id,Z=typeof h.target=="string"?h.target:h.target.id;J===l.id&&I.add(Z),Z===l.id&&I.add(J)}),E.style("opacity",h=>I.has(h.id)?1:.3),z.style("opacity",h=>{const J=typeof h.source=="string"?h.source:h.source.id,Z=typeof h.target=="string"?h.target:h.target.id;return J===l.id||Z===l.id?1:.1}),je({x:n.pageX+10,y:n.pageY-10,content:l})}).on("mouseout",()=>{E.style("opacity",1),z.style("opacity",.8),je(null)}).on("click",(n,l)=>{L(l),C==null||C(l)}),o.on("tick",()=>{z.attr("x1",n=>n.source.x).attr("y1",n=>n.source.y).attr("x2",n=>n.target.x).attr("y2",n=>n.target.y),E.attr("transform",n=>`translate(${n.x},${n.y})`)});const _=()=>{g.transition().call(f.scaleBy,1.5)},i=()=>{g.transition().call(f.scaleBy,1/1.5)},w=()=>{g.transition().call(f.transform,ht)},oe=()=>{c.nodes.forEach(n=>{n.fx=null,n.fy=null}),o.alpha(1).restart()};T.current.zoomIn=_,T.current.zoomOut=i,T.current.resetZoom=w,T.current.resetNodePositions=oe},N=(r,g)=>{const y=[{id:"business_plane",name:"ä¸šåŠ¡åº”ç”¨å¹³é¢",level:1,color:"#e6f7ff",borderColor:"#1890ff",description:"ä¸šåŠ¡ç³»ç»Ÿå’Œåº”ç”¨æœåŠ¡å±‚",bounds:{minLevel:1,maxLevel:2}},{id:"middleware_plane",name:"ä¸­é—´ä»¶å¹³é¢",level:2,color:"#f9f0ff",borderColor:"#722ed1",description:"ä¸­é—´ä»¶å’ŒåŸºç¡€æœåŠ¡å±‚",bounds:{minLevel:3,maxLevel:3}},{id:"infrastructure_plane",name:"åŸºç¡€è®¾æ–½å¹³é¢",level:3,color:"#f0f8f8",borderColor:"#5F9EA0",description:"åŸºç¡€è®¾æ–½å’Œèµ„æºå±‚",bounds:{minLevel:4,maxLevel:5}}],S=r.map(b=>{let o=2,k="business_plane";return b.type.includes("cache")||b.type.includes("message")||b.type.includes("monitoring")?(o=3,k="middleware_plane"):(b.type.includes("database")||b.type.includes("container")||b.type.includes("cluster"))&&(o=4,k="infrastructure_plane"),{id:b.id,name:b.name,type:b.type,level:o,plane:k,description:b.properties.description||`${b.name} - ${b.type}`,status:b.status,...b.properties}}),f=g.map(b=>({source:b.source,target:b.target,type:b.type,strength:b.strength}));return{planes:y,nodes:S,links:f,metadata:{levels:[{level:1,name:"å‰ç«¯åº”ç”¨å±‚",color:"#1890ff"},{level:2,name:"ä¸šåŠ¡æœåŠ¡å±‚",color:"#52c41a"},{level:3,name:"ä¸­é—´ä»¶å±‚",color:"#722ed1"},{level:4,name:"æ•°æ®å­˜å‚¨å±‚",color:"#faad14"},{level:5,name:"åŸºç¡€è®¾æ–½å±‚",color:"#5F9EA0"}],relationTypes:[{type:"depends_on",description:"ä¾èµ–äº",color:"#1890ff",strokeWidth:2},{type:"provides_to",description:"æä¾›ç»™",color:"#52c41a",strokeWidth:2},{type:"connects_to",description:"è¿æ¥åˆ°",color:"#faad14",strokeWidth:2}]}}};x.useEffect(()=>{try{if(de(!0),F&&V){const r=N(F,V);se(r)}else se(ve);A(null)}catch{A("Failed to load entity topology data")}finally{de(!1)}},[F,V]),x.useEffect(()=>{if(c&&!G){const r=setTimeout(()=>{re()},100);return()=>clearTimeout(r)}},[c,G]),x.useEffect(()=>{const r=()=>{c&&!G&&re()};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[c,G]);const ue=()=>{var r,g;(g=(r=T.current)==null?void 0:r.zoomIn)==null||g.call(r)},D=()=>{var r,g;(g=(r=T.current)==null?void 0:r.zoomOut)==null||g.call(r)},me=()=>{var r,g;(g=(r=T.current)==null?void 0:r.resetZoom)==null||g.call(r)},ee=()=>{var r,g;(g=(r=T.current)==null?void 0:r.resetNodePositions)==null||g.call(r)},be=()=>{re()},Ce=async()=>{console.log("ğŸ” å¼€å§‹åˆ†æè¯Šæ–­...");const r=F||[],g=V||[],y=r.filter(o=>o.type!=="agent"),S=r.filter(o=>o.type==="agent"),f=g.filter(o=>{const k=S.some(E=>E.id===o.source),z=S.some(E=>E.id===o.target);return!k&&!z}),j=g.filter(o=>{const k=S.some(E=>E.id===o.source),z=S.some(E=>E.id===o.target);return k||z}),b={timestamp:new Date().toISOString(),topologyId:"topology-"+Date.now(),entities:y.map(o=>({id:o.id,name:o.name,type:o.type,status:o.status,connections:o.connections,properties:o.properties})),agents:S.map(o=>{var k,z,E,_,i;return{id:o.id,name:o.name,type:o.type,status:o.status,agentType:((k=o.properties)==null?void 0:k.agentType)||"unknown",capabilities:((z=o.properties)==null?void 0:z.capabilities)||[],version:((E=o.properties)==null?void 0:E.version)||"unknown",lastActive:((_=o.properties)==null?void 0:_.lastActive)||new Date().toISOString(),description:((i=o.properties)==null?void 0:i.description)||""}}),entityDependencies:f.map(o=>({id:o.id,source:o.source,target:o.target,type:o.type,strength:o.strength,description:o.description})),entityAgentRelations:j.map(o=>({id:o.id,entityId:o.type==="manages"?o.target:o.source,agentId:o.type==="manages"?o.source:o.target,relationType:o.type,strength:o.strength,description:o.description,createdAt:new Date().toISOString()})),analysisRequest:{checkHealthStatus:!0,detectAnomalies:!0,performanceAnalysis:!0,securityCheck:!0,dependencyAnalysis:!0,agentEfficiencyAnalysis:!0}};console.log("ğŸ“Š å‡†å¤‡å‘é€çš„åˆ†ææ•°æ®:",b);try{console.log("ğŸš€ æ¨¡æ‹Ÿå‘é€POSTè¯·æ±‚åˆ°: /api/v1/topology/analysis"),console.log("ğŸ“¤ è¯·æ±‚å¤´:",{"Content-Type":"application/json",Authorization:"Bearer <token>","X-Request-ID":"req-"+Date.now()}),console.log("ğŸ“¦ è¯·æ±‚ä½“:",JSON.stringify(b,null,2)),await new Promise(i=>setTimeout(i,1500));const o=y.filter(i=>i.status==="active"),k=y.filter(i=>i.status==="warning"),z=y.filter(i=>i.status==="error"),E=S.filter(i=>i.status==="active"),_={success:!0,requestId:"req-"+Date.now(),analysisId:"analysis-"+Date.now(),timestamp:new Date().toISOString(),results:{summary:{totalEntities:y.length,totalAgents:S.length,totalEntityDependencies:f.length,totalEntityAgentRelations:j.length,overallHealth:z.length>0?"critical":k.length>0?"warning":"good",healthScore:Math.max(60,100-z.length*20-k.length*10)},entityAnalysis:{activeEntities:o.length,warningEntities:k.length,errorEntities:z.length,orphanedEntities:y.filter(i=>!f.some(w=>w.source===i.id||w.target===i.id)&&!j.some(w=>w.entityId===i.id)).length,criticalEntities:y.filter(i=>{const w=f.filter(n=>n.target===i.id).length,oe=f.filter(n=>n.source===i.id).length;return w+oe>3}).map(i=>({id:i.id,name:i.name,connectionCount:f.filter(w=>w.source===i.id||w.target===i.id).length}))},agentAnalysis:{activeAgents:E.length,agentCoverage:j.length>0?(j.length/Math.max(y.length,1)*100).toFixed(1)+"%":"0%",agentEfficiency:S.map(i=>{var w;return{id:i.id,name:i.name,managedEntities:j.filter(oe=>oe.agentId===i.id).length,status:i.status,capabilities:((w=i.properties)==null?void 0:w.capabilities)||[]}}),unmanagedEntities:y.filter(i=>!j.some(w=>w.entityId===i.id)).map(i=>({id:i.id,name:i.name,type:i.type}))},dependencyAnalysis:{totalDependencies:f.length,dependencyTypes:[...new Set(f.map(i=>i.type))],circularDependencies:[],strongDependencies:f.filter(i=>i.strength>.8).length,weakDependencies:f.filter(i=>i.strength<=.5).length},relationAnalysis:{totalRelations:j.length,relationTypes:[...new Set(j.map(i=>i.relationType))],agentUtilization:S.map(i=>({agentId:i.id,agentName:i.name,relationCount:j.filter(w=>w.agentId===i.id).length,utilizationRate:j.filter(w=>w.agentId===i.id).length>0?"active":"idle"}))},issues:[...z.length>0?[{type:"error",severity:"high",category:"entity_health",message:`å‘ç° ${z.length} ä¸ªå®ä½“çŠ¶æ€å¼‚å¸¸`,affectedItems:z.map(i=>i.id),recommendation:"ç«‹å³æ£€æŸ¥å¼‚å¸¸å®ä½“çš„æ—¥å¿—å’Œé…ç½®"}]:[],...k.length>0?[{type:"warning",severity:"medium",category:"entity_health",message:`å‘ç° ${k.length} ä¸ªå®ä½“çŠ¶æ€è­¦å‘Š`,affectedItems:k.map(i=>i.id),recommendation:"æ£€æŸ¥è­¦å‘Šå®ä½“çš„æ€§èƒ½æŒ‡æ ‡"}]:[],...S.length===0?[{type:"warning",severity:"medium",category:"agent_coverage",message:"æœªéƒ¨ç½²ä»»ä½•Agentï¼Œç¼ºä¹æ™ºèƒ½ç›‘æ§èƒ½åŠ›",affectedItems:["topology"],recommendation:"å»ºè®®éƒ¨ç½²ç›‘æ§å’Œç®¡ç†Agent"}]:[],...j.length<y.length*.5?[{type:"info",severity:"low",category:"agent_coverage",message:"Agentè¦†ç›–ç‡è¾ƒä½ï¼Œéƒ¨åˆ†å®ä½“ç¼ºä¹æ™ºèƒ½ç®¡ç†",affectedItems:["agent_coverage"],recommendation:"è€ƒè™‘ä¸ºæ›´å¤šå®ä½“é…ç½®Agentç®¡ç†"}]:[]],recommendations:[...E.length>0?["Agentç›‘æ§ç³»ç»Ÿè¿è¡Œæ­£å¸¸"]:["å»ºè®®éƒ¨ç½²Agentç›‘æ§ç³»ç»Ÿ"],...f.length>y.length*2?["æ‹“æ‰‘å¤æ‚åº¦è¾ƒé«˜ï¼Œå»ºè®®ä¼˜åŒ–ä¾èµ–å…³ç³»"]:[],"å®šæœŸæ£€æŸ¥å®ä½“å¥åº·çŠ¶æ€","ä¼˜åŒ–Agentèµ„æºåˆ†é…","å»ºç«‹å®Œå–„çš„ç›‘æ§å‘Šè­¦æœºåˆ¶"]}};console.log("âœ… æ¨¡æ‹Ÿåç«¯å“åº”:",_),console.log("ğŸ“ˆ åˆ†æç»“æœæ‘˜è¦:"),console.log(`   - å®ä½“æ•°é‡: ${_.results.summary.totalEntities}`),console.log(`   - Agentæ•°é‡: ${_.results.summary.totalAgents}`),console.log(`   - å®ä½“ä¾èµ–å…³ç³»: ${_.results.summary.totalEntityDependencies} ä¸ª`),console.log(`   - å®ä½“-Agentå…³ç³»: ${_.results.summary.totalEntityAgentRelations} ä¸ª`),console.log(`   - æ•´ä½“å¥åº·åº¦: ${_.results.summary.overallHealth} (${_.results.summary.healthScore}/100)`),console.log(`   - Agentè¦†ç›–ç‡: ${_.results.agentAnalysis.agentCoverage}`),_.results.agentAnalysis.agentEfficiency.length>0&&(console.log("ğŸ¤– Agentæ•ˆç‡åˆ†æ:"),_.results.agentAnalysis.agentEfficiency.forEach((i,w)=>{console.log(`   ${w+1}. ${i.name}`),console.log(`      çŠ¶æ€: ${i.status}`),console.log(`      ç®¡ç†å®ä½“: ${i.managedEntities} ä¸ª`),console.log(`      èƒ½åŠ›: ${Array.isArray(i.capabilities)?i.capabilities.join(", "):i.capabilities}`)})),_.results.agentAnalysis.unmanagedEntities.length>0&&(console.log("âš ï¸  æœªè¢«Agentç®¡ç†çš„å®ä½“:"),_.results.agentAnalysis.unmanagedEntities.forEach((i,w)=>{console.log(`   ${w+1}. ${i.name} (${i.type})`)})),_.results.issues.length>0&&(console.log("ğŸš¨ å‘ç°çš„é—®é¢˜:"),_.results.issues.forEach((i,w)=>{console.log(`   ${w+1}. [${i.severity.toUpperCase()}] ${i.message}`),console.log(`      ç±»åˆ«: ${i.category}`),console.log(`      å»ºè®®: ${i.recommendation}`)})),console.log("ğŸ¯ åˆ†æè¯Šæ–­å®Œæˆ!")}catch(o){console.error("âŒ åˆ†æè¯Šæ–­å¤±è´¥:",o),console.log("ğŸ”„ å»ºè®®é‡è¯•æˆ–è”ç³»ç³»ç»Ÿç®¡ç†å‘˜")}};return G?e.jsx(Ae,{children:e.jsxs("div",{style:{textAlign:"center",padding:"100px 0"},children:[e.jsx(We,{size:"large"}),e.jsx("div",{style:{marginTop:16},children:"åŠ è½½å®ä½“æ‹“æ‰‘å›¾..."})]})}):ne?e.jsx(Ae,{children:e.jsx(et,{message:"é”™è¯¯",description:ne,type:"error",showIcon:!0})}):e.jsxs(Ae,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"å®ä½“æ‹“æ‰‘å…³ç³»å›¾"}),e.jsx(R,{type:"primary",size:"small",icon:e.jsx(at,{}),onClick:Ce,children:"åˆ†æè¯Šæ–­"})]}),style:{marginBottom:24},children:[e.jsxs(_t,{ref:te,children:[e.jsx("svg",{ref:T}),e.jsx(Tt,{children:e.jsxs(M,{direction:"vertical",size:"small",children:[e.jsx(R,{size:"small",icon:e.jsx(tt,{}),onClick:ue,title:"æ”¾å¤§"}),e.jsx(R,{size:"small",icon:e.jsx(nt,{}),onClick:D,title:"ç¼©å°"}),e.jsx(R,{size:"small",icon:e.jsx(st,{}),onClick:me,title:"é‡ç½®è§†å›¾"}),e.jsx(R,{size:"small",icon:e.jsx(it,{}),onClick:ee,title:"é‡ç½®èŠ‚ç‚¹ä½ç½®"}),e.jsx(R,{size:"small",icon:e.jsx(Me,{}),onClick:be,title:"åˆ·æ–°å›¾è¡¨"})]})}),e.jsxs($t,{children:[e.jsxs(zt,{onClick:()=>X(!ie),children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"14px"},children:"å›¾ä¾‹"}),ie?e.jsx(rt,{}):e.jsx(ot,{})]}),e.jsxs(Rt,{collapsed:ie,children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("div",{style:{marginBottom:4,fontSize:"12px",fontWeight:"bold"},children:"å¹³é¢:"}),c==null?void 0:c.planes.map(r=>e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:2},children:[e.jsx("div",{style:{width:16,height:12,backgroundColor:r.color,border:`1px solid ${r.borderColor}`,borderRadius:2,marginRight:6}}),e.jsx("span",{style:{fontSize:"11px"},children:r.name})]},r.id))]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("div",{style:{marginBottom:4,fontSize:"12px",fontWeight:"bold"},children:"èŠ‚ç‚¹ç±»å‹:"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:2},children:[e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",backgroundColor:"#722ed1",marginRight:6,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"8px"},children:"ğŸ¤–"}),e.jsx("span",{style:{fontSize:"11px"},children:"AI Agent"})]}),c==null?void 0:c.metadata.levels.map(r=>e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:2},children:[e.jsx("div",{style:{width:12,height:12,borderRadius:"50%",backgroundColor:r.color,marginRight:6}}),e.jsx("span",{style:{fontSize:"11px"},children:r.name})]},r.level))]}),e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:4,fontSize:"12px",fontWeight:"bold"},children:"å…³ç³»ç±»å‹:"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:2},children:[e.jsx("div",{style:{width:16,height:2,backgroundColor:"#722ed1",marginRight:6,borderTop:"2px dashed #722ed1",backgroundColor:"transparent"}}),e.jsx("span",{style:{fontSize:"11px"},children:"Agentç®¡ç†"})]}),c==null?void 0:c.metadata.relationTypes.map(r=>e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:2},children:[e.jsx("div",{style:{width:16,height:2,backgroundColor:r.color,marginRight:6}}),e.jsx("span",{style:{fontSize:"11px"},children:r.description})]},r.type))]})]})]}),W&&e.jsxs(Nt,{style:{left:W.x,top:W.y},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:4},children:W.content.name}),e.jsxs("div",{style:{marginBottom:2},children:["ç±»å‹: ",W.content.type]}),e.jsxs("div",{style:{marginBottom:2},children:["å±‚çº§: ",W.content.level]}),e.jsxs("div",{style:{marginBottom:2},children:["å¹³é¢: ",W.content.plane]}),e.jsxs("div",{style:{marginBottom:2},children:["çŠ¶æ€:",e.jsx(q,{color:W.content.status==="active"?"green":"red",size:"small",style:{marginLeft:4},children:W.content.status})]}),e.jsx("div",{style:{fontSize:"11px",color:"var(--text-secondary)"},children:W.content.description})]})]}),m&&e.jsx(Ae,{title:`èŠ‚ç‚¹è¯¦æƒ…: ${m.name}`,size:"small",style:{marginTop:16},extra:e.jsx(R,{size:"small",onClick:()=>L(null),children:"å…³é—­"}),children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"åŸºæœ¬ä¿¡æ¯:"}),e.jsxs("div",{children:["ID: ",m.id]}),e.jsxs("div",{children:["ç±»å‹: ",m.type]}),e.jsxs("div",{children:["å±‚çº§: ",m.level]}),e.jsxs("div",{children:["å¹³é¢: ",m.plane]}),e.jsxs("div",{children:["çŠ¶æ€: ",e.jsx(q,{color:m.status==="active"?"green":"red",children:m.status})]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"æè¿°:"}),e.jsx("div",{children:m.description})]}),m.instances&&e.jsxs("div",{children:[e.jsx("strong",{children:"å®ä¾‹ä¿¡æ¯:"}),e.jsxs("div",{children:["å®ä¾‹æ•°: ",m.instances]}),m.version&&e.jsxs("div",{children:["ç‰ˆæœ¬: ",m.version]}),m.technology&&e.jsxs("div",{children:["æŠ€æœ¯æ ˆ: ",m.technology]})]}),m.nodes&&e.jsxs("div",{children:[e.jsx("strong",{children:"é›†ç¾¤ä¿¡æ¯:"}),e.jsxs("div",{children:["èŠ‚ç‚¹æ•°: ",m.nodes]}),m.config&&e.jsxs("div",{children:["é…ç½®: ",m.config]}),m.technology&&e.jsxs("div",{children:["æŠ€æœ¯: ",m.technology]}),m.region&&e.jsxs("div",{children:["åŒºåŸŸ: ",m.region]})]}),m.databases&&e.jsxs("div",{children:[e.jsx("strong",{children:"æ•°æ®åº“:"}),e.jsx("div",{style:{marginTop:4},children:m.databases.map((r,g)=>e.jsx(q,{color:"blue",style:{marginBottom:4},children:r},g))})]}),m.metrics&&e.jsxs("div",{children:[e.jsx("strong",{children:"ä¸šåŠ¡æŒ‡æ ‡:"}),e.jsxs("div",{children:["æ—¥å‡é‡: ",(pe=m.metrics.dailyVolume)==null?void 0:pe.toLocaleString()]}),e.jsxs("div",{children:["æˆåŠŸç‡: ",m.metrics.successRate,"%"]})]})]})})]})},Bt=[{id:"web-portal-1",name:"ä¼ä¸šé—¨æˆ·ç½‘ç«™",type:"web_application",status:"active",properties:{description:"ä¼ä¸šå®˜æ–¹é—¨æˆ·ç½‘ç«™ï¼Œæä¾›äº§å“å±•ç¤ºå’Œç”¨æˆ·æœåŠ¡",technology:"React + Node.js",environment:"production",version:"2.1.0"},connections:0},{id:"mobile-app-1",name:"ç§»åŠ¨åº”ç”¨å®¢æˆ·ç«¯",type:"mobile_application",status:"active",properties:{description:"iOSå’ŒAndroidç§»åŠ¨åº”ç”¨",technology:"React Native",environment:"production",version:"1.8.2"},connections:0},{id:"payment-service-1",name:"æ”¯ä»˜æœåŠ¡",type:"microservice",status:"active",properties:{description:"å¤„ç†æ”¯ä»˜ç›¸å…³ä¸šåŠ¡é€»è¾‘",technology:"Spring Boot",environment:"production",version:"3.2.1"},connections:0},{id:"notification-service-1",name:"é€šçŸ¥æœåŠ¡",type:"microservice",status:"active",properties:{description:"ç»Ÿä¸€æ¶ˆæ¯é€šçŸ¥æœåŠ¡",technology:"Spring Boot",environment:"production",version:"2.5.0"},connections:0},{id:"elasticsearch-cluster-1",name:"æœç´¢å¼•æ“é›†ç¾¤",type:"search_engine",status:"active",properties:{description:"Elasticsearchæœç´¢å¼•æ“é›†ç¾¤",technology:"Elasticsearch",environment:"production",version:"8.5.0"},connections:0},{id:"kafka-cluster-1",name:"æ¶ˆæ¯é˜Ÿåˆ—é›†ç¾¤",type:"message_queue",status:"active",properties:{description:"Apache Kafkaæ¶ˆæ¯é˜Ÿåˆ—é›†ç¾¤",technology:"Apache Kafka",environment:"production",version:"3.3.0"},connections:0},{id:"postgres-primary-1",name:"PostgreSQLä¸»åº“",type:"database",status:"active",properties:{description:"PostgreSQLä¸»æ•°æ®åº“",technology:"PostgreSQL",environment:"production",version:"14.6"},connections:0},{id:"postgres-replica-1",name:"PostgreSQLä»åº“",type:"database",status:"active",properties:{description:"PostgreSQLåªè¯»ä»åº“",technology:"PostgreSQL",environment:"production",version:"14.6"},connections:0},{id:"cdn-service-1",name:"CDNåŠ é€ŸæœåŠ¡",type:"cdn",status:"active",properties:{description:"å†…å®¹åˆ†å‘ç½‘ç»œæœåŠ¡",technology:"CloudFlare",environment:"production",version:"latest"},connections:0},{id:"backup-service-1",name:"å¤‡ä»½æœåŠ¡",type:"backup_system",status:"active",properties:{description:"æ•°æ®å¤‡ä»½å’Œæ¢å¤æœåŠ¡",technology:"Custom Script",environment:"production",version:"1.0.0"},connections:0},{id:"log-aggregator-1",name:"æ—¥å¿—èšåˆæœåŠ¡",type:"logging_system",status:"active",properties:{description:"ELKæ—¥å¿—èšåˆå’Œåˆ†æç³»ç»Ÿ",technology:"ELK Stack",environment:"production",version:"8.5.0"},connections:0},{id:"security-scanner-1",name:"å®‰å…¨æ‰«ææœåŠ¡",type:"security_system",status:"warning",properties:{description:"å®‰å…¨æ¼æ´æ‰«æå’Œç›‘æ§",technology:"OWASP ZAP",environment:"production",version:"2.12.0"},connections:0}],Lt={entities:Bt},Pt=[{id:"monitoring-agent-1",name:"ç³»ç»Ÿç›‘æ§Agent",type:"monitoring",status:"active",description:"è´Ÿè´£ç³»ç»Ÿæ€§èƒ½ç›‘æ§å’Œå‘Šè­¦",capabilities:["æ€§èƒ½ç›‘æ§","æ—¥å¿—åˆ†æ","å‘Šè­¦é€šçŸ¥"],version:"2.1.0",lastActive:"2024-12-20T10:30:00Z"},{id:"security-agent-1",name:"å®‰å…¨æ‰«æAgent",type:"security",status:"active",description:"æ‰§è¡Œå®‰å…¨æ¼æ´æ‰«æå’Œå¨èƒæ£€æµ‹",capabilities:["æ¼æ´æ‰«æ","å¨èƒæ£€æµ‹","å®‰å…¨è¯„ä¼°"],version:"1.5.2",lastActive:"2024-12-20T09:45:00Z"},{id:"backup-agent-1",name:"æ•°æ®å¤‡ä»½Agent",type:"backup",status:"active",description:"è‡ªåŠ¨åŒ–æ•°æ®å¤‡ä»½å’Œæ¢å¤ç®¡ç†",capabilities:["æ•°æ®å¤‡ä»½","å¢é‡å¤‡ä»½","æ¢å¤ç®¡ç†"],version:"3.0.1",lastActive:"2024-12-20T08:15:00Z"},{id:"deployment-agent-1",name:"éƒ¨ç½²ç®¡ç†Agent",type:"deployment",status:"active",description:"è‡ªåŠ¨åŒ–åº”ç”¨éƒ¨ç½²å’Œç‰ˆæœ¬ç®¡ç†",capabilities:["è‡ªåŠ¨éƒ¨ç½²","ç‰ˆæœ¬ç®¡ç†","å›æ»šæ“ä½œ"],version:"2.3.0",lastActive:"2024-12-20T11:20:00Z"},{id:"log-agent-1",name:"æ—¥å¿—æ”¶é›†Agent",type:"logging",status:"active",description:"é›†ä¸­åŒ–æ—¥å¿—æ”¶é›†å’Œåˆ†æå¤„ç†",capabilities:["æ—¥å¿—æ”¶é›†","æ—¥å¿—è§£æ","å¼‚å¸¸æ£€æµ‹"],version:"1.8.5",lastActive:"2024-12-20T10:50:00Z"},{id:"performance-agent-1",name:"æ€§èƒ½ä¼˜åŒ–Agent",type:"performance",status:"active",description:"åº”ç”¨æ€§èƒ½åˆ†æå’Œä¼˜åŒ–å»ºè®®",capabilities:["æ€§èƒ½åˆ†æ","ç“¶é¢ˆè¯†åˆ«","ä¼˜åŒ–å»ºè®®"],version:"2.0.3",lastActive:"2024-12-20T09:30:00Z"},{id:"config-agent-1",name:"é…ç½®ç®¡ç†Agent",type:"configuration",status:"active",description:"é…ç½®æ–‡ä»¶ç®¡ç†å’Œå˜æ›´è¿½è¸ª",capabilities:["é…ç½®ç®¡ç†","å˜æ›´è¿½è¸ª","é…ç½®éªŒè¯"],version:"1.6.0",lastActive:"2024-12-20T08:45:00Z"},{id:"network-agent-1",name:"ç½‘ç»œç›‘æ§Agent",type:"network",status:"active",description:"ç½‘ç»œè¿æ¥ç›‘æ§å’Œæµé‡åˆ†æ",capabilities:["ç½‘ç»œç›‘æ§","æµé‡åˆ†æ","è¿æ¥è¯Šæ–­"],version:"2.2.1",lastActive:"2024-12-20T10:15:00Z"},{id:"health-agent-1",name:"å¥åº·æ£€æŸ¥Agent",type:"health",status:"active",description:"æœåŠ¡å¥åº·çŠ¶æ€æ£€æŸ¥å’Œè‡ªæ„ˆ",capabilities:["å¥åº·æ£€æŸ¥","è‡ªåŠ¨æ¢å¤","çŠ¶æ€æŠ¥å‘Š"],version:"1.9.0",lastActive:"2024-12-20T11:00:00Z"},{id:"scaling-agent-1",name:"å¼¹æ€§ä¼¸ç¼©Agent",type:"scaling",status:"active",description:"æ ¹æ®è´Ÿè½½è‡ªåŠ¨è°ƒæ•´èµ„æºè§„æ¨¡",capabilities:["è‡ªåŠ¨ä¼¸ç¼©","è´Ÿè½½ç›‘æ§","èµ„æºè°ƒåº¦"],version:"2.4.2",lastActive:"2024-12-20T09:20:00Z"},{id:"ai-analysis-agent-1",name:"AIåˆ†æAgent",type:"ai_analysis",status:"active",description:"åŸºäºAIçš„æ™ºèƒ½åˆ†æå’Œé¢„æµ‹",capabilities:["æ™ºèƒ½åˆ†æ","å¼‚å¸¸é¢„æµ‹","è¶‹åŠ¿è¯†åˆ«"],version:"3.1.0",lastActive:"2024-12-20T10:40:00Z"},{id:"compliance-agent-1",name:"åˆè§„æ£€æŸ¥Agent",type:"compliance",status:"warning",description:"åˆè§„æ€§æ£€æŸ¥å’Œå®¡è®¡æŠ¥å‘Š",capabilities:["åˆè§„æ£€æŸ¥","å®¡è®¡æŠ¥å‘Š","é£é™©è¯„ä¼°"],version:"1.7.3",lastActive:"2024-12-20T07:30:00Z"}],Ee={agents:Pt},{Title:Xt,Text:Yt}=_e,Mt=O.div`
  background: var(--bg-tertiary);
  border: 1px solid var(--border-secondary);
  padding: 12px;
  border-radius: 6px;
  margin: 12px 0;
  text-align: center;
  transition: all 0.3s ease;

  .entity-name {
    font-weight: bold;
    color: var(--text-primary);
  }

  .arrow {
    margin: 0 8px;
    color: var(--primary-color);
    font-weight: bold;
    font-size: 16px;
  }

  &:hover {
    background: var(--bg-elevated);
    border-color: var(--border-hover);
  }
`,Wt=O.p`
  font-size: 12px;
  color: var(--text-secondary);
  margin: 8px 0 0 0;
`,Be=O.p`
  color: var(--text-tertiary);
  font-size: 12px;
  margin: 8px 0 0 0;
`,Ot=O.p`
  color: var(--error-color);
  font-weight: 500;
  margin: 8px 0;
`,Le=O.div`
  background: var(--bg-tertiary);
  border: 1px solid var(--border-secondary);
  padding: 12px;
  border-radius: 6px;
  margin-bottom: 16px;

  p {
    color: var(--text-secondary);
    margin: 0;
    font-size: 14px;
  }

  .highlight {
    color: var(--primary-color);
    font-weight: 500;
  }
`,Zt=O.div`
  .form-item {
    margin-bottom: 20px;
  }

  .form-label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: var(--text-primary);
  }

  .entity-select {
    width: 100%;
  }

  .relationship-preview {
    background: var(--bg-tertiary);
    border: 1px solid var(--border-secondary);
    padding: 16px;
    border-radius: 6px;
    margin: 16px 0;
    text-align: center;

    .preview-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      font-size: 16px;
    }

    .entity-name {
      font-weight: bold;
      color: var(--text-primary);
      padding: 4px 8px;
      background: var(--bg-elevated);
      border-radius: 4px;
    }

    .arrow {
      color: var(--primary-color);
      font-weight: bold;
      font-size: 18px;
    }

    .relationship-type {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 8px;
    }
  }
`,Kt=O.div`
  background: var(--bg-tertiary);
  border: 1px solid var(--border-secondary);
  padding: 12px;
  border-radius: 6px;
  margin-bottom: 16px;

  p {
    color: var(--text-secondary);
    margin: 0;
    font-size: 14px;
  }

  .highlight {
    color: var(--primary-color);
    font-weight: 500;
  }

  .entity-info {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 8px;
    padding: 8px;
    background: var(--bg-elevated);
    border-radius: 4px;

    .entity-name {
      font-weight: bold;
      color: var(--text-primary);
    }

    .entity-type {
      font-size: 12px;
      color: var(--text-secondary);
    }
  }
`,Jt=()=>{const{id:C}=He(),[F,V]=x.useState(!0),[s,T]=x.useState(null),[te,G]=x.useState(null),[de,ne]=x.useState(!1),[A,c]=x.useState(null),[se,m]=x.useState(!1),[L,W]=x.useState(null),[je,ie]=x.useState(!1),[X,Ie]=x.useState([]),[Y,Q]=x.useState([]),[he,re]=x.useState(!1),[N,ue]=x.useState(""),[D,me]=x.useState(""),[ee,be]=x.useState("depends_on"),[Ce,pe]=x.useState(!1),[r,g]=x.useState(null),[y,S]=x.useState([]),[f,j]=x.useState([]),[b,o]=x.useState([]),k=x.useCallback(async()=>{V(!0);try{const t=ve.nodes.map(u=>({id:u.id,name:u.name,type:u.type,status:u.status,properties:{level:u.level,plane:u.plane,description:u.description,...Object.fromEntries(Object.entries(u).filter(([B])=>!["id","name","type","level","plane","description","status"].includes(B)))},connections:0}));t.forEach(u=>{u.connections=ve.links.filter(B=>B.source===u.id||B.target===u.id).length});const a=ve.links.map((u,B)=>{var p;return{id:`dep-${B+1}`,source:u.source,target:u.target,type:u.type,strength:u.strength,description:((p=ve.metadata.relationTypes.find(K=>K.type===u.type))==null?void 0:p.description)||u.type.replace("_"," ")}}),d={id:C||"1",name:"ä¼ä¸šåº”ç”¨æ‹“æ‰‘",description:"ä¼ä¸šæ ¸å¿ƒåº”ç”¨ç³»ç»Ÿæ‹“æ‰‘å›¾ï¼Œå±•ç¤ºå‰ç«¯åº”ç”¨ã€ä¸šåŠ¡æœåŠ¡ã€ä¸­é—´ä»¶å’ŒåŸºç¡€è®¾æ–½çš„ä¾èµ–å…³ç³»ã€‚",type:"application",status:"active",plane:"åº”ç”¨å¹³é¢",tags:["æ ¸å¿ƒ","ç”Ÿäº§ç¯å¢ƒ","å¾®æœåŠ¡"],stats:{nodeCount:t.length,linkCount:a.length,healthScore:98,lastUpdated:"2024-07-02 09:00:00"},entities:t,dependencies:a};T(d),S(Ee.agents);const v=[{id:"binding-sample-1",entityId:"web-app-1",agentId:"monitoring-agent-1",bindingType:"monitoring",createdAt:new Date().toISOString()}];o(v)}catch(t){console.error("Failed to load topology detail:",t),H.error("åŠ è½½æ‹“æ‰‘æ•°æ®å¤±è´¥")}finally{V(!1)}},[C]);x.useEffect(()=>{k()},[k]);const z=t=>{g(t);const a=b.filter(d=>d.entityId===t.id).map(d=>d.agentId);S(Ee.agents),j(a),pe(!0)},E=()=>{if(!r||f.length===0){H.warning("è¯·é€‰æ‹©è¦ç»‘å®šçš„Agent");return}const a=b.filter(P=>P.entityId===r.id).map(P=>P.agentId),d=f.filter(P=>!a.includes(P)),v=a.filter(P=>!f.includes(P)),u=d.map(P=>({id:`binding-${r.id}-${P}-${Date.now()}`,entityId:r.id,agentId:P,bindingType:"monitoring",createdAt:new Date().toISOString()})),B=[...b.filter(P=>!(P.entityId===r.id&&v.includes(P.agentId))),...u];o(B),s&&w(B);const p=d.length,K=v.length;let $="";p>0&&K>0?$=`æˆåŠŸç»‘å®š ${p} ä¸ªAgentï¼Œè§£ç»‘ ${K} ä¸ªAgent`:p>0?$=`æˆåŠŸç»‘å®š ${p} ä¸ªAgentåˆ° ${r.name}`:K>0?$=`æˆåŠŸè§£ç»‘ ${K} ä¸ªAgent`:$="Agentç»‘å®šçŠ¶æ€æ— å˜åŒ–",H.success($),pe(!1)},_=()=>{pe(!1),g(null),j([])},i=t=>{j(t)},w=t=>{if(!s)return;const a=[...new Set(t.map(p=>p.agentId))],d=Ee.agents.filter(p=>a.includes(p.id)).map(p=>({id:p.id,name:p.name,type:"agent",level:0,status:p.status,properties:{description:p.description,agentType:p.type,capabilities:p.capabilities.join(", "),version:p.version,lastActive:p.lastActive},connections:t.filter(K=>K.agentId===p.id).length})),v=t.map(p=>({id:`agent-conn-${p.id}`,source:p.agentId,target:p.entityId,type:"manages",description:"ç®¡ç†",strength:.8})),u=[...s.entities.filter(p=>p.type!=="agent"),...d],B=[...s.dependencies.filter(p=>!p.id.startsWith("agent-conn-")),...v];T({...s,entities:u,dependencies:B,stats:{...s.stats,nodeCount:u.length,linkCount:B.length}})},oe=t=>{c(t),ne(!0)},n=()=>{if(!s||!A)return;const t=s.dependencies.filter(v=>v.source===A.id||v.target===A.id),a=s.entities.filter(v=>v.id!==A.id),d=s.dependencies.filter(v=>v.source!==A.id&&v.target!==A.id);T({...s,entities:a,dependencies:d,stats:{...s.stats,nodeCount:a.length,linkCount:d.length}}),te&&te.id===A.id&&G(null),H.success(`æˆåŠŸåˆ é™¤å®ä½“ "${A.name}"${t.length>0?` åŠ ${t.length} ä¸ªç›¸å…³ä¾èµ–å…³ç³»`:""}`),ne(!1),c(null)},l=()=>{ne(!1),c(null)},I=t=>{W(t),m(!0)},h=()=>{if(!s||!L)return;const t=s.dependencies.filter(p=>p.id!==L.id),a=s.entities.map(p=>{const K=t.filter($=>$.source===p.id||$.target===p.id).length;return{...p,connections:K}});T({...s,entities:a,dependencies:t,stats:{...s.stats,linkCount:t.length}});const d=s.entities.find(p=>p.id===L.source),v=s.entities.find(p=>p.id===L.target),u=d?d.name:L.source,B=v?v.name:L.target;H.success(`æˆåŠŸåˆ é™¤ä¾èµ–å…³ç³» "${u} â†’ ${B}"`),m(!1),W(null)},J=()=>{m(!1),W(null)},Z=()=>{if(!s||s.entities.length<2){H.warning("è‡³å°‘éœ€è¦2ä¸ªå®ä½“æ‰èƒ½å»ºç«‹ä¾èµ–å…³ç³»");return}ue(""),me(""),be("depends_on"),re(!0)},ae=()=>{if(!s||!N||!D){H.error("è¯·é€‰æ‹©æºå®ä½“å’Œç›®æ ‡å®ä½“");return}if(N===D){H.error("æºå®ä½“å’Œç›®æ ‡å®ä½“ä¸èƒ½ç›¸åŒ");return}if(s.dependencies.find($=>$.source===N&&$.target===D&&$.type===ee)){H.error("è¯¥ä¾èµ–å…³ç³»å·²å­˜åœ¨");return}const a={id:`dep-${Date.now()}`,source:N,target:D,type:ee,description:ce(ee),strength:1},d=[...s.dependencies,a],v=s.entities.map($=>{const P=d.filter(Te=>Te.source===$.id||Te.target===$.id).length;return{...$,connections:P}});T({...s,entities:v,dependencies:d,stats:{...s.stats,linkCount:d.length}});const u=s.entities.find($=>$.id===N),B=s.entities.find($=>$.id===D),p=u?u.name:N,K=B?B.name:D;H.success(`æˆåŠŸåˆ›å»ºä¾èµ–å…³ç³»ï¼š${p} â†’ ${K}`),re(!1)},le=()=>{re(!1)},ce=t=>({depends_on:"ä¾èµ–äº",connects_to:"è¿æ¥åˆ°",uses:"ä½¿ç”¨",routes_to:"è·¯ç”±åˆ°",stores_in:"å­˜å‚¨åœ¨",reads_from:"è¯»å–è‡ª",writes_to:"å†™å…¥åˆ°",monitors:"ç›‘æ§",backs_up:"å¤‡ä»½"})[t]||t,Oe=()=>{const t=N;ue(D),me(t)},Ze=()=>{const t=(s==null?void 0:s.entities.map(d=>d.id))||[],a=Lt.entities.filter(d=>!t.includes(d.id));Ie(a),Q([]),ie(!0)},Ke=()=>{if(!s||Y.length===0)return;const t=X.filter(d=>Y.includes(d.id)),a=[...s.entities,...t];T({...s,entities:a,stats:{...s.stats,nodeCount:a.length}}),H.success(`æˆåŠŸæ·»åŠ  ${t.length} ä¸ªå®ä½“åˆ°æ‹“æ‰‘å›¾`),ie(!1),Q([])},qe=()=>{ie(!1),Q([])},Fe=t=>{Q(t)},Ve=()=>{const t=X.map(a=>a.id);Q(t)},Ge=()=>{Q([])};return F?e.jsx("div",{className:"entity-topology-detail-loading",children:e.jsx(We,{size:"large"})}):s?e.jsxs("div",{className:"entity-topology-detail",children:[e.jsx("div",{className:"breadcrumb-container",children:e.jsx(lt,{items:[{href:"/dashboard",title:e.jsxs(M,{children:[e.jsx(ct,{}),e.jsx("span",{children:"é¦–é¡µ"})]})},{href:"/test-tools",title:e.jsxs(M,{children:[e.jsx(dt,{}),e.jsx("span",{children:"æµ‹è¯•å·¥å…·"})]})},{href:"/test-tools/entity-topology",title:e.jsxs(M,{children:[e.jsx(ge,{}),e.jsx("span",{children:"å®ä½“æ‹“æ‰‘"})]})},{title:s.name}]})}),e.jsx(At,{topologyData:s,onRefresh:k}),e.jsxs("div",{className:"topology-content",children:[e.jsx(kt,{entities:s.entities,dependencies:s.dependencies,onDeleteEntity:oe,onDeleteDependency:I,onAddEntity:Ze,onAddDependency:Z,onAgentsClick:z}),e.jsx("div",{className:"content-right",children:e.jsx(Dt,{entities:s.entities,dependencies:s.dependencies,onNodeSelect:t=>{if(t){const a=s.entities.find(d=>d.id===t.id);G(a||null)}else G(null)}})})]}),e.jsx(ye,{title:"ç¡®è®¤åˆ é™¤å®ä½“",open:de,onOk:n,onCancel:l,okText:"ç¡®å®šåˆ é™¤",cancelText:"å–æ¶ˆ",okType:"danger",width:400,children:A&&s&&e.jsxs("div",{children:[e.jsxs("p",{children:["ç¡®å®šè¦åˆ é™¤å®ä½“ ",e.jsxs("strong",{children:['"',A.name,'"']})," å—ï¼Ÿ"]}),(()=>{const t=s.dependencies.filter(a=>a.source===A.id||a.target===A.id);return t.length>0&&e.jsxs(Ot,{children:["åˆ é™¤åå°†åŒæ—¶ç§»é™¤ ",e.jsx("strong",{children:t.length})," ä¸ªç›¸å…³çš„ä¾èµ–å…³ç³»ã€‚"]})})(),e.jsx(Be,{children:"æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼Œè¯·è°¨æ…æ“ä½œã€‚"})]})}),e.jsx(ye,{title:"ç¡®è®¤åˆ é™¤ä¾èµ–å…³ç³»",open:se,onOk:h,onCancel:J,okText:"ç¡®å®šåˆ é™¤",cancelText:"å–æ¶ˆ",okType:"danger",width:400,children:L&&s&&e.jsx("div",{children:(()=>{const t=s.entities.find(u=>u.id===L.source),a=s.entities.find(u=>u.id===L.target),d=t?t.name:L.source,v=a?a.name:L.target;return e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"ç¡®å®šè¦åˆ é™¤ä»¥ä¸‹ä¾èµ–å…³ç³»å—ï¼Ÿ"}),e.jsxs(Mt,{children:[e.jsx("span",{className:"entity-name",children:d}),e.jsx("span",{className:"arrow",children:"â†’"}),e.jsx("span",{className:"entity-name",children:v})]}),e.jsxs(Wt,{children:["å…³ç³»ç±»å‹: ",L.description||L.type]}),e.jsx(Be,{children:"æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼Œè¯·è°¨æ…æ“ä½œã€‚"})]})})()})}),e.jsxs(ye,{title:"é€‰æ‹©å®ä½“",open:je,onOk:Ke,onCancel:qe,okText:`ç¡®å®šæ·»åŠ  (${Y.length})`,cancelText:"å–æ¶ˆ",width:800,okButtonProps:{disabled:Y.length===0},children:[e.jsx(Le,{children:e.jsxs("p",{children:["ä»ä¸‹åˆ—å¯ç”¨å®ä½“ä¸­é€‰æ‹©è¦æ·»åŠ åˆ°æ‹“æ‰‘å›¾çš„å®ä½“ã€‚",X.length>0&&e.jsxs(e.Fragment,{children:["å…±æœ‰ ",e.jsx("span",{className:"highlight",children:X.length})," ä¸ªå¯ç”¨å®ä½“ï¼Œ å·²é€‰æ‹©"," ",e.jsx("span",{className:"highlight",children:Y.length})," ä¸ªã€‚"]})]})}),X.length>0&&e.jsx("div",{style:{marginBottom:16},children:e.jsxs(M,{children:[e.jsx(R,{size:"small",onClick:Ve,disabled:Y.length===X.length,children:"å…¨é€‰"}),e.jsx(R,{size:"small",onClick:Ge,disabled:Y.length===0,children:"æ¸…ç©º"})]})}),X.length===0?e.jsx(xe,{description:"æš‚æ— å¯æ·»åŠ çš„å®ä½“",image:xe.PRESENTED_IMAGE_SIMPLE}):e.jsx(ke,{rowSelection:{type:"checkbox",selectedRowKeys:Y,onChange:Fe},columns:[{title:"å®ä½“åç§°",dataIndex:"name",key:"name",width:"30%",render:t=>e.jsx("strong",{children:t})},{title:"ç±»å‹",dataIndex:"type",key:"type",width:"25%",render:t=>e.jsx(q,{color:"blue",children:t.replace(/_/g," ")})},{title:"çŠ¶æ€",dataIndex:"status",key:"status",width:"15%",render:t=>{const a={active:{color:"green",text:"æ­£å¸¸"},warning:{color:"orange",text:"è­¦å‘Š"},error:{color:"red",text:"é”™è¯¯"},inactive:{color:"gray",text:"åœç”¨"}},d=a[t]||a.active;return e.jsx(q,{color:d.color,children:d.text})}},{title:"æè¿°",dataIndex:["properties","description"],key:"description",width:"30%",render:t=>e.jsx("span",{style:{color:"var(--text-secondary)"},children:t||"æš‚æ— æè¿°"})}],dataSource:X,rowKey:"id",size:"small",pagination:{pageSize:8,showSizeChanger:!1,showQuickJumper:!0,showTotal:(t,a)=>`ç¬¬ ${a[0]}-${a[1]} æ¡ï¼Œå…± ${t} æ¡`}})]}),e.jsxs(ye,{title:"åˆ›å»ºä¾èµ–å…³ç³»",open:he,onOk:ae,onCancel:le,okText:"å»ºç«‹å…³ç³»",cancelText:"å–æ¶ˆ",width:600,okButtonProps:{disabled:!N||!D||N===D||(s==null?void 0:s.dependencies.find(t=>t.source===N&&t.target===D&&t.type===ee))!==void 0},children:[e.jsx(Le,{children:e.jsxs("p",{children:["é€‰æ‹©æºå®ä½“å’Œç›®æ ‡å®ä½“æ¥å»ºç«‹ä¾èµ–å…³ç³»ã€‚ å½“å‰æ‹“æ‰‘ä¸­æœ‰"," ",e.jsx("span",{className:"highlight",children:(s==null?void 0:s.entities.length)||0})," ä¸ªå®ä½“å¯ç”¨ã€‚"]})}),e.jsxs(Zt,{children:[e.jsxs("div",{className:"form-item",children:[e.jsx("label",{className:"form-label",children:"æºå®ä½“"}),e.jsx(Ne,{className:"entity-select",placeholder:"è¯·é€‰æ‹©æºå®ä½“",value:N||void 0,onChange:ue,showSearch:!0,filterOption:(t,a)=>((a==null?void 0:a.label)??"").toLowerCase().includes(t.toLowerCase()),options:(s==null?void 0:s.entities.map(t=>({value:t.id,label:t.name,disabled:t.id===D})))||[]})]}),e.jsx("div",{style:{textAlign:"center",margin:"12px 0"},children:e.jsx(R,{type:"text",icon:e.jsx(pt,{}),onClick:Oe,disabled:!N&&!D,title:"äº¤æ¢æºå®ä½“å’Œç›®æ ‡å®ä½“",children:"äº¤æ¢"})}),e.jsxs("div",{className:"form-item",children:[e.jsx("label",{className:"form-label",children:"ç›®æ ‡å®ä½“"}),e.jsx(Ne,{className:"entity-select",placeholder:"è¯·é€‰æ‹©ç›®æ ‡å®ä½“",value:D||void 0,onChange:me,showSearch:!0,filterOption:(t,a)=>((a==null?void 0:a.label)??"").toLowerCase().includes(t.toLowerCase()),options:(s==null?void 0:s.entities.map(t=>({value:t.id,label:t.name,disabled:t.id===N})))||[]})]}),e.jsxs("div",{className:"form-item",children:[e.jsx("label",{className:"form-label",children:"å…³ç³»ç±»å‹"}),e.jsx(U.Group,{value:ee,onChange:t=>be(t.target.value),style:{width:"100%"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[e.jsx(U,{value:"depends_on",children:"ä¾èµ–äº"}),e.jsx(U,{value:"connects_to",children:"è¿æ¥åˆ°"}),e.jsx(U,{value:"uses",children:"ä½¿ç”¨"}),e.jsx(U,{value:"routes_to",children:"è·¯ç”±åˆ°"}),e.jsx(U,{value:"stores_in",children:"å­˜å‚¨åœ¨"}),e.jsx(U,{value:"reads_from",children:"è¯»å–è‡ª"}),e.jsx(U,{value:"writes_to",children:"å†™å…¥åˆ°"}),e.jsx(U,{value:"monitors",children:"ç›‘æ§"}),e.jsx(U,{value:"backs_up",children:"å¤‡ä»½"})]})})]}),N&&D&&e.jsx(e.Fragment,{children:(()=>{var a,d;return(s==null?void 0:s.dependencies.find(v=>v.source===N&&v.target===D&&v.type===ee))?e.jsx("div",{style:{background:"var(--error-color)",color:"white",padding:"12px",borderRadius:"6px",margin:"16px 0",textAlign:"center"},children:"âš ï¸ è¯¥ä¾èµ–å…³ç³»å·²å­˜åœ¨"}):e.jsxs("div",{className:"relationship-preview",children:[e.jsxs("div",{className:"preview-content",children:[e.jsx("span",{className:"entity-name",children:(a=s==null?void 0:s.entities.find(v=>v.id===N))==null?void 0:a.name}),e.jsx("span",{className:"arrow",children:"â†’"}),e.jsx("span",{className:"entity-name",children:(d=s==null?void 0:s.entities.find(v=>v.id===D))==null?void 0:d.name})]}),e.jsxs("div",{className:"relationship-type",children:["å…³ç³»ç±»å‹: ",ce(ee)]})]})})()})]})]}),e.jsxs(ye,{title:"ç»‘å®šAgent",open:Ce,onOk:E,onCancel:_,okText:`ç¡®å®šç»‘å®š (${f.length})`,cancelText:"å–æ¶ˆ",width:900,okButtonProps:{disabled:f.length===0},children:[e.jsxs(Kt,{children:[e.jsx("p",{children:"ä¸ºå®ä½“ç»‘å®šAI Agentæ¥æä¾›æ™ºèƒ½åŒ–ç®¡ç†å’Œç›‘æ§èƒ½åŠ›ã€‚"}),r&&e.jsxs("div",{className:"entity-info",children:[e.jsx("span",{className:"entity-name",children:r.name}),e.jsxs("span",{className:"entity-type",children:["(",r.type,")"]})]}),e.jsxs("p",{style:{marginTop:8},children:["å…±æœ‰ ",e.jsx("span",{className:"highlight",children:y.length})," ä¸ªå¯ç”¨Agentï¼Œ å·²é€‰æ‹©"," ",e.jsx("span",{className:"highlight",children:f.length})," ä¸ªã€‚"]})]}),y.length>0&&e.jsx("div",{style:{marginBottom:16},children:e.jsxs(M,{children:[e.jsx(R,{size:"small",onClick:()=>j(y.map(t=>t.id)),disabled:f.length===y.length,children:"å…¨é€‰"}),e.jsx(R,{size:"small",onClick:()=>j([]),disabled:f.length===0,children:"æ¸…ç©º"})]})}),y.length===0?e.jsx(xe,{description:"æš‚æ— å¯ç”¨çš„Agent",image:xe.PRESENTED_IMAGE_SIMPLE}):e.jsx(ke,{rowSelection:{type:"checkbox",selectedRowKeys:f,onChange:i},columns:[{title:"Agentåç§°",dataIndex:"name",key:"name",width:"25%",render:t=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(gt,{style:{color:"var(--primary-color)"}}),e.jsx("strong",{children:t})]})},{title:"ç±»å‹",dataIndex:"type",key:"type",width:"15%",render:t=>e.jsx(q,{color:"cyan",children:t})},{title:"çŠ¶æ€",dataIndex:"status",key:"status",width:"12%",render:t=>{const a={active:{color:"green",text:"è¿è¡Œä¸­"},warning:{color:"orange",text:"è­¦å‘Š"},error:{color:"red",text:"é”™è¯¯"},inactive:{color:"gray",text:"åœç”¨"}},d=a[t]||a.active;return e.jsx(q,{color:d.color,children:d.text})}},{title:"èƒ½åŠ›",dataIndex:"capabilities",key:"capabilities",width:"25%",render:t=>e.jsxs("div",{children:[t.slice(0,2).map((a,d)=>e.jsx(q,{size:"small",style:{marginBottom:2},children:a},d)),t.length>2&&e.jsxs(q,{size:"small",color:"default",children:["+",t.length-2]})]})},{title:"æè¿°",dataIndex:"description",key:"description",width:"23%",render:t=>e.jsx("span",{style:{color:"var(--text-secondary)",fontSize:"12px"},children:t})}],dataSource:y,rowKey:"id",size:"small",pagination:{pageSize:6,showSizeChanger:!1,showQuickJumper:!0,showTotal:(t,a)=>`ç¬¬ ${a[0]}-${a[1]} æ¡ï¼Œå…± ${t} æ¡`}})]})]}):e.jsx("div",{className:"entity-topology-detail-empty",children:e.jsx(xe,{description:"æ‹“æ‰‘æ•°æ®ä¸å­˜åœ¨"})})};export{Jt as default};
